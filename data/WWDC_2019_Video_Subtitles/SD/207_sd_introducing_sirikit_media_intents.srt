1
00:00:01,516 --> 00:00:05,500
[ Music ]


2
00:00:10,516 --> 00:00:17,856
[ Applause ]


3
00:00:18,356 --> 00:00:20,496
>> Hi. I'm Danny Mandel.


4
00:00:20,496 --> 00:00:22,166
And welcome to Introducing


5
00:00:22,216 --> 00:00:23,386
SiriKit Media Intents.


6
00:00:24,366 --> 00:00:25,946
We've added media domain support


7
00:00:25,946 --> 00:00:27,806
to SiriKit for audio use cases


8
00:00:27,976 --> 00:00:29,986
and we're super excited to tell


9
00:00:29,986 --> 00:00:32,366
you all about it.


10
00:00:33,196 --> 00:00:34,096
So what are we going to cover in


11
00:00:34,096 --> 00:00:34,556
this session?


12
00:00:35,316 --> 00:00:36,836
The first thing we'll do is


13
00:00:36,836 --> 00:00:38,816
introduce the new SiriKit Media


14
00:00:38,816 --> 00:00:40,456
Intents and talk about their


15
00:00:40,456 --> 00:00:41,026
capabilities.


16
00:00:42,346 --> 00:00:43,796
Then we'll talk about what's


17
00:00:43,796 --> 00:00:45,286
required for you to handle


18
00:00:45,356 --> 00:00:46,616
SiriKit Media requests on your


19
00:00:47,306 --> 00:00:47,376
app.


20
00:00:47,946 --> 00:00:49,496
And finally, we'll talk about


21
00:00:49,496 --> 00:00:50,726
some best practices you're going


22
00:00:50,726 --> 00:00:52,466
to want to follow to provide the


23
00:00:52,466 --> 00:00:54,126
best user experience possible


24
00:00:54,446 --> 00:00:55,646
when you add SiriKit Media


25
00:00:55,646 --> 00:00:57,326
Support to your app.


26
00:00:58,216 --> 00:01:01,386
This year, we're allowing you to


27
00:01:01,386 --> 00:01:03,966
control audio in a whole new way


28
00:01:04,066 --> 00:01:05,536
with SiriKit Media Intents.


29
00:01:06,046 --> 00:01:07,276
And we think people are going to


30
00:01:07,276 --> 00:01:08,856
love using the Siri Media


31
00:01:08,856 --> 00:01:10,226
capabilities you build into your


32
00:01:10,416 --> 00:01:10,626
apps.


33
00:01:11,436 --> 00:01:12,796
With SiriKit Media Intents,


34
00:01:13,166 --> 00:01:14,506
people will be able to do things


35
00:01:14,506 --> 00:01:17,226
like play audio, update taste


36
00:01:17,226 --> 00:01:19,216
profiles, add to collections,


37
00:01:19,676 --> 00:01:20,236
and search.


38
00:01:21,226 --> 00:01:22,276
This means that they'll be able


39
00:01:22,276 --> 00:01:24,366
to use the rich natural language


40
00:01:24,366 --> 00:01:26,136
processing capabilities of Siri


41
00:01:26,936 --> 00:01:28,996
to say things like "Play Khalid


42
00:01:28,996 --> 00:01:31,386
on my app," to immediately begin


43
00:01:31,716 --> 00:01:35,286
playing Khalid in your app.


44
00:01:36,676 --> 00:01:37,946
Let's take a look at the new


45
00:01:38,036 --> 00:01:39,746
SiriKit Media Intents and their


46
00:01:39,746 --> 00:01:40,436
capabilities.


47
00:01:42,056 --> 00:01:44,486
There are four SiriKit Media


48
00:01:44,486 --> 00:01:44,876
Intents.


49
00:01:45,806 --> 00:01:46,816
The first intent is


50
00:01:46,876 --> 00:01:48,006
INPlayMediaIntent.


51
00:01:49,106 --> 00:01:51,056
INPlayMediaIntent allows people


52
00:01:51,056 --> 00:01:52,516
to play audio by saying


53
00:01:52,566 --> 00:01:54,676
something like "Play Outer Peace


54
00:01:54,676 --> 00:01:55,746
in my app."


55
00:01:56,046 --> 00:01:58,346
Now, you might remember that we


56
00:01:58,346 --> 00:01:59,816
launched Media Playback Support


57
00:01:59,816 --> 00:02:01,746
in IOS 12 with Shortcuts.


58
00:02:02,256 --> 00:02:03,696
And this year, we're adding


59
00:02:03,696 --> 00:02:04,826
SiriKit features to


60
00:02:04,966 --> 00:02:07,206
INPlayMediaIntent.


61
00:02:07,796 --> 00:02:09,765
The next intent is


62
00:02:09,866 --> 00:02:10,946
INAddMediaIntent.


63
00:02:11,846 --> 00:02:14,046
INAddMediaIntent allows people


64
00:02:14,536 --> 00:02:16,146
to add items to their playlists


65
00:02:16,186 --> 00:02:16,926
and libraries.


66
00:02:17,626 --> 00:02:20,376
An example of this could be "add


67
00:02:20,406 --> 00:02:21,676
this song to my road trip


68
00:02:21,676 --> 00:02:24,486
playlist in my app."


69
00:02:25,096 --> 00:02:25,526
We have


70
00:02:25,526 --> 00:02:27,636
INUpdateMediaAffinityIntent,


71
00:02:27,756 --> 00:02:29,096
which allows people to express


72
00:02:29,096 --> 00:02:30,456
affinity for media items.


73
00:02:31,556 --> 00:02:32,746
People can say this by saying


74
00:02:32,746 --> 00:02:34,456
something as simple as "I like


75
00:02:34,456 --> 00:02:34,916
this song."


76
00:02:35,046 --> 00:02:38,186
And finally, we have


77
00:02:38,326 --> 00:02:40,416
INSearchForMediaIntent, which


78
00:02:40,416 --> 00:02:41,746
lets people search your app for


79
00:02:41,746 --> 00:02:43,156
a particular media item.


80
00:02:43,586 --> 00:02:46,156
For example, "Find Billie Eilish


81
00:02:46,156 --> 00:02:48,886
in my app."


82
00:02:50,126 --> 00:02:51,076
Let's talk about the supported


83
00:02:51,076 --> 00:02:52,496
media types in SiriKit Media.


84
00:02:53,366 --> 00:02:54,906
SiriKit Media supports a number


85
00:02:54,906 --> 00:02:56,206
of different audio types, with


86
00:02:56,206 --> 00:02:57,276
the first one being music.


87
00:02:58,036 --> 00:03:00,066
And music support is going to


88
00:03:00,066 --> 00:03:01,636
let you say things like "Play


89
00:03:01,636 --> 00:03:03,246
the song Awesome Song in my


90
00:03:03,246 --> 00:03:03,486
app."


91
00:03:04,766 --> 00:03:06,296
In addition to songs, we have


92
00:03:06,296 --> 00:03:07,696
support for albums, artists,


93
00:03:07,966 --> 00:03:09,756
playlists, genres, and many


94
00:03:09,756 --> 00:03:09,956
more.


95
00:03:09,956 --> 00:03:11,926
So you're going to want to check


96
00:03:11,926 --> 00:03:13,236
out the documentation for


97
00:03:13,236 --> 00:03:14,956
INMediaSearch to get the full


98
00:03:14,956 --> 00:03:16,386
list of supported search terms.


99
00:03:16,826 --> 00:03:18,506
And we want you to adopt as many


100
00:03:18,506 --> 00:03:20,386
of them as possible to provide


101
00:03:20,386 --> 00:03:22,286
the best Siri user experience in


102
00:03:22,286 --> 00:03:23,256
your app.


103
00:03:23,706 --> 00:03:24,976
Additionally, we have playback


104
00:03:24,976 --> 00:03:27,406
controls, like shuffle, repeat,


105
00:03:27,516 --> 00:03:28,256
and playback queues.


106
00:03:28,506 --> 00:03:30,566
And this lets people say things


107
00:03:30,566 --> 00:03:32,246
like "Play Khalid shuffle in my


108
00:03:32,246 --> 00:03:34,926
app," or, "Play Outer Peace next


109
00:03:35,196 --> 00:03:35,646
in my app."


110
00:03:38,916 --> 00:03:40,386
The next supported audio type is


111
00:03:40,446 --> 00:03:40,916
Podcasts.


112
00:03:41,866 --> 00:03:42,826
People can begin playing


113
00:03:42,826 --> 00:03:44,026
podcasts by saying something


114
00:03:44,026 --> 00:03:45,416
like "Put on the Stuff You


115
00:03:45,416 --> 00:03:46,806
Should Know podcast for my app."


116
00:03:47,956 --> 00:03:49,626
Additionally, people can also


117
00:03:49,626 --> 00:03:51,076
control the playback order and


118
00:03:51,076 --> 00:03:53,106
speeds of podcast episodes.


119
00:03:53,996 --> 00:03:55,266
This lets people say something


120
00:03:55,266 --> 00:03:56,916
like "Play the newest episode of


121
00:03:56,916 --> 00:03:58,246
Stuff You Should Know podcast in


122
00:03:58,246 --> 00:04:00,286
my app," or, "Play the Stuff You


123
00:04:00,286 --> 00:04:01,836
Should Know podcast in my app at


124
00:04:01,836 --> 00:04:02,456
double speed."


125
00:04:05,686 --> 00:04:07,046
Moving on, we have audiobook


126
00:04:07,046 --> 00:04:07,546
support.


127
00:04:08,336 --> 00:04:09,846
This lets people say things like


128
00:04:10,256 --> 00:04:11,646
"Play the audiobook Becoming in


129
00:04:11,646 --> 00:04:11,986
my app."


130
00:04:12,426 --> 00:04:14,536
And like Podcasts, people can


131
00:04:14,536 --> 00:04:16,005
begin to playback at a specific


132
00:04:16,005 --> 00:04:17,065
speed when asking to play


133
00:04:17,065 --> 00:04:17,516
audiobooks.


134
00:04:18,276 --> 00:04:20,616
And finally, we have radio


135
00:04:20,616 --> 00:04:20,966
support.


136
00:04:21,875 --> 00:04:23,536
Radio support allows people to


137
00:04:23,536 --> 00:04:25,346
ask for a specific radio station


138
00:04:25,346 --> 00:04:26,556
in your Radio Playback app.


139
00:04:27,206 --> 00:04:29,796
For example, "Play 89.1 FM in my


140
00:04:29,796 --> 00:04:29,956
app."


141
00:04:32,586 --> 00:04:33,956
And don't worry if your app


142
00:04:33,956 --> 00:04:35,006
doesn't fall into one of the


143
00:04:35,006 --> 00:04:36,586
previous media types, you can


144
00:04:36,586 --> 00:04:37,996
still adopt the SiriKit Media


145
00:04:37,996 --> 00:04:39,826
Intent and get the full power.


146
00:04:40,926 --> 00:04:41,706
People will be able to say


147
00:04:41,706 --> 00:04:43,456
things like "Play search term in


148
00:04:43,456 --> 00:04:44,886
my app," and you'll be able to


149
00:04:44,886 --> 00:04:45,986
look up search term in your app


150
00:04:45,986 --> 00:04:46,636
and play it.


151
00:04:46,926 --> 00:04:48,796
The only thing that will be


152
00:04:48,796 --> 00:04:49,986
missing will be support for


153
00:04:49,986 --> 00:04:51,216
strongly parsed media types.


154
00:04:51,746 --> 00:04:52,976
So say you had a nature sounds


155
00:04:52,976 --> 00:04:55,356
app and you said "Play reptile


156
00:04:55,356 --> 00:04:57,296
sounds in my app," or, "Play


157
00:04:57,296 --> 00:04:59,426
mammal sounds in my app," Siri


158
00:04:59,426 --> 00:05:00,326
is not going to know that those


159
00:05:00,326 --> 00:05:01,196
are two different types of


160
00:05:01,196 --> 00:05:01,796
animal sounds.


161
00:05:02,116 --> 00:05:04,306
So you'd get a string of mammal


162
00:05:04,306 --> 00:05:07,716
sounds or reptile sounds, and


163
00:05:07,976 --> 00:05:09,066
you could look it up and play


164
00:05:09,066 --> 00:05:09,166
it.


165
00:05:09,306 --> 00:05:10,856
So not quite as structured as


166
00:05:10,856 --> 00:05:12,396
the other types but still


167
00:05:14,766 --> 00:05:15,026
supported.


168
00:05:16,536 --> 00:05:17,456
Let's look at how we handle


169
00:05:17,456 --> 00:05:19,106
these intents in SiriKit.


170
00:05:21,276 --> 00:05:23,666
So the first thing to know about


171
00:05:24,076 --> 00:05:25,336
how to request with SiriKit


172
00:05:25,336 --> 00:05:26,936
Media is that SiriKit Media


173
00:05:26,936 --> 00:05:28,436
Intents are just like any other


174
00:05:28,436 --> 00:05:29,156
SiriKit domain.


175
00:05:30,196 --> 00:05:31,486
So all the intent-handling


176
00:05:31,806 --> 00:05:32,906
happens in your Intents app


177
00:05:32,906 --> 00:05:35,136
extension, where you conform to


178
00:05:35,136 --> 00:05:36,266
the SiriKit Media Intent


179
00:05:36,266 --> 00:05:36,966
handling protocols.


180
00:05:37,516 --> 00:05:39,626
The details of SiriKit request


181
00:05:39,626 --> 00:05:40,516
handling have been covered


182
00:05:40,516 --> 00:05:42,326
really well in previous WWDC


183
00:05:42,326 --> 00:05:44,086
talks, so I'd refer you to those


184
00:05:44,156 --> 00:05:45,906
talks and to the developer


185
00:05:45,906 --> 00:05:47,616
documentation online for more


186
00:05:47,616 --> 00:05:49,596
general details about SiriKit


187
00:05:49,596 --> 00:05:50,276
Request Processing.


188
00:05:53,196 --> 00:05:54,846
Now let's look at what happens


189
00:05:54,846 --> 00:05:56,516
for a typical request in the


190
00:05:56,586 --> 00:05:57,546
SiriKit Media domain.


191
00:05:58,986 --> 00:06:00,236
The request processing begins


192
00:06:00,436 --> 00:06:01,886
when someone says "Play cool


193
00:06:01,886 --> 00:06:02,826
song in my app."


194
00:06:03,346 --> 00:06:04,726
And Siri is going to recognize


195
00:06:04,726 --> 00:06:05,796
that this is a request for your


196
00:06:05,796 --> 00:06:07,146
app, it's going to launch your


197
00:06:07,146 --> 00:06:07,906
Intents Extension.


198
00:06:08,806 --> 00:06:09,906
Now, there are three steps in


199
00:06:09,906 --> 00:06:11,116
SiriKit Request Processing:


200
00:06:11,926 --> 00:06:13,456
resolve, confirm, and handle.


201
00:06:13,706 --> 00:06:16,856
The first step in request


202
00:06:16,856 --> 00:06:18,206
processing is the resolve step.


203
00:06:18,726 --> 00:06:20,666
In the media domain, the resolve


204
00:06:20,666 --> 00:06:21,886
step is where we take the


205
00:06:21,886 --> 00:06:24,086
intents' INMediaSearch object


206
00:06:24,426 --> 00:06:26,306
and we run a search against our


207
00:06:26,306 --> 00:06:26,966
app catalog.


208
00:06:27,896 --> 00:06:29,406
The output of resolve is one or


209
00:06:29,406 --> 00:06:31,436
more concrete media item objects


210
00:06:31,436 --> 00:06:31,756
to play.


211
00:06:33,056 --> 00:06:34,696
Alternatively, if we didn't find


212
00:06:34,696 --> 00:06:36,526
anything that matched or another


213
00:06:36,526 --> 00:06:38,276
error occurred, we can return an


214
00:06:38,276 --> 00:06:39,986
unsupported result, which will


215
00:06:39,986 --> 00:06:41,346
tell Siri to display the


216
00:06:41,346 --> 00:06:44,776
appropriate error dialog.


217
00:06:45,276 --> 00:06:46,306
The next step in Request


218
00:06:46,306 --> 00:06:47,576
Processing is the confirm step.


219
00:06:48,706 --> 00:06:50,426
And typically, we discourage use


220
00:06:50,426 --> 00:06:51,646
of the confirm step in the Media


221
00:06:51,646 --> 00:06:51,926
domain.


222
00:06:52,826 --> 00:06:54,156
In looking at usage in our own


223
00:06:54,156 --> 00:06:56,516
apps, we find that using confirm


224
00:06:57,136 --> 00:06:58,526
actually lowers the likelihood


225
00:06:58,526 --> 00:06:59,866
that people will continue on to


226
00:06:59,896 --> 00:07:00,376
play media.


227
00:07:00,876 --> 00:07:01,926
So we don't recommend using the


228
00:07:01,926 --> 00:07:03,156
confirm step in the Media


229
00:07:03,156 --> 00:07:03,456
domain.


230
00:07:04,076 --> 00:07:06,976
The final step in Request


231
00:07:06,976 --> 00:07:09,066
Processing is the handle step.


232
00:07:09,226 --> 00:07:11,716
Now, for INPlayMediaIntent, this


233
00:07:11,716 --> 00:07:12,776
ends up being really simple,


234
00:07:12,996 --> 00:07:13,996
because we're going to return


235
00:07:13,996 --> 00:07:15,766
the response code "handle an


236
00:07:15,946 --> 00:07:17,256
app," which is going to do a


237
00:07:17,256 --> 00:07:18,456
background app launch.


238
00:07:19,426 --> 00:07:23,076
And inside of our background app


239
00:07:23,076 --> 00:07:25,116
launch, we're just going to play


240
00:07:25,116 --> 00:07:26,846
media like we normally do in our


241
00:07:26,906 --> 00:07:26,973
app.


242
00:07:26,973 --> 00:07:29,106
The only tricky part here is


243
00:07:29,166 --> 00:07:29,446
testing.


244
00:07:29,446 --> 00:07:30,566
You're going to want to make


245
00:07:30,566 --> 00:07:31,676
sure everything plays because


246
00:07:31,676 --> 00:07:32,466
there's not going to be any UI


247
00:07:32,466 --> 00:07:33,146
on screen.


248
00:07:33,146 --> 00:07:34,106
You're also going to want to


249
00:07:34,106 --> 00:07:35,506
make sure that you test in a


250
00:07:35,506 --> 00:07:36,746
variety of situations.


251
00:07:37,086 --> 00:07:39,576
For example, in CarPlay or when


252
00:07:39,576 --> 00:07:40,336
you're wearing headphones.


253
00:07:40,726 --> 00:07:41,766
So now that we've seen an


254
00:07:41,766 --> 00:07:43,526
overview of SiriKit Request


255
00:07:43,526 --> 00:07:45,386
Processing, let's take a look at


256
00:07:45,386 --> 00:07:46,826
a simplified resolve media items


257
00:07:46,826 --> 00:07:47,106
method.


258
00:07:47,406 --> 00:07:48,986
And the first thing to note is


259
00:07:48,986 --> 00:07:50,366
that the parameters are going to


260
00:07:50,366 --> 00:07:52,166
be slightly different but the


261
00:07:52,216 --> 00:07:53,636
same resolve logic is going to


262
00:07:53,636 --> 00:07:55,286
be the same for all four media


263
00:07:55,286 --> 00:07:55,776
intents.


264
00:07:56,686 --> 00:07:58,406
Resolve's job is to search the


265
00:07:58,406 --> 00:07:59,086
app catalog.


266
00:07:59,086 --> 00:08:00,296
And you're going to want to do


267
00:08:00,296 --> 00:08:01,516
it the same way for all four


268
00:08:02,446 --> 00:08:02,676
intents.


269
00:08:03,616 --> 00:08:06,126
So we'll initialize a result to


270
00:08:06,126 --> 00:08:07,056
the unsupported result.


271
00:08:07,056 --> 00:08:08,676
And this is going to tell Siri


272
00:08:08,676 --> 00:08:09,726
to say the appropriate error


273
00:08:09,726 --> 00:08:11,566
dialogue if we don't find


274
00:08:11,566 --> 00:08:14,536
anything in our app catalog.


275
00:08:15,466 --> 00:08:16,976
INMediaSearch is the intent


276
00:08:16,976 --> 00:08:18,426
field that contains the details


277
00:08:18,426 --> 00:08:19,466
about what the user asks to


278
00:08:19,466 --> 00:08:19,666
play.


279
00:08:20,686 --> 00:08:22,166
INMediaSearch represents the


280
00:08:22,166 --> 00:08:23,216
universe of all the


281
00:08:23,216 --> 00:08:24,666
audio-related queries that Siri


282
00:08:24,666 --> 00:08:25,206
supports.


283
00:08:26,196 --> 00:08:27,716
Our job in Resolve is to go from


284
00:08:27,716 --> 00:08:29,006
that universe of possibilities


285
00:08:29,536 --> 00:08:30,716
to a single item to play.


286
00:08:31,626 --> 00:08:33,246
And in this example, the first


287
00:08:33,246 --> 00:08:34,946
thing we're going to do is read


288
00:08:34,946 --> 00:08:36,236
the media name off the


289
00:08:36,236 --> 00:08:37,166
INMediaSearch.


290
00:08:39,376 --> 00:08:40,926
Then we're going to retrieve a


291
00:08:40,926 --> 00:08:42,246
list of items from our app


292
00:08:42,246 --> 00:08:42,716
catalog.


293
00:08:43,676 --> 00:08:46,436
And we're going to use the media


294
00:08:46,436 --> 00:08:47,496
name property off the media


295
00:08:47,496 --> 00:08:48,906
search to compare against the


296
00:08:48,906 --> 00:08:50,786
item's name property.


297
00:08:51,296 --> 00:08:53,956
And we'll talk a little bit more


298
00:08:53,956 --> 00:08:55,346
about this later on, but this


299
00:08:55,386 --> 00:08:56,276
isn't really something you're


300
00:08:56,276 --> 00:08:57,416
going to want to do in your


301
00:08:57,416 --> 00:08:58,906
shipping app.


302
00:08:59,696 --> 00:09:02,346
But if we had an exact match on


303
00:09:02,346 --> 00:09:04,326
the name, we found the item to


304
00:09:04,326 --> 00:09:05,996
play, and we're going to create


305
00:09:05,996 --> 00:09:07,796
a success result using that


306
00:09:07,796 --> 00:09:08,506
item's properties.


307
00:09:10,096 --> 00:09:11,996
Then we'll call a completion


308
00:09:11,996 --> 00:09:13,826
handler and move on to handle.


309
00:09:14,326 --> 00:09:17,386
And in this case, as we said


310
00:09:17,386 --> 00:09:19,196
before, handle ends up being


311
00:09:19,196 --> 00:09:20,786
very short, since all we're


312
00:09:20,786 --> 00:09:21,996
going to do is return the


313
00:09:22,076 --> 00:09:23,726
handleInApp success response


314
00:09:23,806 --> 00:09:23,996
code.


315
00:09:24,056 --> 00:09:25,586
And this is going to start the


316
00:09:25,586 --> 00:09:26,746
process of background launching


317
00:09:26,746 --> 00:09:27,116
our app.


318
00:09:28,186 --> 00:09:29,396
Now let's take a look at


319
00:09:29,456 --> 00:09:30,376
background app launch.


320
00:09:32,156 --> 00:09:33,666
The method that we implement in


321
00:09:33,666 --> 00:09:35,546
our app delegate to support


322
00:09:35,596 --> 00:09:36,886
background app launch is


323
00:09:37,276 --> 00:09:38,886
application handling intent


324
00:09:39,216 --> 00:09:39,856
completion handler.


325
00:09:41,846 --> 00:09:43,306
Again, this is a pretty short


326
00:09:43,306 --> 00:09:44,026
implementation.


327
00:09:44,026 --> 00:09:47,416
We're going to read the first


328
00:09:47,416 --> 00:09:48,966
media item to play out of the


329
00:09:48,966 --> 00:09:51,796
intent and then we're going to


330
00:09:51,796 --> 00:09:53,216
just play it in our app the way


331
00:09:53,216 --> 00:09:53,836
we normally do.


332
00:09:55,796 --> 00:09:57,256
And finally, we'll call the


333
00:09:57,256 --> 00:09:58,886
completion handler with our


334
00:09:58,886 --> 00:10:00,786
success response code.


335
00:10:01,856 --> 00:10:03,446
So now that we've seen the new


336
00:10:03,446 --> 00:10:04,786
intents and how they all fit


337
00:10:04,866 --> 00:10:06,526
together, let's hand it over to


338
00:10:06,526 --> 00:10:08,286
Ryan Klems, who's going to show


339
00:10:08,286 --> 00:10:09,906
us how this all works in a real


340
00:10:10,096 --> 00:10:10,166
app.


341
00:10:11,516 --> 00:10:17,216
[ Applause ]


342
00:10:17,716 --> 00:10:18,346
>> Thanks, Danny.


343
00:10:20,816 --> 00:10:22,066
Adding SiriKit Media Intent


344
00:10:22,066 --> 00:10:23,216
handling to your existing media


345
00:10:23,216 --> 00:10:24,196
application is easy.


346
00:10:24,616 --> 00:10:25,536
Here we have our music


347
00:10:25,536 --> 00:10:26,846
application and all we need to


348
00:10:26,846 --> 00:10:29,176
do to add Siri support is to add


349
00:10:29,176 --> 00:10:30,636
the Siri extension target, add a


350
00:10:30,636 --> 00:10:33,496
few methods, and then we'll up


351
00:10:33,496 --> 00:10:34,816
and handling Siri requests in no


352
00:10:34,816 --> 00:10:35,086
time.


353
00:10:36,056 --> 00:10:36,966
To add to the intent's


354
00:10:36,966 --> 00:10:38,176
extension, all we have to do is


355
00:10:38,176 --> 00:10:41,226
go to file, new, target, select


356
00:10:42,516 --> 00:10:45,326
the intents extension and click


357
00:10:45,326 --> 00:10:45,796
next.


358
00:10:46,236 --> 00:10:50,896
Give it a name and then click


359
00:10:50,896 --> 00:10:51,336
finish.


360
00:10:53,716 --> 00:10:55,396
It will go ahead and create our


361
00:10:55,396 --> 00:10:56,516
intent handler for us.


362
00:10:57,256 --> 00:10:59,486
We'll want to go ahead and add


363
00:10:59,756 --> 00:11:01,196
the Siri capability to our


364
00:11:01,196 --> 00:11:01,836
application.


365
00:11:05,576 --> 00:11:07,166
And then we'll come over to our


366
00:11:07,166 --> 00:11:09,896
control extension and we will


367
00:11:09,896 --> 00:11:12,406
add our intents that we support,


368
00:11:12,406 --> 00:11:13,456
and in this example, we'll just


369
00:11:13,456 --> 00:11:14,736
go ahead and support the


370
00:11:15,806 --> 00:11:19,266
INPlayMediaIntent and the


371
00:11:19,266 --> 00:11:20,406
INAddMediaIntent.


372
00:11:27,046 --> 00:11:27,836
We'll go ahead and select the


373
00:11:27,836 --> 00:11:28,656
music type.


374
00:11:30,646 --> 00:11:31,896
We have a few methods here that


375
00:11:31,896 --> 00:11:33,406
we want to add to make sure that


376
00:11:33,406 --> 00:11:34,836
we build in our extension.


377
00:11:40,726 --> 00:11:41,666
And we'll want to make sure to


378
00:11:41,666 --> 00:11:44,976
turn on our proper code signing.


379
00:11:46,156 --> 00:11:47,396
Now we'll come over to our


380
00:11:47,396 --> 00:11:49,496
intent handler and all we need


381
00:11:49,496 --> 00:11:51,086
to do is add support for the


382
00:11:51,086 --> 00:11:52,516
INPlayMediaIntent handling


383
00:11:52,516 --> 00:11:53,016
protocol.


384
00:11:53,716 --> 00:11:57,636
And then we'll drop in some


385
00:11:57,636 --> 00:12:01,526
stubs for our resolve and handle


386
00:12:02,586 --> 00:12:03,196
methods.


387
00:12:03,276 --> 00:12:06,436
For this beginning example,


388
00:12:06,526 --> 00:12:07,436
we're just going to return the


389
00:12:07,436 --> 00:12:10,566
unsupported result from resolve


390
00:12:10,566 --> 00:12:11,856
media items, which will cause


391
00:12:11,856 --> 00:12:13,096
Siri to speak to the fact that


392
00:12:13,136 --> 00:12:14,256
it couldn't find the item.


393
00:12:15,096 --> 00:12:16,296
So we'll go ahead and try that


394
00:12:16,296 --> 00:12:16,506
out.


395
00:12:16,846 --> 00:12:17,536
This is what that would've


396
00:12:17,536 --> 00:12:17,936
looked like.


397
00:12:28,096 --> 00:12:30,376
So Siri speaks to the fact that


398
00:12:30,376 --> 00:12:32,446
it couldn't find the item due to


399
00:12:32,446 --> 00:12:33,326
the fact that we returned the


400
00:12:33,326 --> 00:12:35,656
unsupported from the intent


401
00:12:35,656 --> 00:12:35,936
handler.


402
00:12:37,366 --> 00:12:39,286
So what we'll do now is we'll go


403
00:12:39,286 --> 00:12:41,326
ahead and hook this up to our


404
00:12:41,326 --> 00:12:42,766
existing search implementation.


405
00:12:48,056 --> 00:12:50,456
And in this case, the first


406
00:12:50,456 --> 00:12:51,076
thing that we're going to want


407
00:12:51,076 --> 00:12:52,496
to do is determine what the user


408
00:12:52,496 --> 00:12:53,206
is searching for.


409
00:12:53,206 --> 00:12:55,096
So for this simple example,


410
00:12:55,096 --> 00:12:57,136
we'll just search for an artist.


411
00:12:57,846 --> 00:13:03,046
And in the method, we'll go


412
00:13:03,046 --> 00:13:06,106
ahead and resolve the media


413
00:13:06,106 --> 00:13:06,476
item.


414
00:13:24,046 --> 00:13:25,146
And once we resolve the media


415
00:13:25,146 --> 00:13:27,196
item, then we will return to our


416
00:13:27,196 --> 00:13:28,966
handle method and we're just


417
00:13:28,966 --> 00:13:30,456
going to return the handleInApp


418
00:13:31,236 --> 00:13:33,176
method response code, which will


419
00:13:33,176 --> 00:13:34,656
cause us to background launch


420
00:13:34,656 --> 00:13:35,346
the application.


421
00:13:35,346 --> 00:13:36,326
So in order to do that, we'll


422
00:13:36,326 --> 00:13:37,566
switch over to our app delegate


423
00:13:38,436 --> 00:13:41,176
and we need to add the handle


424
00:13:41,176 --> 00:13:41,866
intent method.


425
00:13:42,356 --> 00:13:43,796
And this will just extract the


426
00:13:43,796 --> 00:13:45,806
INMediaItem that we passed, that


427
00:13:45,806 --> 00:13:46,886
we resolved, in the previous


428
00:13:46,886 --> 00:13:48,796
step, and pass that to playback.


429
00:13:49,506 --> 00:13:51,656
And so we'll go ahead and play


430
00:13:51,656 --> 00:13:53,506
what that would look like.


431
00:13:59,456 --> 00:14:00,766
So you can see, we return the


432
00:14:00,896 --> 00:14:02,896
INMediaItem and it has resolved


433
00:14:02,896 --> 00:14:04,706
that, handed it back to the


434
00:14:04,706 --> 00:14:06,456
application, and begun playback.


435
00:14:07,436 --> 00:14:08,486
So now that we've done that, why


436
00:14:08,486 --> 00:14:09,476
don't we go ahead and add


437
00:14:09,476 --> 00:14:12,696
support for the add method.


438
00:14:12,756 --> 00:14:14,436
So to do that, we'll just extend


439
00:14:14,436 --> 00:14:16,446
this by adding the


440
00:14:16,446 --> 00:14:17,776
INAddMediaIntent handling


441
00:14:17,776 --> 00:14:18,256
protocol.


442
00:14:22,836 --> 00:14:25,146
And then we'll add our methods


443
00:14:25,186 --> 00:14:27,706
for resolving and handling for


444
00:14:27,706 --> 00:14:28,356
the add method.


445
00:14:29,316 --> 00:14:30,166
So you notice here that the


446
00:14:30,166 --> 00:14:31,636
resolve media items for add


447
00:14:31,636 --> 00:14:33,646
looks pretty much identical to


448
00:14:33,646 --> 00:14:35,066
the resolve method for play.


449
00:14:36,966 --> 00:14:38,456
Additionally, now for ad, we'll


450
00:14:38,456 --> 00:14:39,706
also have a resolve media


451
00:14:39,706 --> 00:14:40,456
destination.


452
00:14:40,536 --> 00:14:41,316
And this is where we're going to


453
00:14:41,316 --> 00:14:42,166
determine whether the user's


454
00:14:42,166 --> 00:14:43,396
trying to add to the library or


455
00:14:43,396 --> 00:14:44,196
to a playlist.


456
00:14:45,186 --> 00:14:46,316
And in the case of a playlist,


457
00:14:46,316 --> 00:14:47,126
you might want to do something


458
00:14:47,126 --> 00:14:49,246
like "Return playlist name not


459
00:14:49,246 --> 00:14:51,526
found," if the playlist that the


460
00:14:51,526 --> 00:14:53,236
user specified was not present


461
00:14:53,236 --> 00:14:53,966
in their library.


462
00:14:56,686 --> 00:14:59,136
And also, what's different in


463
00:14:59,196 --> 00:15:00,716
the ad is there's no reason to


464
00:15:00,716 --> 00:15:02,196
go back to the application like


465
00:15:02,306 --> 00:15:03,816
to begin playback like we do in


466
00:15:03,816 --> 00:15:04,866
the Play Media Intent.


467
00:15:05,316 --> 00:15:06,476
So in this case what we would do


468
00:15:06,476 --> 00:15:07,336
is we would actually handle


469
00:15:07,396 --> 00:15:08,746
everything in the extension


470
00:15:08,746 --> 00:15:09,146
itself.


471
00:15:09,776 --> 00:15:11,756
So we have the resolved media


472
00:15:11,756 --> 00:15:12,786
item, and we'll just go ahead


473
00:15:12,786 --> 00:15:15,646
and use our applications methods


474
00:15:15,646 --> 00:15:16,966
to add to the library or to the


475
00:15:17,066 --> 00:15:17,566
playlist.


476
00:15:17,966 --> 00:15:18,766
And in this case, we're just


477
00:15:18,766 --> 00:15:19,896
going to use the media player


478
00:15:19,896 --> 00:15:21,366
utilities to add to it.


479
00:15:22,126 --> 00:15:23,226
So let's go ahead and take a


480
00:15:23,226 --> 00:15:24,026
look at what that would look


481
00:15:24,076 --> 00:15:24,246
like.


482
00:15:37,316 --> 00:15:38,546
So it speaks to the item that is


483
00:15:38,546 --> 00:15:39,976
added to the playlist as well as


484
00:15:39,976 --> 00:15:41,076
the playlist name, because those


485
00:15:41,076 --> 00:15:43,426
are specified in the request.


486
00:15:44,456 --> 00:15:45,846
So as you can see, it's


487
00:15:45,846 --> 00:15:47,376
relatively easy to add support


488
00:15:47,376 --> 00:15:48,236
to your application.


489
00:15:48,236 --> 00:15:49,186
And we really look forward to


490
00:15:49,186 --> 00:15:50,606
seeing what you do in your


491
00:15:50,606 --> 00:15:51,156
application.


492
00:15:51,336 --> 00:15:51,626
Thank you.


493
00:15:52,016 --> 00:15:53,586
[ Applause ]


494
00:15:53,586 --> 00:15:54,246
Danny, back to you.


495
00:15:57,756 --> 00:15:58,356
>> Thanks, Ryan.


496
00:15:58,966 --> 00:16:00,216
So what did Ryan show us?


497
00:16:00,826 --> 00:16:02,306
First, he showed us how to add


498
00:16:02,306 --> 00:16:03,776
our intents extension to our


499
00:16:04,516 --> 00:16:04,596
app.


500
00:16:04,596 --> 00:16:06,536
Then he showed us how to specify


501
00:16:06,536 --> 00:16:08,066
our supported intents and


502
00:16:08,066 --> 00:16:09,076
supported media types.


503
00:16:09,486 --> 00:16:11,106
And finally, he showed us how to


504
00:16:11,106 --> 00:16:13,676
implement resolve and handle for


505
00:16:13,676 --> 00:16:15,486
INPlayMediaIntent and


506
00:16:15,486 --> 00:16:17,416
INAddMediaIntent so we could


507
00:16:17,416 --> 00:16:19,646
immediately begin playing and


508
00:16:19,646 --> 00:16:22,286
adding media using Siri.


509
00:16:23,556 --> 00:16:25,036
So let's look at some best


510
00:16:25,036 --> 00:16:26,106
practices you're going to want


511
00:16:26,106 --> 00:16:27,936
to follow when you adopt SiriKit


512
00:16:27,936 --> 00:16:28,246
Media.


513
00:16:28,866 --> 00:16:31,686
We have great news if you've


514
00:16:31,686 --> 00:16:33,036
already implemented shortcut


515
00:16:33,036 --> 00:16:34,326
support for media playback.


516
00:16:35,116 --> 00:16:36,966
SiriKit Media uses the same code


517
00:16:37,056 --> 00:16:38,596
and handle and for background


518
00:16:38,596 --> 00:16:39,106
app launch.


519
00:16:40,176 --> 00:16:41,916
While Shortcuts operates on


520
00:16:41,916 --> 00:16:43,656
previously donated intents which


521
00:16:43,656 --> 00:16:45,206
don't require intent resolution,


522
00:16:45,886 --> 00:16:47,626
SiriKit does require a resolve


523
00:16:47,626 --> 00:16:47,896
step.


524
00:16:48,446 --> 00:16:49,416
So the two things you're going


525
00:16:49,416 --> 00:16:51,516
to need to add are your resolve


526
00:16:51,516 --> 00:16:52,976
method and your intent handler,


527
00:16:53,546 --> 00:16:54,226
and you're going to need to


528
00:16:54,226 --> 00:16:55,696
update your intents extension


529
00:16:55,696 --> 00:16:57,286
supported media types in Xcode


530
00:16:57,976 --> 00:16:59,556
so Siri knows what content types


531
00:16:59,556 --> 00:17:00,286
your app supports.


532
00:17:01,516 --> 00:17:03,256
The extensions handle method


533
00:17:03,256 --> 00:17:04,396
should be the same between both


534
00:17:04,396 --> 00:17:05,876
implementations and the


535
00:17:05,876 --> 00:17:08,205
background app launch to the app


536
00:17:08,205 --> 00:17:10,016
delegate's handle intent can be


537
00:17:10,016 --> 00:17:11,766
the same, as long as you use the


538
00:17:11,806 --> 00:17:13,705
same identifiers for your media


539
00:17:13,705 --> 00:17:14,036
items.


540
00:17:14,036 --> 00:17:17,096
So let's see what this looks


541
00:17:17,236 --> 00:17:17,415
like.


542
00:17:17,756 --> 00:17:18,695
Here's our Shortcuts


543
00:17:18,695 --> 00:17:19,915
implementation from last year.


544
00:17:20,445 --> 00:17:21,406
You'll notice that there's no


545
00:17:21,406 --> 00:17:22,516
resolve method, but the rest of


546
00:17:22,516 --> 00:17:22,976
it's the same.


547
00:17:23,705 --> 00:17:25,056
So to go from Shortcuts to


548
00:17:25,056 --> 00:17:27,546
SiriKit, we just add in our


549
00:17:27,546 --> 00:17:30,016
resolve method and we're good to


550
00:17:31,396 --> 00:17:31,476
go.


551
00:17:31,726 --> 00:17:32,926
Now let's talk about what you


552
00:17:32,926 --> 00:17:34,096
need to do to bring SiriKit


553
00:17:34,096 --> 00:17:37,656
Media Support to the Apple


554
00:17:37,656 --> 00:17:37,906
Watch.


555
00:17:37,906 --> 00:17:39,186
On watchOS, apps launch in the


556
00:17:39,186 --> 00:17:39,696
foreground.


557
00:17:40,086 --> 00:17:41,376
And the way you do that is by


558
00:17:41,376 --> 00:17:44,516
returning INPlayMediaIntent


559
00:17:44,516 --> 00:17:46,636
response code continueInApp from


560
00:17:46,906 --> 00:17:47,906
your handle method in your


561
00:17:47,906 --> 00:17:48,686
intent's extension.


562
00:17:50,196 --> 00:17:51,246
This code is going to do a


563
00:17:51,246 --> 00:17:52,776
foreground app launch and


564
00:17:52,776 --> 00:17:53,906
forward the intent to your


565
00:17:53,906 --> 00:17:55,386
WKExtension delegate in your


566
00:17:55,456 --> 00:17:55,546
app.


567
00:17:55,546 --> 00:17:59,486
You'll note that the apps handle


568
00:17:59,486 --> 00:18:00,676
method looks pretty similar to


569
00:18:00,676 --> 00:18:01,526
the one in iOS.


570
00:18:02,186 --> 00:18:03,596
The method signature is slightly


571
00:18:03,596 --> 00:18:05,006
different, but you're going to


572
00:18:05,006 --> 00:18:06,616
want to read the intent off the


573
00:18:06,616 --> 00:18:08,616
NSUser activities interaction


574
00:18:08,616 --> 00:18:09,066
property.


575
00:18:09,316 --> 00:18:11,256
And then, just like on iOS, you


576
00:18:11,256 --> 00:18:13,376
read the media item to play and


577
00:18:13,376 --> 00:18:15,406
start playback in your app.


578
00:18:16,516 --> 00:18:17,696
One word of caution.


579
00:18:17,696 --> 00:18:19,136
You're going to want to use the


580
00:18:19,136 --> 00:18:21,266
on-device cache in your resolve


581
00:18:21,266 --> 00:18:22,436
method on watchOS.


582
00:18:22,746 --> 00:18:24,446
Only go over the network if it's


583
00:18:24,546 --> 00:18:25,626
absolutely necessary.


584
00:18:26,446 --> 00:18:29,676
So we know that when someone


585
00:18:29,676 --> 00:18:31,876
says "Play Awesome Song in my


586
00:18:31,876 --> 00:18:33,926
app," the first step in Request


587
00:18:33,926 --> 00:18:35,566
Processing is to resolve the


588
00:18:35,566 --> 00:18:36,476
media items to play.


589
00:18:36,476 --> 00:18:38,506
And we looked at a previous


590
00:18:38,506 --> 00:18:40,276
implementation where we checked


591
00:18:40,276 --> 00:18:41,336
the value of the media item's


592
00:18:41,376 --> 00:18:43,356
name against the intent's media


593
00:18:43,356 --> 00:18:43,996
name property.


594
00:18:45,146 --> 00:18:46,796
And it was an exact match.


595
00:18:47,406 --> 00:18:49,076
So what are some edge cases that


596
00:18:49,076 --> 00:18:50,066
we didn't cover in that


597
00:18:50,066 --> 00:18:50,786
implementation?


598
00:18:51,306 --> 00:18:53,786
The first place that our


599
00:18:53,786 --> 00:18:54,856
previous method won't do the


600
00:18:54,856 --> 00:18:56,206
right thing is if we have a


601
00:18:56,206 --> 00:18:58,036
mismatch on either case or


602
00:18:58,036 --> 00:18:58,616
punctuation.


603
00:18:59,376 --> 00:19:01,426
So in this example, "Play hello


604
00:19:01,426 --> 00:19:02,896
in my app," we can see a few


605
00:19:02,896 --> 00:19:04,066
cases where exact string


606
00:19:04,066 --> 00:19:05,096
comparison will fail.


607
00:19:06,296 --> 00:19:07,666
The exact song title is


608
00:19:07,876 --> 00:19:09,206
uppercase HELLO with an


609
00:19:09,206 --> 00:19:09,986
exclamation point.


610
00:19:10,606 --> 00:19:11,856
But it's possible that the Siri


611
00:19:11,856 --> 00:19:13,096
speech engine could give us


612
00:19:13,296 --> 00:19:14,076
lowercase hello.


613
00:19:14,726 --> 00:19:16,026
Or maybe it gives us uppercase


614
00:19:16,026 --> 00:19:17,246
HELLO without the exclamation


615
00:19:17,246 --> 00:19:17,496
point.


616
00:19:18,026 --> 00:19:19,806
So it's really important that we


617
00:19:19,806 --> 00:19:21,916
ignore case and punctuation in


618
00:19:21,916 --> 00:19:23,426
our resolve method.


619
00:19:25,476 --> 00:19:27,736
Similarly, a lot of music


620
00:19:27,736 --> 00:19:28,876
entities have things in the


621
00:19:28,876 --> 00:19:30,686
title that people either won't


622
00:19:30,726 --> 00:19:33,026
say or they're going to say in a


623
00:19:33,026 --> 00:19:34,826
way that doesn't exactly match


624
00:19:34,826 --> 00:19:35,706
with the item's title.


625
00:19:36,556 --> 00:19:37,726
For instance, a lot of albums


626
00:19:37,816 --> 00:19:39,116
come in a deluxe edition


627
00:19:39,116 --> 00:19:39,536
variant.


628
00:19:39,886 --> 00:19:41,086
And people aren't going to say


629
00:19:41,086 --> 00:19:42,606
this when they ask to play the


630
00:19:42,606 --> 00:19:42,986
album.


631
00:19:44,346 --> 00:19:45,846
They aren't going to say "Play


632
00:19:45,846 --> 00:19:47,226
the album Outer Peace deluxe


633
00:19:47,226 --> 00:19:48,846
edition in my app," they'll say


634
00:19:48,846 --> 00:19:50,196
"Play the album Outer Peace in


635
00:19:50,306 --> 00:19:50,566
my app."


636
00:19:51,986 --> 00:19:53,086
And soundtracks are another


637
00:19:53,086 --> 00:19:53,506
example.


638
00:19:54,526 --> 00:19:55,596
People aren't going to say --


639
00:19:55,596 --> 00:19:57,006
they'll say "Play the Rocket Man


640
00:19:57,066 --> 00:19:58,016
soundtrack in my app."


641
00:19:58,836 --> 00:19:59,836
And they aren't going to say


642
00:19:59,836 --> 00:20:01,046
"Music from the motion picture."


643
00:20:02,536 --> 00:20:03,786
And finally, a lot of hip-hop


644
00:20:03,786 --> 00:20:05,376
songs have this featuring


645
00:20:05,376 --> 00:20:06,546
abbreviation in their title.


646
00:20:07,126 --> 00:20:09,966
So people either won't say it or


647
00:20:09,966 --> 00:20:10,696
they'll say the word


648
00:20:10,696 --> 00:20:11,166
"featuring."


649
00:20:11,346 --> 00:20:12,706
So exact match isn't going to


650
00:20:12,706 --> 00:20:13,666
work here either.


651
00:20:19,476 --> 00:20:21,756
And podcasts also have some


652
00:20:21,756 --> 00:20:23,036
cases where there is a mismatch


653
00:20:23,296 --> 00:20:25,076
between what people say and what


654
00:20:25,076 --> 00:20:26,126
entity titles are.


655
00:20:27,106 --> 00:20:29,116
So some podcasts have the word


656
00:20:29,116 --> 00:20:30,156
"podcast" in their title.


657
00:20:30,796 --> 00:20:32,616
So if someone said "Play the


658
00:20:32,686 --> 00:20:34,246
Stuff You Should Know podcast in


659
00:20:34,246 --> 00:20:36,706
my app," Siri could parse it as


660
00:20:37,136 --> 00:20:39,316
stuff you should know in a media


661
00:20:39,316 --> 00:20:40,836
item type of podcast.


662
00:20:41,436 --> 00:20:42,976
So an exact match isn't going to


663
00:20:42,976 --> 00:20:43,806
work here either.


664
00:20:44,726 --> 00:20:46,696
And additionally, some podcasts


665
00:20:46,806 --> 00:20:49,326
come in audio or video variants,


666
00:20:49,326 --> 00:20:50,676
and that audio or video word


667
00:20:50,916 --> 00:20:51,726
appears in the title.


668
00:20:52,606 --> 00:20:54,376
But SiriKit Media implies the


669
00:20:54,376 --> 00:20:56,426
audio variety, so people aren't


670
00:20:56,426 --> 00:20:59,716
going to say that either.


671
00:20:59,946 --> 00:21:01,076
Finally, remember that you're


672
00:21:01,076 --> 00:21:01,866
working with a speech


673
00:21:01,866 --> 00:21:03,756
recognizer, and the speech


674
00:21:03,756 --> 00:21:05,566
recognizer can come with word


675
00:21:05,566 --> 00:21:06,586
formatting variations.


676
00:21:06,996 --> 00:21:08,166
So if someone asks to play the


677
00:21:08,166 --> 00:21:10,106
song 81st, you can get the


678
00:21:10,106 --> 00:21:12,286
number 81 st or you can get the


679
00:21:12,326 --> 00:21:13,796
hyphenated eighty-first.


680
00:21:15,286 --> 00:21:16,416
Or if someone asks to play the


681
00:21:16,416 --> 00:21:17,866
song I Love You Son, you could


682
00:21:17,866 --> 00:21:19,786
get sun or son.


683
00:21:19,846 --> 00:21:23,116
Now, Siri is going to do the


684
00:21:23,116 --> 00:21:25,056
best job it can to give you the


685
00:21:25,056 --> 00:21:26,386
entity titles for the things


686
00:21:26,386 --> 00:21:27,086
that it knows about.


687
00:21:27,746 --> 00:21:30,496
But it's better for you to be


688
00:21:30,496 --> 00:21:33,546
flexible in your resolve method.


689
00:21:35,096 --> 00:21:38,136
When you implement your SiriKit


690
00:21:38,136 --> 00:21:39,846
Media Support, you control what


691
00:21:39,846 --> 00:21:42,246
Siri says by the INMediaItem


692
00:21:42,246 --> 00:21:43,446
objects you return from your


693
00:21:43,446 --> 00:21:44,046
resolve method.


694
00:21:44,976 --> 00:21:46,906
As you can see here, the user


695
00:21:46,906 --> 00:21:48,106
asks to play the song Maybe


696
00:21:48,106 --> 00:21:49,986
Sometime by Special Disaster


697
00:21:49,986 --> 00:21:51,436
team in Control Audio.


698
00:21:51,936 --> 00:21:53,856
And Siri said, "Here's Maybe


699
00:21:53,856 --> 00:21:55,536
Sometime by Special Disaster


700
00:21:55,536 --> 00:21:57,146
Team from Control Audio."


701
00:21:57,896 --> 00:22:00,316
In this case the returned


702
00:22:00,486 --> 00:22:02,826
INMediaItem had a title property


703
00:22:02,826 --> 00:22:04,756
of Maybe Sometime and an artist


704
00:22:04,756 --> 00:22:06,226
property of Special Disaster


705
00:22:06,226 --> 00:22:06,416
team.


706
00:22:07,306 --> 00:22:08,966
So make sure you always populate


707
00:22:09,486 --> 00:22:12,216
title, artist, and type in the


708
00:22:12,216 --> 00:22:13,946
returned media items, as these


709
00:22:13,976 --> 00:22:15,586
can all influence what Siri


710
00:22:15,586 --> 00:22:15,866
says.


711
00:22:16,686 --> 00:22:18,396
And one thing to note, if you


712
00:22:18,396 --> 00:22:19,686
return more than one item in


713
00:22:19,686 --> 00:22:21,226
your resolve method, Siri is


714
00:22:21,226 --> 00:22:22,376
going to speak to the first item


715
00:22:22,376 --> 00:22:23,506
in the list.


716
00:22:25,146 --> 00:22:26,966
It's super important that you


717
00:22:27,046 --> 00:22:28,596
handle error cases appropriately


718
00:22:28,596 --> 00:22:29,426
in SiriKit Media.


719
00:22:30,456 --> 00:22:31,426
When you're interacting with an


720
00:22:31,426 --> 00:22:32,926
intelligent assistant like Siri,


721
00:22:32,926 --> 00:22:34,996
it can be unclear why something


722
00:22:34,996 --> 00:22:35,946
happened when it happened.


723
00:22:36,376 --> 00:22:37,586
And handling error cases


724
00:22:37,586 --> 00:22:39,036
appropriately is going to allow


725
00:22:39,036 --> 00:22:40,506
you to give the user the best


726
00:22:40,506 --> 00:22:41,476
idea of what happened when


727
00:22:41,476 --> 00:22:42,186
something goes wrong.


728
00:22:43,136 --> 00:22:44,576
So the most common case you're


729
00:22:44,576 --> 00:22:45,906
going to run into is when you


730
00:22:45,906 --> 00:22:47,116
don't find something in your app


731
00:22:47,116 --> 00:22:48,136
catalog that someone's asked


732
00:22:48,136 --> 00:22:48,356
for.


733
00:22:48,476 --> 00:22:50,776
And you handle this case by just


734
00:22:50,776 --> 00:22:52,006
returning the unsupported


735
00:22:52,006 --> 00:22:53,626
resolution result from resolve


736
00:22:53,626 --> 00:22:54,186
media items.


737
00:22:55,236 --> 00:22:56,016
But there's a lot of other


738
00:22:56,016 --> 00:22:57,686
errors that could happen.


739
00:22:57,686 --> 00:22:58,676
Maybe someone asks to play


740
00:22:58,736 --> 00:23:00,416
something that requires cellular


741
00:23:00,416 --> 00:23:02,026
data but they have the cellular


742
00:23:02,026 --> 00:23:03,216
data switch turned off for your


743
00:23:04,186 --> 00:23:04,276
app.


744
00:23:04,696 --> 00:23:06,206
Or maybe they ask to play


745
00:23:06,206 --> 00:23:07,306
something that requires a


746
00:23:07,306 --> 00:23:08,836
subscription and they don't have


747
00:23:08,836 --> 00:23:09,016
one.


748
00:23:10,586 --> 00:23:11,426
The full list is in


749
00:23:11,556 --> 00:23:12,986
INPlayMediaMediaItem


750
00:23:12,986 --> 00:23:13,826
UnsupportedReason.


751
00:23:14,216 --> 00:23:15,476
And there's generally similar


752
00:23:15,476 --> 00:23:17,536
naming for all four intents, so


753
00:23:17,536 --> 00:23:18,766
make sure you adopt them for all


754
00:23:18,766 --> 00:23:19,756
the intents you support.


755
00:23:20,296 --> 00:23:21,846
Now let's talk about some of the


756
00:23:21,846 --> 00:23:23,316
variety of things that people


757
00:23:23,316 --> 00:23:25,106
say to Siri and how you can do a


758
00:23:25,106 --> 00:23:27,146
good job handling of them in


759
00:23:27,146 --> 00:23:28,086
your SiriKit Media


760
00:23:28,086 --> 00:23:28,826
implementation.


761
00:23:29,466 --> 00:23:32,306
So one of the most popular


762
00:23:32,306 --> 00:23:33,626
things that people say to Siri


763
00:23:33,626 --> 00:23:35,486
is "Play my app."


764
00:23:35,816 --> 00:23:36,906
They don't tell you exactly what


765
00:23:36,906 --> 00:23:38,196
it is that they want to play,


766
00:23:39,346 --> 00:23:41,386
and it's your job as a SiriKit


767
00:23:41,386 --> 00:23:43,276
Media developer to choose the


768
00:23:43,276 --> 00:23:45,816
right thing to do for your app.


769
00:23:46,036 --> 00:23:47,186
Now, this might be something as


770
00:23:47,186 --> 00:23:48,656
simple as resuming an existing


771
00:23:48,656 --> 00:23:49,036
queue.


772
00:23:49,716 --> 00:23:51,386
If you're not an audiobooks or


773
00:23:51,386 --> 00:23:53,196
podcasting app, this is probably


774
00:23:53,196 --> 00:23:54,356
the most reasonable behavior to


775
00:23:54,356 --> 00:23:54,726
implement.


776
00:23:55,976 --> 00:23:57,236
But you can make the behavior as


777
00:23:57,236 --> 00:23:58,096
dynamic as you like.


778
00:23:58,926 --> 00:24:00,996
Maybe you want to direct them to


779
00:24:00,996 --> 00:24:02,976
a recommended playlist or some


780
00:24:02,976 --> 00:24:04,036
hot new trending music.


781
00:24:04,616 --> 00:24:05,426
The choice is yours.


782
00:24:06,186 --> 00:24:07,266
And how do you know that someone


783
00:24:07,266 --> 00:24:09,336
said, "Play my app," well, there


784
00:24:09,336 --> 00:24:10,626
will be no search criteria


785
00:24:10,626 --> 00:24:12,306
specified in the INMediaSearch


786
00:24:12,306 --> 00:24:12,646
object.


787
00:24:13,246 --> 00:24:14,426
One thing that might seem like a


788
00:24:14,426 --> 00:24:16,396
good idea is to ask someone what


789
00:24:16,396 --> 00:24:17,016
they want to play.


790
00:24:17,016 --> 00:24:19,186
But for the same reason that we


791
00:24:19,186 --> 00:24:20,646
don't recommend using confirm,


792
00:24:21,196 --> 00:24:22,596
we don't recommend this


793
00:24:22,596 --> 00:24:22,986
approach.


794
00:24:23,746 --> 00:24:24,946
Putting dialogue prompts in


795
00:24:24,946 --> 00:24:26,686
front of people is one of the


796
00:24:26,686 --> 00:24:27,876
most common ways that they'll


797
00:24:27,876 --> 00:24:29,146
quit the SiriKit Media


798
00:24:29,146 --> 00:24:29,636
experience.


799
00:24:30,326 --> 00:24:33,766
People can ask to initiate


800
00:24:33,766 --> 00:24:34,706
playback with additional


801
00:24:34,706 --> 00:24:36,526
controls, and some of the


802
00:24:36,526 --> 00:24:37,876
supported options are repeat,


803
00:24:37,966 --> 00:24:39,466
shuffle, resume, and playback


804
00:24:39,466 --> 00:24:40,126
queue location.


805
00:24:41,136 --> 00:24:43,366
And if you support these in your


806
00:24:43,366 --> 00:24:45,216
app, make sure you support them


807
00:24:45,216 --> 00:24:46,866
in your INPlayMediaIntent


808
00:24:47,446 --> 00:24:48,456
implementation as well.


809
00:24:50,026 --> 00:24:51,196
And people can also ask to play


810
00:24:51,196 --> 00:24:52,326
content with a variety of search


811
00:24:52,326 --> 00:24:52,776
options.


812
00:24:53,586 --> 00:24:54,476
And one of the most useful


813
00:24:54,476 --> 00:24:55,726
search options is the sort


814
00:24:55,726 --> 00:24:56,156
parameter.


815
00:24:56,976 --> 00:24:58,196
You can say things like "Play


816
00:24:58,196 --> 00:24:59,406
the new Stuff You Should Know


817
00:24:59,406 --> 00:25:00,896
podcast in my app," and you'll


818
00:25:00,896 --> 00:25:02,446
get INMediaSortOrder newest.


819
00:25:03,306 --> 00:25:04,436
Or you can ask for the best


820
00:25:04,436 --> 00:25:05,816
album by an artist, and you'll


821
00:25:05,816 --> 00:25:08,006
get INMediaSortOrder best.


822
00:25:08,126 --> 00:25:09,566
Or you can ask your app for a


823
00:25:09,686 --> 00:25:11,296
recommendation, and you'll get


824
00:25:11,406 --> 00:25:13,026
INMediaSortOrder recommended.


825
00:25:13,866 --> 00:25:14,926
Check out the full list in


826
00:25:15,016 --> 00:25:15,966
INMediaSortOrder.


827
00:25:16,146 --> 00:25:19,396
And another powerful search


828
00:25:19,396 --> 00:25:20,876
option is the reference


829
00:25:20,876 --> 00:25:22,266
property, which can have


830
00:25:22,416 --> 00:25:23,696
INMediaReferenceCurrently


831
00:25:23,696 --> 00:25:24,046
Playing.


832
00:25:25,166 --> 00:25:26,356
This is really useful for


833
00:25:26,356 --> 00:25:27,766
INAddMediaIntent or


834
00:25:27,766 --> 00:25:30,056
INUpdateMediaIntent, because


835
00:25:30,056 --> 00:25:31,816
people can easily add the


836
00:25:31,816 --> 00:25:33,066
currently playing item to a


837
00:25:33,066 --> 00:25:35,206
library or a playlist, or they


838
00:25:35,206 --> 00:25:36,656
can tell your app that they love


839
00:25:36,656 --> 00:25:37,746
or they hate their currently


840
00:25:37,786 --> 00:25:38,306
playing item.


841
00:25:39,146 --> 00:25:41,006
And one thing to note too is if


842
00:25:41,006 --> 00:25:42,336
you've populated the external


843
00:25:42,336 --> 00:25:43,576
content identifier in


844
00:25:43,576 --> 00:25:46,096
MPNowPlayingInfo center, that


845
00:25:46,096 --> 00:25:47,436
identifier is going to be in


846
00:25:47,436 --> 00:25:48,876
INMediaSearch's identifier


847
00:25:48,876 --> 00:25:50,586
property, so you know exactly


848
00:25:50,586 --> 00:25:54,036
what item to find.


849
00:25:54,496 --> 00:25:56,556
Now, telling Siri more about how


850
00:25:56,556 --> 00:25:58,726
your customer uses your app is


851
00:25:58,786 --> 00:26:00,306
going to help Siri provide a


852
00:26:00,306 --> 00:26:01,806
wonderful SiriKit Media


853
00:26:01,806 --> 00:26:02,346
experience.


854
00:26:06,256 --> 00:26:08,256
So when you give user vocabulary


855
00:26:08,256 --> 00:26:10,426
to Siri, this helps Siri


856
00:26:10,476 --> 00:26:11,626
understand the parts of your


857
00:26:11,626 --> 00:26:13,446
catalog that are interesting to


858
00:26:13,446 --> 00:26:13,966
your customer.


859
00:26:14,906 --> 00:26:16,266
It's important to note it's not


860
00:26:16,266 --> 00:26:17,806
the entire contents of your app


861
00:26:17,806 --> 00:26:19,806
catalog, it's only the pieces of


862
00:26:19,836 --> 00:26:21,086
content that your customer is


863
00:26:21,086 --> 00:26:21,876
specifically interested in.


864
00:26:23,406 --> 00:26:25,056
It's also important to note that


865
00:26:25,056 --> 00:26:26,746
the vocabulary is ordered, so


866
00:26:26,746 --> 00:26:28,236
make sure that you include the


867
00:26:28,236 --> 00:26:29,916
most important items at the


868
00:26:29,916 --> 00:26:30,926
beginning of the collection.


869
00:26:32,146 --> 00:26:33,076
And depending on the type of


870
00:26:33,076 --> 00:26:34,706
media your app supports, you're


871
00:26:34,706 --> 00:26:35,776
going to send different types to


872
00:26:35,776 --> 00:26:36,106
Siri.


873
00:26:37,316 --> 00:26:39,466
Music apps should use playlist


874
00:26:39,466 --> 00:26:41,006
title and music artist name.


875
00:26:41,816 --> 00:26:43,206
Audiobook apps should use


876
00:26:43,336 --> 00:26:44,816
audiobook title and audiobook


877
00:26:44,816 --> 00:26:45,196
author.


878
00:26:45,926 --> 00:26:47,496
And podcasting apps should use


879
00:26:48,056 --> 00:26:48,636
show title.


880
00:26:50,256 --> 00:26:51,516
And for those things that are


881
00:26:51,516 --> 00:26:53,806
applicable to everybody that


882
00:26:53,806 --> 00:26:55,346
uses your app, check out the


883
00:26:55,346 --> 00:26:57,196
global vocabulary support in


884
00:26:57,196 --> 00:26:57,706
SiriKit.


885
00:26:58,486 --> 00:27:02,136
So in conclusion, we're


886
00:27:02,136 --> 00:27:03,746
launching new SiriKit Media


887
00:27:03,746 --> 00:27:05,906
Intents to allow you to use Siri


888
00:27:05,906 --> 00:27:07,776
to control your audio apps.


889
00:27:08,006 --> 00:27:09,796
You'll be able to play, add,


890
00:27:10,366 --> 00:27:11,976
update taste profiles, and


891
00:27:12,026 --> 00:27:13,336
search for media using the new


892
00:27:13,336 --> 00:27:13,716
intents.


893
00:27:14,876 --> 00:27:16,056
It's very important that you


894
00:27:16,056 --> 00:27:17,266
provide the best experience


895
00:27:17,266 --> 00:27:17,766
possible.


896
00:27:18,396 --> 00:27:20,486
And you can do this by embracing


897
00:27:20,486 --> 00:27:21,546
search flexibility.


898
00:27:22,296 --> 00:27:24,426
Because people don't say exactly


899
00:27:24,426 --> 00:27:25,226
what they want to play.


900
00:27:26,246 --> 00:27:27,366
You can handle errors


901
00:27:27,366 --> 00:27:29,486
appropriately, so people know


902
00:27:29,486 --> 00:27:30,756
what's happened when something


903
00:27:30,756 --> 00:27:31,206
goes wrong.


904
00:27:31,826 --> 00:27:32,816
And you're going to you want to


905
00:27:32,816 --> 00:27:34,006
make sure that you construct


906
00:27:34,326 --> 00:27:35,856
your INMediaItem objects


907
00:27:35,856 --> 00:27:37,996
appropriately so Siri can speak


908
00:27:38,116 --> 00:27:39,716
the best dialogue possible.


909
00:27:40,786 --> 00:27:42,336
And finally, make sure you give


910
00:27:42,336 --> 00:27:44,506
Siri the important contextual


911
00:27:44,506 --> 00:27:46,736
information possible so Siri can


912
00:27:46,736 --> 00:27:48,516
make the best choices possible


913
00:27:49,136 --> 00:27:50,326
on your customer's behalf.


914
00:27:51,106 --> 00:27:54,686
So come see us at the labs and


915
00:27:54,686 --> 00:27:55,796
check out the documentation


916
00:27:55,796 --> 00:27:56,106
online.


917
00:27:56,916 --> 00:27:57,756
We think you're going to love


918
00:27:57,756 --> 00:27:59,206
building apps with the new


919
00:27:59,206 --> 00:28:00,906
SiriKit Media Intents and we


920
00:28:00,906 --> 00:28:01,916
can't wait to see what you'll


921
00:28:01,916 --> 00:28:02,166
build.


922
00:28:02,766 --> 00:28:03,076
Thank you.


923
00:28:04,516 --> 00:28:07,500
[ Applause ]

