2
00:00:00.000 --> 00:00:02.269 line:-1 position:50%
[MAC STARTUP CHIME]


3
00:00:02.269 --> 00:00:05.539 line:-1 position:50%
♪ Bass music playing ♪


4
00:00:05.539 --> 00:00:07.174 line:-1 position:50%
[KEYSTROKES]


5
00:00:07,174 --> 00:00:09,610 align:right position:90% size:2%
♪


6
00:00:09.610 --> 00:00:11.612 line:-1 position:50%
Tommy Pauly: Hi,
I'm Tommy Pauly,


7
00:00:11.612 --> 00:00:14.014 line:-1 position:50%
and along with my colleague,
Delziel,


8
00:00:14,014 --> 00:00:15,582 line:-1
I'll be giving you
an introduction


9
00:00:15.582 --> 00:00:19.586 line:-1 position:50%
to an exciting new feature
in internet privacy.


10
00:00:19,586 --> 00:00:22,956 line:-1
iCloud Private Relay
is a new service


11
00:00:22.956 --> 00:00:25.492 line:-1 position:50%
that prevents
networks and servers


12
00:00:25,492 --> 00:00:29,363 line:-1
from monitoring user activity
across the internet.


13
00:00:29.363 --> 00:00:34.401 line:-1 position:50%
And it's available as part of
every iCloud+ subscription.


14
00:00:34,401 --> 00:00:36,803 line:-1
Private Relay
not only protects users


15
00:00:36.803 --> 00:00:40.307 line:-1 position:50%
when they're browsing the web,
but also adds protection


16
00:00:40.307 --> 00:00:42.743 line:-1 position:50%
to the traffic
generated by your app


17
00:00:42.743 --> 00:00:45.078 line:-1 position:50%
to make sure
you're not unintentionally


18
00:00:45.078 --> 00:00:47.247 line:-1 position:50%
leaking user information


19
00:00:47.247 --> 00:00:51.018 line:-1 position:50%
or exposing users
to security attacks.


20
00:00:51.018 --> 00:00:54.721 line:-1 position:50%
Today, you'll learn
what iCloud Private Relay is


21
00:00:54,721 --> 00:00:57,157 line:-1
and how it affects your app;


22
00:00:57.157 --> 00:01:01.595 line:-1 position:50%
how to ensure that your app
works great with Private Relay;


23
00:01:01,595 --> 00:01:04,798 line:-1
how to prepare
your websites and servers;


24
00:01:04.798 --> 00:01:07.501 line:-1 position:50%
and, lastly,
how to manage a network


25
00:01:07,501 --> 00:01:11,538 line:-1
and monitor your traffic
when Private Relay is enabled.


26
00:01:11,538 --> 00:01:14,041 line:-1
Let's get started.


27
00:01:14,041 --> 00:01:17,978 line:-1
Private Relay is
built into iOS and macOS,


28
00:01:17,978 --> 00:01:22,115 line:-1
so you don't need to do anything
to adopt it from your app.


29
00:01:22,115 --> 00:01:24,084 line:-1
It's also important
to understand


30
00:01:24.084 --> 00:01:26.920 line:-1 position:50%
that it won't always
be affecting your app.


31
00:01:26.920 --> 00:01:31.325 line:-1 position:50%
It will only apply when a user
is an iCloud+ subscriber


32
00:01:31,325 --> 00:01:34,127 line:-1
and has Private Relay enabled.


33
00:01:34,127 --> 00:01:38,332 line:-1
You're probably wondering,
What does it actually do?


34
00:01:38.332 --> 00:01:42.936 line:-1 position:50%
Here's how things currently work
without Private Relay.


35
00:01:42,936 --> 00:01:45,439 line:-1
When someone
accesses the internet,


36
00:01:45,439 --> 00:01:48,241 line:-1
anyone on their local network
can see the names


37
00:01:48.241 --> 00:01:50.711 line:-1 position:50%
of all of the websites
they access


38
00:01:50.711 --> 00:01:54.514 line:-1 position:50%
based on inspecting DNS queries.


39
00:01:54,514 --> 00:01:58,085 line:-1
This information can be used
to fingerprint a user


40
00:01:58.085 --> 00:02:01.755 line:-1 position:50%
and build a history of
their activity over time.


41
00:02:01.755 --> 00:02:03.824 line:-1 position:50%
No one should be able
to silently collect


42
00:02:03.824 --> 00:02:05.859 line:-1 position:50%
all of this information,


43
00:02:05,859 --> 00:02:08,261 line:-1
whether it's
a public Wi-Fi operator,


44
00:02:08,261 --> 00:02:13,667 line:-1
another user on the network,
or an internet service provider.


45
00:02:13.667 --> 00:02:17.137 line:-1 position:50%
When connections reach
the servers that run websites,


46
00:02:17.137 --> 00:02:20.974 line:-1 position:50%
those servers can see
the user's IP address.


47
00:02:20.974 --> 00:02:23.777 line:-1 position:50%
This allows the servers
to determine user location


48
00:02:23,777 --> 00:02:26,913 line:-1
without explicit permission.


49
00:02:26,913 --> 00:02:31,385 line:-1
Even worse, the servers are able
to fingerprint user identity


50
00:02:31,385 --> 00:02:34,621 line:-1
and recognize users
across different websites,


51
00:02:34,621 --> 00:02:39,226 line:-1
even when tools like Intelligent
Tracking Prevention in Safari


52
00:02:39.226 --> 00:02:42.629 line:-1 position:50%
are preventing correlation
via cookies.


53
00:02:42.629 --> 00:02:46.266 line:-1 position:50%
These are big problems
for user privacy,


54
00:02:46.266 --> 00:02:49.236 line:-1 position:50%
and in order to fix them,
we need a new approach


55
00:02:49,236 --> 00:02:53,774 line:-1
that has privacy built in
by design.


56
00:02:53.774 --> 00:02:57.778 line:-1 position:50%
iCloud Private Relay
adds multiple secure proxies


57
00:02:57,778 --> 00:03:01,715 line:-1
to help route user traffic
and keep it private.


58
00:03:01.715 --> 00:03:04.618 line:-1 position:50%
The proxies are run
by separate entities.


59
00:03:04.618 --> 00:03:09.189 line:-1 position:50%
One is Apple,
and one is a content provider.


60
00:03:09,189 --> 00:03:12,259 line:-1
Now, when someone
accesses the internet,


61
00:03:12,259 --> 00:03:15,162 line:-1
only the client IP address
is visible


62
00:03:15.162 --> 00:03:20.467 line:-1 position:50%
to both the network provider
and to the first proxy.


63
00:03:20,467 --> 00:03:25,105 line:-1
The second proxy only sees
the name the user is requesting


64
00:03:25.105 --> 00:03:29.743 line:-1 position:50%
and uses that to build
the connection to the server.


65
00:03:29.743 --> 00:03:32.546 line:-1 position:50%
It is critical to note
that no one in this chain --


66
00:03:32.546 --> 00:03:34.081 line:-1 position:50%
not even Apple --


67
00:03:34.081 --> 00:03:36.716 line:-1 position:50%
can see both
the client IP address


68
00:03:36.716 --> 00:03:39.586 line:-1 position:50%
and what the user is accessing.


69
00:03:39,586 --> 00:03:41,421 line:-1
The opportunities
for fingerprinting


70
00:03:41.421 --> 00:03:43.423 line:-1 position:50%
have been removed.


71
00:03:43,423 --> 00:03:48,161 line:-1
This is privacy by design.


72
00:03:48,161 --> 00:03:51,364 line:-1
Private Relay uses
the latest transport protocols


73
00:03:51,364 --> 00:03:53,867 line:-1
and privacy-preserving
authentication


74
00:03:53.867 --> 00:03:59.706 line:-1 position:50%
to ensure that every transaction
is both secure and fast.


75
00:03:59,706 --> 00:04:02,142 line:-1
You can learn more
about this technology


76
00:04:02.142 --> 00:04:07.147 line:-1 position:50%
in the “Apple's privacy pillars
in focus” session.


77
00:04:07.147 --> 00:04:09.816 line:-1 position:50%
Private Relay is
focused on securing


78
00:04:09,816 --> 00:04:12,519 line:-1
the most sensitive traffic
on the system


79
00:04:12.519 --> 00:04:15.922 line:-1 position:50%
without impacting
user experience.


80
00:04:15.922 --> 00:04:19.326 line:-1 position:50%
In iOS 15 and macOS 12,


81
00:04:19.326 --> 00:04:23.930 line:-1 position:50%
Private Relay will apply
to all web browsing in Safari,


82
00:04:23,930 --> 00:04:26,800 line:-1
all DNS name resolution queries,


83
00:04:26.800 --> 00:04:30.137 line:-1 position:50%
and a small subset of traffic
from apps.


84
00:04:30.137 --> 00:04:35.542 line:-1 position:50%
Specifically, this will include
all insecure HTTP traffic,


85
00:04:35,542 --> 00:04:39,813 line:-1
such as TCP port 80.


86
00:04:39.813 --> 00:04:42.449 line:-1 position:50%
If your app provides
a content filter


87
00:04:42.449 --> 00:04:44.584 line:-1 position:50%
or a parental controls filter,


88
00:04:44,584 --> 00:04:47,888 line:-1
it will still see traffic before
it goes through Private Relay,


89
00:04:47.888 --> 00:04:51.791 line:-1 position:50%
so you can apply your filters
just as before.


90
00:04:51.791 --> 00:04:53.193 line:-1 position:50%
You can learn more about this


91
00:04:53,193 --> 00:04:57,130 line:-1
in the "Meet the Screen Time
API" session.


92
00:04:57.130 --> 00:04:58.899 line:-1 position:50%
Not all networking
done by your app


93
00:04:58.899 --> 00:05:01.201 line:-1 position:50%
occurs over the public internet,


94
00:05:01,201 --> 00:05:03,537 line:-1
so there are several categories
of traffic


95
00:05:03.537 --> 00:05:07.507 line:-1 position:50%
that are not affected
by Private Relay.


96
00:05:07,507 --> 00:05:10,877 line:-1
Any connections your app makes
over the local network


97
00:05:10.877 --> 00:05:15.315 line:-1 position:50%
or to private domain names
will be unaffected.


98
00:05:15,315 --> 00:05:19,019 line:-1
Similarly, if your app provides
a network extension


99
00:05:19.019 --> 00:05:23.089 line:-1 position:50%
to add VPN
or app-proxying capabilities,


100
00:05:23,089 --> 00:05:25,792 line:-1
your extension
won't use Private Relay


101
00:05:25.792 --> 00:05:30.130 line:-1 position:50%
and neither will app traffic
that uses your extension.


102
00:05:30.130 --> 00:05:34.467 line:-1 position:50%
Traffic that uses a proxy
is also exempt.


103
00:05:34,467 --> 00:05:37,270 line:-1
Next, let's cover
what you need to do


104
00:05:37,270 --> 00:05:42,008 line:-1
to make sure your app is ready
to work well with Private Relay.


105
00:05:42.008 --> 00:05:44.778 line:-1 position:50%
The great news is that
for almost every app,


106
00:05:44,778 --> 00:05:47,380 line:-1
you don't need to do
anything new!


107
00:05:47.380 --> 00:05:50.217 line:-1 position:50%
Private Relay will just work.


108
00:05:50.217 --> 00:05:55.255 line:-1 position:50%
However, there are some best
practices you should know about.


109
00:05:55.255 --> 00:05:58.458 line:-1 position:50%
Private Relay works
no matter what networking API


110
00:05:58.458 --> 00:05:59.893 line:-1 position:50%
you're using.


111
00:05:59,893 --> 00:06:03,730 line:-1
For several years, we've
recommended that your apps use


112
00:06:03,730 --> 00:06:09,402 line:-1
modern APIs such as
URLSession and NWConnection.


113
00:06:09,402 --> 00:06:10,837 line:-1
Now, you have one more reason


114
00:06:10.837 --> 00:06:13.373 line:-1 position:50%
to adopt them
throughout your apps.


115
00:06:13.373 --> 00:06:17.143 line:-1 position:50%
These APIs provide you
the best tools


116
00:06:17.143 --> 00:06:22.882 line:-1 position:50%
to understand how Private Relay
is applying to your traffic.


117
00:06:22,882 --> 00:06:25,318 line:-1
If you use URLSession,


118
00:06:25,318 --> 00:06:28,588 line:-1
you can use
the Network Xcode Instrument


119
00:06:28.588 --> 00:06:30.857 line:-1 position:50%
to inspect your tasks,


120
00:06:30,857 --> 00:06:34,294 line:-1
even when they are going through
Private Relay.


121
00:06:34.294 --> 00:06:36.329 line:-1 position:50%
You can learn more
about how to do this


122
00:06:36.329 --> 00:06:42.168 line:-1 position:50%
in the "Analyze HTTP traffic
in Instruments" session.


123
00:06:42,168 --> 00:06:45,205 line:-1
And you can use metrics APIs
in both


124
00:06:45.205 --> 00:06:48.074 line:-1 position:50%
URLSession and Network.framework


125
00:06:48,074 --> 00:06:52,946 line:-1
to understand when your
connections use Private Relay.


126
00:06:52,946 --> 00:06:55,615 line:-1
In TaskTransactionMetrics,


127
00:06:55.615 --> 00:07:00.220 line:-1 position:50%
you can check to see
if your task used a proxy.


128
00:07:00,220 --> 00:07:03,056 line:-1
In NWConnection's
EstablishmentReport,


129
00:07:03,056 --> 00:07:07,160 line:-1
you can also inspect the timings
of DNS name resolution


130
00:07:07.160 --> 00:07:12.699 line:-1 position:50%
and each stage of the proxied
connection establishment.


131
00:07:12,699 --> 00:07:16,503 line:-1
Private Relay takes a big step
towards making unencrypted


132
00:07:16.503 --> 00:07:20.774 line:-1 position:50%
and insecure HTTP connections
a thing of the past.


133
00:07:20.774 --> 00:07:23.677 line:-1 position:50%
You can join in this effort too!


134
00:07:23.677 --> 00:07:26.913 line:-1 position:50%
If you're still using
insecure HTTP --


135
00:07:26.913 --> 00:07:29.749 line:-1 position:50%
that's connections
on TCP port 80 --


136
00:07:29.749 --> 00:07:32.852 line:-1 position:50%
now is the time to change.


137
00:07:32,852 --> 00:07:34,854 line:-1
When Private Relay is enabled,


138
00:07:34,854 --> 00:07:37,857 line:-1
these insecure connections
will be proxied,


139
00:07:37.857 --> 00:07:40.827 line:-1 position:50%
which protects them from
attackers on a local network


140
00:07:40,827 --> 00:07:43,730 line:-1
between the client
and the proxy.


141
00:07:43.730 --> 00:07:47.067 line:-1 position:50%
However, it’s still best
to have your connections


142
00:07:47,067 --> 00:07:51,771 line:-1
be secure end to end
for all users.


143
00:07:51.771 --> 00:07:55.909 line:-1 position:50%
To do this, make sure
your server supports TLS


144
00:07:55.909 --> 00:08:02.782 line:-1 position:50%
and change your URLs
from http:// to https://.


145
00:08:02.782 --> 00:08:06.186 line:-1 position:50%
Your app may have exceptions
for App Transport Security


146
00:08:06.186 --> 00:08:08.988 line:-1 position:50%
to allow insecure traffic.


147
00:08:08,988 --> 00:08:12,459 line:-1
You can look at this list
to audit what insecure traffic


148
00:08:12.459 --> 00:08:18.498 line:-1 position:50%
your app uses
and remove these exceptions.


149
00:08:18,498 --> 00:08:21,868 line:-1
If your app provides
functionality based on location,


150
00:08:21,868 --> 00:08:24,838 line:-1
this is also a great time
to make sure you're using


151
00:08:24.838 --> 00:08:27.474 line:-1 position:50%
APIs from Core Location


152
00:08:27.474 --> 00:08:31.277 line:-1 position:50%
instead of relying on servers
inferring location


153
00:08:31,277 --> 00:08:33,980 line:-1
from IP addresses.


154
00:08:33.980 --> 00:08:40.253 line:-1 position:50%
IP address geolocation is often
unreliable and inaccurate.


155
00:08:40.253 --> 00:08:42.322 line:-1 position:50%
Core Location allows you
to specify


156
00:08:42,322 --> 00:08:44,824 line:-1
the precision of the location
you need


157
00:08:44.824 --> 00:08:49.462 line:-1 position:50%
and is based on
explicit user permission.


158
00:08:49.462 --> 00:08:51.765 line:-1 position:50%
You can learn more about
the latest enhancements


159
00:08:51.765 --> 00:08:53.566 line:-1 position:50%
to location access


160
00:08:53,566 --> 00:08:58,705 line:-1
in the “Apple's privacy pillars
in focus” session.


161
00:08:58.705 --> 00:09:01.408 line:-1 position:50%
Once you've made sure your app
is ready for Private Relay,


162
00:09:01,408 --> 00:09:03,009 line:-1
try it out!


163
00:09:03,009 --> 00:09:06,346 line:-1
Sign into an iPhone,
iPad, or Mac


164
00:09:06.346 --> 00:09:08.915 line:-1 position:50%
with an iCloud+ subscription,


165
00:09:08,915 --> 00:09:11,284 line:-1
and make sure Private Relay
is enabled


166
00:09:11.284 --> 00:09:14.020 line:-1 position:50%
in the iCloud section
of the Settings app


167
00:09:14.020 --> 00:09:16.656 line:-1 position:50%
or in System Preferences.


168
00:09:16.656 --> 00:09:18.925 line:-1 position:50%
You can provide feedback
with the tag


169
00:09:18,925 --> 00:09:22,162 line:-1
"iCloud Private Relay"
in the feedback app.


170
00:09:22,162 --> 00:09:25,698 line:-1
Now I'll hand it off
to my colleague, Delziel.


171
00:09:25.698 --> 00:09:27.066 line:-1 position:50%
Delziel Fernandes:
Thanks, Tommy.


172
00:09:27,066 --> 00:09:29,335 line:-1
Hi, I'm Delziel Fernandes,


173
00:09:29.335 --> 00:09:32.272 line:-1 position:50%
and I'll be talking about
how to prepare your server


174
00:09:32.272 --> 00:09:35.575 line:-1 position:50%
and manage your network
with Private Relay.


175
00:09:35.575 --> 00:09:38.311 line:-1 position:50%
If you have servers
that your app relies on,


176
00:09:38,311 --> 00:09:40,680 line:-1
or that user access in Safari,


177
00:09:40.680 --> 00:09:45.785 line:-1 position:50%
there are a few things you can
do to prepare for Private Relay.


178
00:09:45,785 --> 00:09:48,822 line:-1
Your servers can identify
connections that come in


179
00:09:48.822 --> 00:09:50.457 line:-1 position:50%
using Private Relay


180
00:09:50.457 --> 00:09:53.560 line:-1 position:50%
by recognizing
the proxy IP addresses.


181
00:09:53.560 --> 00:09:55.195 line:-1 position:50%
These proxy IP addresses


182
00:09:55,195 --> 00:09:58,465 line:-1
may be shared by many users
within a region.


183
00:09:58.465 --> 00:10:02.802 line:-1 position:50%
Each address is mapped
to a specific city or region.


184
00:10:02,802 --> 00:10:06,272 line:-1
So if you apply the correct
geo IP mapping databases,


185
00:10:06,272 --> 00:10:10,210 line:-1
your servers will still have
the relevant information.


186
00:10:10.210 --> 00:10:14.280 line:-1 position:50%
Private Relay guarantees
that users can't use the system


187
00:10:14,280 --> 00:10:16,616 line:-1
to pretend to be
from a different region,


188
00:10:16,616 --> 00:10:18,485 line:-1
so you can continue to enforce


189
00:10:18.485 --> 00:10:21.621 line:-1 position:50%
region-based
access restrictions.


190
00:10:21.621 --> 00:10:23.890 line:-1 position:50%
Details about
the proxy IP addresses


191
00:10:23.890 --> 00:10:27.894 line:-1 position:50%
will be available as an article
associated with this session.


192
00:10:27.894 --> 00:10:30.196 line:-1 position:50%
Now let's take a look
at network connections


193
00:10:30.196 --> 00:10:32.699 line:-1 position:50%
from devices using
Private Relay.


194
00:10:32,699 --> 00:10:35,235 position:50%
When a device tries
to access a server,


195
00:10:35,235 --> 00:10:38,705 line:0
it first sets up a network
connection to the ingress proxy.


196
00:10:38,705 --> 00:10:41,741 position:50%
This connection is set up
using an IP address


197
00:10:41,741 --> 00:10:44,644 position:50%
assigned by
the network provider.


198
00:10:44,644 --> 00:10:47,080 position:50%
The device then uses
the ingress proxy


199
00:10:47,080 --> 00:10:49,949 position:50%
to forward network requests
to the egress proxy


200
00:10:49,949 --> 00:10:52,986 position:50%
using the ingress proxy
IP address.


201
00:10:52,986 --> 00:10:55,221 line:0
The egress proxy
then forwards these requests


202
00:10:55,221 --> 00:10:58,358 line:0
to the destination servers
by choosing an IP address


203
00:10:58,358 --> 00:11:02,662 position:50%
that maps to the device's
city or region.


204
00:11:02,662 --> 00:11:05,431 line:-1
In general,
your servers and websites


205
00:11:05.431 --> 00:11:08.601 line:-1 position:50%
should stop solely relying
on client IP address


206
00:11:08.601 --> 00:11:12.305 line:-1 position:50%
to determine user location
or identity.


207
00:11:12.305 --> 00:11:14.173 line:-1 position:50%
If you need location access,


208
00:11:14,173 --> 00:11:17,410 line:-1
consider requesting
the user's location explicitly,


209
00:11:17.410 --> 00:11:20.179 line:-1 position:50%
and only at the granularity
you need.


210
00:11:20.179 --> 00:11:22.315 line:-1 position:50%
If you need to identify users,


211
00:11:22.315 --> 00:11:27.186 line:-1 position:50%
request a login or some other
form of explicit identification


212
00:11:27,186 --> 00:11:32,892 line:-1
rather than assuming that the IP
address is tied to the identity.


213
00:11:32.892 --> 00:11:36.262 line:-1 position:50%
Last, let's cover some tips
for managing your network


214
00:11:36,262 --> 00:11:39,766 line:-1
when Private Relay is in use.


215
00:11:39.766 --> 00:11:42.435 line:-1 position:50%
If you're running a packet trace
on your local network


216
00:11:42.435 --> 00:11:44.003 line:-1 position:50%
when Private Relay is in use,


217
00:11:44.003 --> 00:11:47.407 line:-1 position:50%
you'll see
some new traffic patterns.


218
00:11:47.407 --> 00:11:52.178 line:-1 position:50%
You'll now see a lot more
traffic running on UDP port 443.


219
00:11:52.178 --> 00:11:54.147 line:-1 position:50%
This is QUIC --
or HTTP/3 --


220
00:11:54.147 --> 00:11:56.616 line:-1 position:50%
traffic that's being used
to communicate


221
00:11:56,616 --> 00:11:59,052 line:-1
with the Private Relay proxy.


222
00:11:59,052 --> 00:12:01,521 line:-1
You can make sure
your traffic works well


223
00:12:01,521 --> 00:12:04,824 line:-1
by allowing UDP port 443
on your network


224
00:12:04.824 --> 00:12:08.394 line:-1 position:50%
and by making sure your routers
or Network Address Translators


225
00:12:08,394 --> 00:12:11,097 line:-1
are tuned to handle it well.


226
00:12:11.097 --> 00:12:16.769 line:-1 position:50%
You'll also see fewer cleartext
UDP DNS queries on your network.


227
00:12:16,769 --> 00:12:19,172 line:-1
Let's go over a typical
network connection request


228
00:12:19,172 --> 00:12:22,875 line:-1
from a device when
Private Relay is not in use.


229
00:12:22.875 --> 00:12:25.278 line:-1 position:50%
When a device tries
to access a server,


230
00:12:25,278 --> 00:12:29,749 line:-1
it first sends a DNS query
for the hostname of the server.


231
00:12:29.749 --> 00:12:32.819 line:-1 position:50%
Once the hostname is resolved
to an IP address,


232
00:12:32.819 --> 00:12:35.688 line:-1 position:50%
the device then connects
to the IP address of the server


233
00:12:35.688 --> 00:12:39.826 line:-1 position:50%
using a transport protocol
like TCP.


234
00:12:39.826 --> 00:12:42.261 line:-1 position:50%
The device then performs
a TCP three-way handshake


235
00:12:42.261 --> 00:12:45.465 line:-1 position:50%
with the server
followed by a TLS exchange


236
00:12:45.465 --> 00:12:49.736 line:-1 position:50%
to set up a secure connection
with the server.


237
00:12:49.736 --> 00:12:52.705 line:-1 position:50%
But as you can see,
without Private Relay,


238
00:12:52.705 --> 00:12:54.307 line:-1 position:50%
the hostname of the server


239
00:12:54.307 --> 00:12:57.110 line:-1 position:50%
and the IP address of the device
connecting to the server


240
00:12:57,110 --> 00:13:02,782 line:-1
are visible by simply observing
packets on the network.


241
00:13:02,782 --> 00:13:04,217 line:0
With Private Relay,


242
00:13:04,217 --> 00:13:07,053 position:50%
the device first sets up a
connection to the ingress Proxy


243
00:13:07,053 --> 00:13:09,555 position:50%
using QUIC, or HTTP/3.


244
00:13:09,555 --> 00:13:12,558 line:0
In packet captures,
you will notice UDP packets


245
00:13:12,558 --> 00:13:16,629 position:50%
sent to port 443
of the ingress proxy.


246
00:13:16,629 --> 00:13:18,464 position:50%
Once the network connection
is established


247
00:13:18,464 --> 00:13:20,033 position:50%
to the ingress proxy,


248
00:13:20,033 --> 00:13:22,735 line:0
access to a server is secured
within the connection


249
00:13:22,735 --> 00:13:26,339 position:50%
to the ingress proxy.


250
00:13:26,339 --> 00:13:29,208 line:0
On the server end,
there is no change in protocol.


251
00:13:29,208 --> 00:13:31,978 line:0
The TCP/TLS exchange
is similar to traffic


252
00:13:31,978 --> 00:13:33,913 position:50%
without Private Relay.


253
00:13:33,913 --> 00:13:36,082 position:50%
The only difference
is that the server sees


254
00:13:36,082 --> 00:13:39,218 position:50%
the incoming connection
from a proxy IP address


255
00:13:39,218 --> 00:13:43,089 position:50%
instead of a device's
IP address.


256
00:13:43.089 --> 00:13:46.092 line:-1 position:50%
Most networks don't need
to audit or monitor


257
00:13:46.092 --> 00:13:47.960 line:-1 position:50%
all user traffic.


258
00:13:47.960 --> 00:13:51.831 line:-1 position:50%
However, if you run
an enterprise or school network,


259
00:13:51,831 --> 00:13:53,766 line:-1
your network may have policies


260
00:13:53,766 --> 00:13:56,769 line:-1
that require intercepting
all traffic.


261
00:13:56,769 --> 00:13:59,706 line:-1
To support this use case,
you can block the hostname


262
00:13:59.706 --> 00:14:02.909 line:-1 position:50%
of the iCloud Private Relay
proxy server.


263
00:14:02,909 --> 00:14:05,712 line:-1
Then, when a device connects
to your network,


264
00:14:05.712 --> 00:14:09.148 line:-1 position:50%
the user will receive a prompt
indicating that Private Relay


265
00:14:09.148 --> 00:14:11.818 line:-1 position:50%
is blocked
on the current network.


266
00:14:11.818 --> 00:14:14.520 line:-1 position:50%
They can then choose to either
disable Private Relay


267
00:14:14.520 --> 00:14:18.124 line:-1 position:50%
for that network
or switch networks.


268
00:14:18.124 --> 00:14:20.960 line:-1 position:50%
Information about the proxy
hostname will be available


269
00:14:20,960 --> 00:14:24,230 line:-1
as an article
associated with this session.


270
00:14:24,230 --> 00:14:25,732 line:-1
For parental controls,


271
00:14:25.732 --> 00:14:28.401 line:-1 position:50%
the best solution is to use
content filter APIs


272
00:14:28,401 --> 00:14:31,270 line:-1
provided by
NetworkExtension framework.


273
00:14:31.270 --> 00:14:34.240 line:-1 position:50%
This allows traffic
to be audited on device


274
00:14:34.240 --> 00:14:36.809 line:-1 position:50%
even when Private Relay
is enabled.


275
00:14:36,809 --> 00:14:39,879 position:50%
For more information
on content Filter APIs,


276
00:14:39,879 --> 00:14:42,014 position:50%
watch "Meet the Screen Time API"


277
00:14:42,014 --> 00:14:45,351 position:50%
and "Network extension
for the modern Mac" sessions.


278
00:14:45,351 --> 00:14:46,953 line:-1
To wrap things up,


279
00:14:46,953 --> 00:14:50,156 line:-1
use modern secure networking
APIs like URLSession


280
00:14:50,156 --> 00:14:51,858 line:-1
in your apps;


281
00:14:51.858 --> 00:14:54.127 line:-1 position:50%
test your apps
with Private Relay;


282
00:14:54,127 --> 00:14:57,463 line:-1
and make sure your servers
and websites work well


283
00:14:57.463 --> 00:15:00.466 line:-1 position:50%
when they receive connections
routed through Private Relay.


284
00:15:00,466 --> 00:15:01,934 line:-1
Thanks for watching, everyone!


285
00:15:01,934 --> 00:15:05,338 align:right position:90% line:0
♪

