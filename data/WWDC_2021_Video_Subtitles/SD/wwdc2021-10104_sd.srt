2
00:00:01,935 --> 00:00:04,938 line:-1
[upbeat music]


3
00:00:04,972 --> 00:00:09,009 line:-1
♪ ♪


4
00:00:09,042 --> 00:00:10,177 line:-1
[David] Hi.


5
00:00:10.210 --> 00:00:13.647 line:-2 align:start position:31%
Welcome to Meet Safari
Web Extensions on iOS.


6
00:00:13,680 --> 00:00:16,917 align:start line:-2
I'm David Quesada,
an engineer on the Safari team.


7
00:00:16.950 --> 00:00:19.520 line:-2 align:start position:26%
And today, I'll be walking
through an exciting new feature


8
00:00:19,553 --> 00:00:22,890 line:-1
in iOS 15, Safari Web Extensions.


9
00:00:22.923 --> 00:00:24.758 line:-1 align:center
Web Extensions are a powerful type


10
00:00:24,791 --> 00:00:27,528 align:start line:-2
of browser extension
that allows users to extend


11
00:00:27,561 --> 00:00:31,031 line:-2 align:start
and customize their browsing
in a huge number of ways.


12
00:00:31.064 --> 00:00:33.233 line:-2 align:start position:27%
They're built with the standard
web technologies:


13
00:00:33.267 --> 00:00:36.336 line:-1 align:center
HTML, CSS, and JavaScript.


14
00:00:36,370 --> 00:00:38,772 align:start line:-2
And the WebExtension API
has been available


15
00:00:38,805 --> 00:00:42,376 align:start line:-2
for all the major desktop browsers
for a while, which means you can write


16
00:00:42,409 --> 00:00:44,645 line:-1
a browser extension once and deploy it


17
00:00:44,678 --> 00:00:48,282 align:start line:-2
across all those browsers,
reaching so many users.


18
00:00:48,315 --> 00:00:51,251 align:start line:-2
But now, I'm thrilled
to tell you that Web Extensions


19
00:00:51.285 --> 00:00:54.188 line:-1 align:center
are coming to iOS 15, letting you build


20
00:00:54,221 --> 00:00:57,090 align:start line:-2
a browser extension
for more users than ever.


21
00:00:57.124 --> 00:01:00.227 line:-2 position:25% align:start
I'd love to show you a demo now
of a Safari Web Extension


22
00:01:00,260 --> 00:01:02,229 line:-1
running on iOS.


23
00:01:02,262 --> 00:01:05,232 position:25% line:-2
I'll be showing off
an extension called Sea Creator.


24
00:01:05.265 --> 00:01:08.669 line:-2 align:start position:22%
This extension was originally written
for browsers on the Mac,


25
00:01:08,702 --> 00:01:12,005 line:-2 position:34%
but I've been working
on bringing it to iOS.


26
00:01:12,039 --> 00:01:13,941 line:-2 position:24%
This extension shows me fun facts
about sea creatures


27
00:01:15,342 --> 00:01:18,145 line:-1
and makes reading more about sea life fun


28
00:01:18,178 --> 00:01:22,282 align:start line:-2
by replacing the names
of sea creatures with emoji.


29
00:01:22.316 --> 00:01:26.453 line:-1 align:center
Let's take a look at this on an iPad.


30
00:01:26,486 --> 00:01:30,123 align:start line:-2
Now, I've just installed Sea Creator,
and I've opened up Safari,


31
00:01:30.157 --> 00:01:32.359 line:-1 align:center
where I'm reading an article about fish.


32
00:01:32,392 --> 00:01:34,661 line:-2 position:32%
I'd really love to start
using Sea Creator here


33
00:01:34,695 --> 00:01:38,765 line:-2 align:start
so I can liven up this page
with some emoji.


34
00:01:38.799 --> 00:01:40.901 line:-1 align:center
So I'll open up the action menu


35
00:01:40.934 --> 00:01:43.136 line:-1 align:center
and drill into the new Extensions list,


36
00:01:43,170 --> 00:01:44,838 line:-1
which shows me all the extensions


37
00:01:44,872 --> 00:01:47,674 line:-2 align:start
that I have available,
including Sea Creator.


38
00:01:47.708 --> 00:01:49.810 line:-1 align:center
So I'll turn it on.


39
00:01:49,843 --> 00:01:52,212 line:-2 align:start
Now, another feature
of Sea Creator is that


40
00:01:52,246 --> 00:01:54,314 line:-1
I can put it front and center in Safari


41
00:01:54.348 --> 00:01:56.216 line:-1 align:center
with a custom Start Page


42
00:01:56,250 --> 00:01:58,952 line:-1
that I use every time I open a new tab.


43
00:01:58.986 --> 00:02:02.089 line:-1 align:center
I'll check that out in a bit.


44
00:02:02.122 --> 00:02:03.991 line:-1 align:center
And now that I've turned on Sea Creator,


45
00:02:04.024 --> 00:02:05.526 line:-1 align:center
it's right there in the Action menu


46
00:02:05.559 --> 00:02:08.529 line:-1 align:center
ready for me to use.


47
00:02:08,562 --> 00:02:11,431 line:-2 align:start
And when I do that,
Safari asks me if I'm OK


48
00:02:11,465 --> 00:02:14,768 position:32% line:-2
with giving Sea Creator
full access to this site.


49
00:02:14,801 --> 00:02:17,571 line:-2 align:start
We brought the same
Web Extensions permission model


50
00:02:17.604 --> 00:02:21.909 line:-2 align:start position:27%
from Safari on the Mac to iOS,
which means I, as the user,


51
00:02:21,942 --> 00:02:26,346 position:20% line:-2
have full control over how much
of my browsing extensions can access.


52
00:02:26,380 --> 00:02:28,348 line:-1
I'll talk in more detail about this later.


53
00:02:28,382 --> 00:02:31,652 position:29% line:-2
But right now,
I'll allow Sea Creator to run.


54
00:02:31,685 --> 00:02:33,187 line:-1
And just like that,


55
00:02:33,220 --> 00:02:35,522 line:-2 position:28%
it swapped in all
these fish emoji on the page,


56
00:02:35,556 --> 00:02:37,658 line:-1
which is just how I like to read it.


57
00:02:37,691 --> 00:02:40,494 position:29% line:-2
It's also opened this popup
showing me a running total


58
00:02:40,527 --> 00:02:43,463 align:start line:-2
of just how many words
I've replaced so far.


59
00:02:43,497 --> 00:02:45,899 line:-1
But it's not just this one page.


60
00:02:45.933 --> 00:02:47.835 line:-1 align:center
I gave Sea Creator permission to work


61
00:02:47,868 --> 00:02:50,003 line:-1
across this website as a whole.


62
00:02:50.037 --> 00:02:52.573 line:-1 align:center
So as I navigate to other pages,


63
00:02:52,606 --> 00:02:54,641 line:-1
Sea Creator is still working for me


64
00:02:54,675 --> 00:02:57,044 line:-1
and gives me emoji here as well.


65
00:02:57.077 --> 00:02:59.479 line:-2 align:start position:21%
I don't need to go out
of my way to open the extension again


66
00:02:59.513 --> 00:03:02.082 line:-1 align:center
once I've started using it.


67
00:03:02,115 --> 00:03:05,652 align:start line:-3
Of course, Sea Creator
has one more feature
that I mentioned earlier.


68
00:03:05.686 --> 00:03:08.889 line:-2 position:29% align:start
When I open up a new tab
to do some more browsing,


69
00:03:08,922 --> 00:03:11,358 line:-1
I'm greeted by this bold New Tab page


70
00:03:11,391 --> 00:03:13,894 line:-1
from Sea Creator with a fact of the day


71
00:03:13,927 --> 00:03:15,395 line:-1
today about starfish--


72
00:03:15,429 --> 00:03:17,664 line:-1
and once again, that counter showing me


73
00:03:17,698 --> 00:03:20,434 position:25% line:-2
just how many emoji Sea Creator
has given me so far.


74
00:03:20,467 --> 00:03:22,569 line:-1
This is pretty cool.


75
00:03:22.603 --> 00:03:24.905 line:-1 align:center
So that was a quick look at Sea Creator


76
00:03:24.938 --> 00:03:26.640 line:-1 align:center
working great on iOS.


77
00:03:26,673 --> 00:03:28,742 line:-1
In this session, I want to show how


78
00:03:28,775 --> 00:03:32,446 position:25% line:-2
you too can create
a Safari Web Extension for iOS.


79
00:03:32,479 --> 00:03:35,215 align:start line:-2
And I'll be using
Sea Creator as an example


80
00:03:35,249 --> 00:03:37,651 line:-1
of how I took an existing extension


81
00:03:37,684 --> 00:03:40,754 line:-2 align:start
and brought it to iOS
with just a few changes.


82
00:03:40,787 --> 00:03:44,424 line:-2 align:start
But don't worry if you've never
written a browser extension before.


83
00:03:44.458 --> 00:03:47.628 line:-2 position:28% align:start
I'll give you an overview
of how Web Extensions work


84
00:03:47.661 --> 00:03:51.064 line:-2 align:start position:29%
and how you can get
started creating a new one.


85
00:03:51.098 --> 00:03:54.835 line:-2 align:start position:29%
Along the way, I'll cover
some debugging techniques


86
00:03:54,868 --> 00:03:56,336 line:-1
and best practices


87
00:03:56,370 --> 00:04:00,007 position:33% line:-2
to help your extension
be the best it can be.


88
00:04:00.040 --> 00:04:03.343 line:-2 position:27% align:start
And I'll wrap it up with
some thoughts on user privacy


89
00:04:03,377 --> 00:04:05,746 align:start line:-2
and how it relates
to the permissions model


90
00:04:05,779 --> 00:04:08,415 line:-1
of Safari Web Extensions.


91
00:04:08,448 --> 00:04:12,186 align:start line:-2
So, our journey begins
with creating a web extension


92
00:04:12,219 --> 00:04:15,289 line:-1
that can run on iOS in the first place.


93
00:04:15,322 --> 00:04:20,527 align:start line:-2
Let's look behind the scenes
to understand how this works.


94
00:04:20,561 --> 00:04:23,463 line:-2 align:start
It's important to understand
that for Safari,


95
00:04:23,497 --> 00:04:26,099 line:-1
Web Extensions are parts of apps.


96
00:04:26,133 --> 00:04:28,569 position:30% line:-2
So when you want
to install a web extension,


97
00:04:28,602 --> 00:04:31,004 line:-1
you install its app.


98
00:04:31,038 --> 00:04:33,440 line:-1
And like any other type of iOS app,


99
00:04:33.473 --> 00:04:35.209 line:-1 align:center
apps with Safari Web Extensions


100
00:04:35,242 --> 00:04:38,011 line:-1
can be found on the App Store.


101
00:04:38,045 --> 00:04:40,614 line:-1
And Xcode has everything you need


102
00:04:40.647 --> 00:04:44.017 line:-1 align:center
to build an app to ship your extension.


103
00:04:44,051 --> 00:04:47,688 line:-2 align:start
So when you think about building
a Safari Web Extension for iOS,


104
00:04:47,721 --> 00:04:50,691 position:31% line:-2
you may be starting
from one of three places.


105
00:04:50,724 --> 00:04:54,995 position:25% line:-2
Maybe you're looking at creating
a new extension from scratch,


106
00:04:55,028 --> 00:04:57,764 line:-2 position:26%
or maybe you already
wrote one for another browser,


107
00:04:57.798 --> 00:05:00.667 line:-1 align:center
and you want to bring it to Safari,


108
00:05:00,701 --> 00:05:04,004 position:28% line:-2
or perhaps you already
have an extension for Safari


109
00:05:04,037 --> 00:05:08,141 position:26% line:-2
on the Mac, and you want
to make it available on iOS too.


110
00:05:08,175 --> 00:05:12,246 line:-2 position:24%
I want to go over what you can do
in each of these cases.


111
00:05:12,279 --> 00:05:16,550 position:28% line:-2
So first, if you want to create
a brand-new Web Extension,


112
00:05:16.583 --> 00:05:19.119 line:-1 align:center
you can use Xcode's included templates,


113
00:05:19,152 --> 00:05:21,889 line:-1
which make it super easy to get started.


114
00:05:21.922 --> 00:05:24.157 line:-1 align:center
You can create a new Xcode project


115
00:05:24.191 --> 00:05:26.693 line:-1 align:center
and use the Safari Extension App template


116
00:05:26,727 --> 00:05:28,795 line:-1
to start building a web extension


117
00:05:28.829 --> 00:05:31.131 line:-1 align:center
as well as its containing app.


118
00:05:31,164 --> 00:05:32,733 line:-1
And when you use this template,


119
00:05:32,766 --> 00:05:35,235 line:-1
you get an extension that comes complete


120
00:05:35.269 --> 00:05:38.739 line:-2 align:start position:23%
with all the resources
a typical web extension might have.


121
00:05:38,772 --> 00:05:40,908 line:-1
You can use this as a starting point


122
00:05:40.941 --> 00:05:43.177 line:-1 align:center
by customizing what's already there


123
00:05:43.210 --> 00:05:45.012 line:-1 align:center
or adding or removing pieces


124
00:05:45.045 --> 00:05:47.114 line:-1 align:center
according to what your extension needs.


125
00:05:47.147 --> 00:05:49.383 line:-2 align:start position:29%
Now, if you've already built
a Web Extension


126
00:05:49.416 --> 00:05:51.018 line:-1 align:center
for another browser,


127
00:05:51,051 --> 00:05:52,719 line:-1
you can take advantage of a tool


128
00:05:52,753 --> 00:05:55,088 line:-1
called the Safari Web Extension Converter


129
00:05:55.122 --> 00:05:57.591 line:-1 align:center
to automatically create an Xcode project


130
00:05:57,624 --> 00:05:59,960 line:-1
from that existing extension.


131
00:05:59.993 --> 00:06:02.829 line:-2 align:start position:28%
You simply run the converter
on the command line,


132
00:06:02,863 --> 00:06:05,966 align:start line:-2
provide it a path
to your extension's resources,


133
00:06:05.999 --> 00:06:08.068 line:-1 align:center
and it will create a new Xcode project


134
00:06:08,101 --> 00:06:11,538 align:start line:-2
that packages your extension
in a native app.


135
00:06:11,572 --> 00:06:13,841 line:-1
And new in Xcode 13,


136
00:06:13.874 --> 00:06:16.810 line:-2 position:29% align:start
the Safari Web Extension
Converter creates a project


137
00:06:16,844 --> 00:06:19,580 line:-1
that supports Safari on both iOS


138
00:06:19,613 --> 00:06:22,583 line:-1
and macOS by default.


139
00:06:22.616 --> 00:06:25.319 line:-1 align:center
And the newly created project, by default,


140
00:06:25,352 --> 00:06:27,921 position:32% line:-2
references your existing
extension's resources


141
00:06:27,955 --> 00:06:30,991 position:30% line:-2
at the original path
rather than copying them.


142
00:06:31.024 --> 00:06:34.127 line:-2 align:start position:32%
Finally, if you've already
set up an Xcode project


143
00:06:34,161 --> 00:06:37,564 line:-2 align:start
in the past to build
a Safari Web Extension for macOS,


144
00:06:37.598 --> 00:06:39.199 line:-1 align:center
you can also use the converter


145
00:06:39,233 --> 00:06:43,937 line:-2 position:33%
to upgrade that project
so it supports iOS too.


146
00:06:43.971 --> 00:06:45.572 line:-1 align:center
You can run the converter


147
00:06:45.606 --> 00:06:48.175 line:-1 align:center
and provide a --rebuild-project option


148
00:06:48.208 --> 00:06:51.178 line:-1 align:center
along with a path to your Xcode project.


149
00:06:51,211 --> 00:06:54,281 position:29% line:-2
Then the converter will add
an iOS-compatible version


150
00:06:54,314 --> 00:06:57,818 line:-2 align:start
of the extension and a containing app
to your project.


151
00:06:57,851 --> 00:07:00,687 line:-2 align:start
Now I want to show
the Safari Web Extension Converter


152
00:07:00.721 --> 00:07:02.990 line:-1 align:center
in action by retracing my steps


153
00:07:03.023 --> 00:07:07.160 line:-2 position:28% align:start
of bringing Sea Creator
to iOS for the very first time.


154
00:07:08,929 --> 00:07:11,532 line:-1
So here is my Sea Creator Xcode project,


155
00:07:11,565 --> 00:07:13,433 line:-1
which I used to develop Sea Creator


156
00:07:13.467 --> 00:07:15.469 line:-1 align:center
for Safari on the Mac.


157
00:07:15.502 --> 00:07:17.337 line:-1 align:center
But it only supports the Mac right now,


158
00:07:17,371 --> 00:07:19,439 line:-1
and I want to fix that.


159
00:07:19,473 --> 00:07:22,543 line:-1
So I'll open up a terminal


160
00:07:22,576 --> 00:07:25,913 align:start line:-2
and type xcrun
safari-web-extension-converter,


161
00:07:25.946 --> 00:07:29.183 line:-1 align:center
and I'll use the --rebuild-project option,


162
00:07:29,216 --> 00:07:32,319 line:-2 align:start
and I'll provide a path
to my Xcode project


163
00:07:32.352 --> 00:07:34.721 line:-1 align:center
and run the converter.


164
00:07:34,755 --> 00:07:38,058 line:-2 align:start
And it confirms some details
about my existing project


165
00:07:38,091 --> 00:07:40,727 line:-2 position:33%
and stops to ask me
if I'd like to overwrite it


166
00:07:40.761 --> 00:07:43.163 line:-1 align:center
with a cross-platform version.


167
00:07:43,197 --> 00:07:46,033 line:-1
Also, any time you run the converter,


168
00:07:46.066 --> 00:07:49.636 line:-2 position:19% align:start
it'll warn you about potential
compatibility issues with your extension.


169
00:07:49,670 --> 00:07:51,939 position:28% line:-2
In this case,
it's warning me about the use


170
00:07:51,972 --> 00:07:54,408 position:27% line:-2
of something called
a persistent background page,


171
00:07:54.441 --> 00:07:57.044 line:-1 align:center
which isn't supported on iOS.


172
00:07:57.077 --> 00:07:58.745 line:-1 align:center
I'll need to fix this later.


173
00:07:58,779 --> 00:08:02,316 position:30% line:-2
But for now, I'll let
the converter keep going.


174
00:08:03,951 --> 00:08:08,222 line:-2 position:26%
And when it's done,
my project automatically opens.


175
00:08:08.255 --> 00:08:10.157 line:-1 align:center
Notice there are folders here


176
00:08:10.190 --> 00:08:12.626 line:-2 position:34% align:start
for both the iOS
and macOS versions


177
00:08:12.659 --> 00:08:15.395 line:-1 align:center
of my app and the extension.


178
00:08:15.429 --> 00:08:18.732 line:-2 position:30% align:start
Now, I want to take a look
at the Resources folder


179
00:08:18.765 --> 00:08:21.101 line:-1 align:center
within the Shared extension group.


180
00:08:21,134 --> 00:08:23,570 line:-1
Here is where I'll find the core pieces


181
00:08:23.604 --> 00:08:25.339 line:-1 align:center
of the Sea Creator Web Extension.


182
00:08:25,372 --> 00:08:28,342 line:-2 position:27%
For those of you who are new
to the Web Extension API,


183
00:08:28.375 --> 00:08:30.377 line:-2 align:start position:26%
I want to explain
what some of these pieces are,


184
00:08:30.410 --> 00:08:33.146 line:-1 align:center
since I'll be referring to them later.


185
00:08:33,180 --> 00:08:35,349 line:-1
I'll start with the manifest.


186
00:08:35.382 --> 00:08:37.084 line:-1 align:center
This is a JSON file


187
00:08:37,117 --> 00:08:39,720 line:-2 position:27%
that describes
the structure of the extension.


188
00:08:39,753 --> 00:08:41,688 line:-1
It includes important information


189
00:08:41,722 --> 00:08:43,490 line:-1
such as the extension's name,


190
00:08:43,524 --> 00:08:45,425 line:-1
which websites it wants to access,


191
00:08:45.459 --> 00:08:47.027 line:-1 align:center
and what features it supports,


192
00:08:47.060 --> 00:08:49.863 line:-1 align:center
such as a pop-up page or a New Tab page


193
00:08:49.897 --> 00:08:52.399 line:-1 align:center
like Sea Creator has.


194
00:08:52,432 --> 00:08:56,603 align:start line:-2
Next, there's a JavaScript source
called the background script.


195
00:08:56,637 --> 00:08:59,006 position:26% line:-2
The browser can run this script
in the background


196
00:08:59,039 --> 00:09:02,042 position:25% line:-2
when your extension is enabled,
and it allows your extension


197
00:09:02.075 --> 00:09:05.412 line:-2 position:30% align:start
to listen for various events
coming from the browser


198
00:09:05,445 --> 00:09:07,781 line:-1
or other parts of your extension.


199
00:09:07,814 --> 00:09:11,118 line:-2 position:25%
Sea Creator's background script
keeps track of that counter


200
00:09:11,151 --> 00:09:14,855 line:-2 position:31%
of just how many emoji
it's added to web pages.


201
00:09:14.888 --> 00:09:17.391 line:-1 align:center
Next, there's another type of script


202
00:09:17.424 --> 00:09:19.826 line:-1 align:center
called the content script.


203
00:09:19.860 --> 00:09:22.296 line:-1 align:center
The browser automatically runs this script


204
00:09:22.329 --> 00:09:24.831 line:-1 align:center
on web pages that the user visits.


205
00:09:24,865 --> 00:09:27,634 align:start line:-2
An extension can have
any number of content scripts,


206
00:09:27.668 --> 00:09:30.704 line:-2 position:30% align:start
and the manifest specifies
which content scripts


207
00:09:30,737 --> 00:09:32,739 line:-1
should run on which websites.


208
00:09:32,773 --> 00:09:36,109 line:-2 position:26%
This script gives your extension
the power to extend


209
00:09:36,143 --> 00:09:39,680 align:start line:-2
and customize pages
by directly manipulating them.


210
00:09:39,713 --> 00:09:43,550 align:start line:-2
For example, Sea Creator's
content page is what actually does


211
00:09:43.584 --> 00:09:46.587 line:-2 position:29% align:start
the replacement
of animal names with emoji.


212
00:09:46.620 --> 00:09:48.422 line:-1 align:center
And after it does that,


213
00:09:48.455 --> 00:09:50.757 line:-2 position:32% align:start
it sends a message
to the background script


214
00:09:50,791 --> 00:09:54,595 line:-1
so it can update that central counter.


215
00:09:54.628 --> 00:09:57.865 line:-2 position:23% align:start
Of course,
the extension also has some HTML,


216
00:09:57.898 --> 00:10:00.300 line:-1 align:center
CSS, and other JavaScript files


217
00:10:00,334 --> 00:10:04,938 line:-2 position:27%
for the New Tab page,
and that pop-up page as well.


218
00:10:04.972 --> 00:10:07.975 line:-2 align:start position:29%
And finally, there are
some other resources here


219
00:10:08.008 --> 00:10:11.211 line:-1 align:center
such as localized strings,


220
00:10:11.245 --> 00:10:15.749 line:-2 position:26% align:start
as well as the extension's icons
and other graphics.


221
00:10:15,782 --> 00:10:18,118 line:-1
So all of these pieces come together


222
00:10:18,151 --> 00:10:20,621 line:-1
to make the Sea Creator Web Extension.


223
00:10:20,654 --> 00:10:23,524 align:start line:-2
And thanks to the Safari
Web Extension Converter,


224
00:10:23.557 --> 00:10:25.893 line:-1 align:center
I now have a project that packages all


225
00:10:25,926 --> 00:10:27,494 line:-1
of this up into a native app.


226
00:10:27.528 --> 00:10:29.596 line:-1 align:center
And I can run my project now,


227
00:10:29,630 --> 00:10:34,001 align:start line:-2
so I can start using Sea Creator
in Safari right away.


228
00:10:34.034 --> 00:10:36.737 line:-1 align:center
I'll do that now by going to the toolbar


229
00:10:36,770 --> 00:10:40,340 line:-2 position:27%
at the top of the screen,
selecting Sea Creator for iOS,


230
00:10:40,374 --> 00:10:43,744 line:-2 position:28%
and choosing the destination
where I want to run the app.


231
00:10:43.777 --> 00:10:46.280 line:-1 align:center
I don't have any iOS devices connected,


232
00:10:46.313 --> 00:10:49.650 line:-2 position:29% align:start
so in this case,
I'll use an iPhone simulator.


233
00:10:51.852 --> 00:10:54.221 line:-1 align:center
I'll then click the Run button.


234
00:10:54.254 --> 00:10:57.524 line:-1 align:center
And Xcode will then build my app project,


235
00:10:57,558 --> 00:11:00,160 line:-1
load the simulator, and run my app.


236
00:11:02,796 --> 00:11:05,265 line:-1
So this is the Sea Creator app


237
00:11:05.299 --> 00:11:07.734 line:-1 align:center
generated by the Web Extension Converter,


238
00:11:07,768 --> 00:11:11,305 line:-2 align:start
and it contains
the Sea Creator Web Extension.


239
00:11:11,338 --> 00:11:12,940 line:-1
At the beginning of this session,


240
00:11:12.973 --> 00:11:14.708 line:-1 align:center
I showed that I can turn on extensions


241
00:11:14,741 --> 00:11:16,577 line:-1
directly within Safari,


242
00:11:16,610 --> 00:11:19,479 line:-1
but as the app suggests,


243
00:11:19,513 --> 00:11:22,216 line:-2 align:start
I can also use Settings
to manage my extensions.


244
00:11:22,249 --> 00:11:23,784 line:-1
And I want to show that off here,


245
00:11:23.817 --> 00:11:26.019 line:-1 align:center
so I'll switch to Settings.


246
00:11:29,256 --> 00:11:32,392 line:-1
I'll jump into Safari,


247
00:11:32,426 --> 00:11:33,894 line:-1
Extensions,


248
00:11:33,927 --> 00:11:36,396 line:-1
and then Sea Creator.


249
00:11:36,430 --> 00:11:39,633 line:-2 position:27%
And here's the details page
for Sea Creator with some info


250
00:11:39.666 --> 00:11:42.936 line:-2 position:31% align:start
about the extension
and a switch to turn it on.


251
00:11:42.970 --> 00:11:44.972 line:-1 align:center
But that switch is grayed out,


252
00:11:45,005 --> 00:11:47,207 line:-1
and I can't turn on the extension yet.


253
00:11:47,241 --> 00:11:48,709 line:-1
This means there's a problem


254
00:11:48,742 --> 00:11:50,944 position:30% line:-2
with the extension
that keeps it from loading.


255
00:11:50.978 --> 00:11:53.313 line:-1 align:center
I definitely need to look into this next.


256
00:11:53.347 --> 00:11:56.250 line:-2 position:32% align:start
And this is where I want
to talk about debugging.


257
00:11:56.283 --> 00:11:58.385 line:-1 align:center
It's a great first step to just be able


258
00:11:58.418 --> 00:12:01.221 line:-2 align:start position:30%
to build your project
and install your extension,


259
00:12:01,255 --> 00:12:03,390 line:-1
but of course, it's essential to know how


260
00:12:03,423 --> 00:12:07,027 align:start line:-2
to dig deeper to find out
why things go wrong if they do.


261
00:12:07,060 --> 00:12:10,731 align:start line:-2
It's easy to identify errors
in web extensions and use tools


262
00:12:10.764 --> 00:12:14.101 line:-2 position:25% align:start
such as Web Inspector
to debug parts of your extension,


263
00:12:14,134 --> 00:12:17,004 line:-1
and that's what I'll show you now.


264
00:12:17,037 --> 00:12:19,940 position:31% line:-2
Looking back at Settings,
there's an error here


265
00:12:19,973 --> 00:12:23,143 line:-2 align:start
at the bottom telling me
that Extensions on iOS


266
00:12:23.177 --> 00:12:26.146 line:-2 position:29% align:start
must have a non-persistent
background page.


267
00:12:26,180 --> 00:12:27,548 line:-1
This sounds familiar.


268
00:12:27,581 --> 00:12:30,951 line:-2 align:start
It's the same issue the converter
warned me about earlier.


269
00:12:30.984 --> 00:12:33.720 line:-1 align:center
And now I want to actually go fix it.


270
00:12:33.754 --> 00:12:36.557 line:-1 align:center
So I'll go back to Xcode,


271
00:12:36.590 --> 00:12:39.726 line:-1 align:center
open up the manifest,


272
00:12:39.760 --> 00:12:45.866 line:-1 align:center
and add a "persistent": false key


273
00:12:45.899 --> 00:12:47.935 line:-1 align:center
in the background section.


274
00:12:47,968 --> 00:12:50,237 line:-2 align:start
I'll talk about this change
in more detail later,


275
00:12:50,270 --> 00:12:52,940 line:-2 align:start
but for now, this should
get me past the error.


276
00:12:52,973 --> 00:12:56,109 align:start line:-2
Now that I've made this change,
I'll run the app again


277
00:12:56.143 --> 00:12:59.446 line:-2 position:29% align:start
to install the updated
extension on the simulator.


278
00:13:05.919 --> 00:13:08.822 line:-1 align:center
And here's the Sea Creator app once again.


279
00:13:08,856 --> 00:13:11,558 line:-2 align:start
It looked like I only
had that one error to fix,


280
00:13:11,592 --> 00:13:13,260 line:-1
so now I'll go straight to Safari


281
00:13:13,293 --> 00:13:15,996 line:-1
instead of going back to Settings.


282
00:13:17,197 --> 00:13:20,067 line:-1
I'll open up Safari,


283
00:13:20,100 --> 00:13:22,669 line:-1
open the Extensions list,


284
00:13:22,703 --> 00:13:25,239 line:-1
and there's Sea Creator,


285
00:13:25,272 --> 00:13:28,108 line:-1
and it looks like I can turn it on now.


286
00:13:28.141 --> 00:13:29.776 line:-1 align:center
Safari offers me the choice


287
00:13:29,810 --> 00:13:32,312 line:-1
to use Sea Creator's New Tab experience.


288
00:13:32,346 --> 00:13:34,114 line:-2 position:32%
And I do want to check
out what that looks like


289
00:13:34.147 --> 00:13:37.017 line:-1 align:center
on iPhone since I haven't seen it before.


290
00:13:37,050 --> 00:13:39,920 line:-1
So I'll set that as my New Tab page,


291
00:13:41,255 --> 00:13:43,590 line:-1
close out the Extensions list,


292
00:13:43,624 --> 00:13:46,159 line:-1
and open up a new tab.


293
00:13:46,193 --> 00:13:47,961 line:-1
And just as I'd expect,


294
00:13:47,995 --> 00:13:50,597 position:30% line:-2
there's that New Tab page
from Sea Creator.


295
00:13:50.631 --> 00:13:52.499 line:-1 align:center
But the text is really small,


296
00:13:52.533 --> 00:13:54.768 line:-1 align:center
and the page just doesn't look good.


297
00:13:54,801 --> 00:13:57,604 position:25% line:-2
This is the first time I've ever run
this extension on iOS,


298
00:13:57.638 --> 00:14:00.674 line:-2 position:30% align:start
so it's not surprising
that the content hasn't yet


299
00:14:00,707 --> 00:14:03,310 line:-1
been adjusted to work well with iPhone.


300
00:14:03,343 --> 00:14:05,612 line:-1
I want to go fix this now, and to do that,


301
00:14:05.646 --> 00:14:08.982 line:-2 position:28% align:start
I'll use Web Inspector to take
a closer look at this page


302
00:14:09.016 --> 00:14:11.685 line:-1 align:center
and try out a few changes I have in mind.


303
00:14:11,718 --> 00:14:13,687 line:-1
So to get to Web Inspector,


304
00:14:13,720 --> 00:14:17,391 line:-1
I'll open up Safari on my Mac,


305
00:14:17.424 --> 00:14:20.694 line:-2 position:25% align:start
and then I'll double-check
in Safari's Advanced Preferences


306
00:14:20.727 --> 00:14:23.830 line:-2 position:29% align:start
to make sure I have
the Develop menu enabled.


307
00:14:31.738 --> 00:14:35.008 line:-1 align:center
And now that I have that Develop menu,


308
00:14:35,042 --> 00:14:37,744 position:29% line:-2
I can open it up,
select the iPhone Simulator


309
00:14:37.778 --> 00:14:41.481 line:-2 align:start position:27%
I've been using,
and choose a page to inspect.


310
00:14:41,515 --> 00:14:44,318 line:-2 align:start
Now, there are two options
here for Sea Creator.


311
00:14:44,351 --> 00:14:46,753 position:26% line:-2
I could select
the Extension Background Page


312
00:14:46,787 --> 00:14:49,289 position:33% line:-2
if I'd like to debug
the background script,


313
00:14:49.323 --> 00:14:52.392 line:-2 align:start position:28%
but in this case, I want
to inspect the New Tab page.


314
00:14:52.426 --> 00:14:54.995 line:-1 align:center
So I'll choose the other option.


315
00:14:56.330 --> 00:14:58.632 line:-1 align:center
And now I'm in Web Inspector.


316
00:14:58.665 --> 00:15:00.400 line:-1 align:center
The first thing I want to address here


317
00:15:00.434 --> 00:15:02.703 line:-1 align:center
is the overall size of the page.


318
00:15:02,736 --> 00:15:05,939 position:29% line:-2
By default, Safari on iPhone
renders the web page


319
00:15:05.973 --> 00:15:08.342 line:-2 align:start position:33%
as if it were the size
of a desktop browser,


320
00:15:08,375 --> 00:15:10,744 position:31% line:-2
and then it scales
that larger content down


321
00:15:10,777 --> 00:15:12,179 line:-1
so it all fits on screen.


322
00:15:12,212 --> 00:15:14,214 line:-1
But I don't want this behavior here


323
00:15:14,248 --> 00:15:16,717 line:-1
since it makes the text too small.


324
00:15:16,750 --> 00:15:18,719 line:-1
So I'll use a very common practice


325
00:15:18.752 --> 00:15:20.988 line:-1 align:center
when it comes to web design for iPhone.


326
00:15:21,021 --> 00:15:23,924 align:start line:-2
I'll add a viewport meta-tag
to tell Safari


327
00:15:23,957 --> 00:15:26,293 line:-1
not to scale the content this way.


328
00:15:26.326 --> 00:15:28.695 line:-1 align:center
I'll select the Head element,


329
00:15:28,729 --> 00:15:30,931 line:-1
add a Child element,


330
00:15:30,964 --> 00:15:32,666 line:-1
and add the contents


331
00:15:32,699 --> 00:15:36,303 line:-1
of that viewport meta-tag.


332
00:15:36,336 --> 00:15:40,107 line:-2 position:30%
I'll add the tag,
and the page updates live


333
00:15:40,140 --> 00:15:43,110 align:start line:-2
in the simulator
in response to that change.


334
00:15:43,143 --> 00:15:45,512 line:-1
Now all the text is at a readable size,


335
00:15:45,546 --> 00:15:47,314 line:-1
but it doesn't all fit on screen,


336
00:15:47,347 --> 00:15:48,982 line:-1
which is my next problem.


337
00:15:49,016 --> 00:15:51,385 line:-2 position:27%
I want to inspect the elements
on this page


338
00:15:51,418 --> 00:15:53,887 line:-1
to understand why it lays out like this.


339
00:15:55,255 --> 00:15:57,191 line:-1
I'll look at the body tag,


340
00:15:57,224 --> 00:15:59,193 line:-1
and I notice there's this div here


341
00:15:59.226 --> 00:16:02.529 line:-1 align:center
that contains all the content on the page.


342
00:16:02.563 --> 00:16:04.064 line:-1 align:center
If I focus it


343
00:16:04,097 --> 00:16:07,301 line:-2 align:start
and look in the stylesheet
sidebar to the right,


344
00:16:07.334 --> 00:16:09.169 line:-1 align:center
I notice that the element


345
00:16:09,203 --> 00:16:11,772 line:-1
has a fixed width of 850.


346
00:16:11,805 --> 00:16:13,774 line:-1
That would make sense on a desktop,


347
00:16:13,807 --> 00:16:15,642 line:-1
where windows can be really wide


348
00:16:15,676 --> 00:16:17,644 line:-2 align:start
and you'd want the text
to wrap at some point.


349
00:16:17,678 --> 00:16:19,913 line:-1
But that doesn't work on iPhone


350
00:16:19.947 --> 00:16:22.482 line:-1 align:center
because the phone just isn't that wide.


351
00:16:22.516 --> 00:16:24.184 line:-1 align:center
I think it would make more sense here


352
00:16:24,218 --> 00:16:26,954 align:start line:-2
if that rule set a maximum width
for the content


353
00:16:26.987 --> 00:16:30.023 line:-1 align:center
rather than demanding an exact width.


354
00:16:30,057 --> 00:16:32,926 line:-1
And I can simply edit the rule here.


355
00:16:32.960 --> 00:16:35.262 line:-1 align:center
I'll click width


356
00:16:35.295 --> 00:16:37.631 line:-1 align:center
and change it to max-width,


357
00:16:37,664 --> 00:16:40,033 line:-1
and the page in the simulator updates


358
00:16:40.067 --> 00:16:42.002 line:-1 align:center
to reflect that change.


359
00:16:42,035 --> 00:16:45,405 position:25% line:-2
Now the content's width is much
more appropriate for iPhone,


360
00:16:45,439 --> 00:16:48,275 line:-1
and all of the text fits on screen.


361
00:16:48,308 --> 00:16:51,612 align:start line:-2
This looks much better now,
but these changes that I've made


362
00:16:51,645 --> 00:16:54,314 align:start line:-2
are only temporary
to this Inspector session.


363
00:16:54.348 --> 00:16:56.783 line:-1 align:center
I want to actually save these changes back


364
00:16:56.817 --> 00:16:59.152 line:-1 align:center
into my project so I don't lose them.


365
00:16:59,186 --> 00:17:01,622 line:-2 position:31%
And it's really easy
to save an updated copy


366
00:17:01.655 --> 00:17:04.892 line:-2 position:28% align:start
of the stylesheet while I work
in the stylesheet Inspector.


367
00:17:04,925 --> 00:17:07,594 line:-1
I can simply type Command+S


368
00:17:07,628 --> 00:17:11,198 align:start line:-2
to save my stylesheet
that has that updated rule.


369
00:17:11.231 --> 00:17:14.101 line:-1 align:center
And I'll overwrite the new_tab_page.css


370
00:17:14,134 --> 00:17:16,904 line:-1
in my project.


371
00:17:17,905 --> 00:17:20,908 line:-2 align:start
But for the viewport change,
I added that tag


372
00:17:20,941 --> 00:17:24,144 line:-2 position:28%
to a live web page
rather than a static resource,


373
00:17:24.178 --> 00:17:27.781 line:-2 position:27% align:start
so I'll have to make the same
change to the original source.


374
00:17:27.814 --> 00:17:31.151 line:-1 align:center
I'll select that tag,


375
00:17:31.185 --> 00:17:33.654 line:-1 align:center
copy it,


376
00:17:33.687 --> 00:17:36.490 line:-1 align:center
go back to Xcode,


377
00:17:36.523 --> 00:17:39.626 line:-1 align:center
open up that source for the New Tab page,


378
00:17:41,128 --> 00:17:44,398 line:-1
and paste the contents there.


379
00:17:46,767 --> 00:17:49,036 line:-1
So the next time I run Sea Creator,


380
00:17:49.069 --> 00:17:52.039 line:-2 align:start position:28%
it'll use that updated
page source and stylesheet,


381
00:17:52,072 --> 00:17:54,842 line:-1
and it'll look just as good again.


382
00:17:54,875 --> 00:17:58,011 line:-2 position:26%
And that's been a few examples
of using Web Inspector


383
00:17:58.045 --> 00:18:00.113 line:-1 align:center
to look under the hood of a web extension,


384
00:18:00.147 --> 00:18:02.416 line:-1 align:center
understand exactly what's happening,


385
00:18:02.449 --> 00:18:04.751 line:-1 align:center
and experiment with potential changes


386
00:18:04.785 --> 00:18:07.154 line:-1 align:center
while iterating on the extension.


387
00:18:07.187 --> 00:18:10.090 line:-2 position:28% align:start
For now, I'm only going
to look at the New Tab page,


388
00:18:10,123 --> 00:18:13,193 align:start line:-2
but later on in development,
I should obviously go test


389
00:18:13,227 --> 00:18:16,163 align:start line:-2
all the other parts
of the extension on iOS,


390
00:18:16,196 --> 00:18:19,700 align:start line:-2
and I'd use the same tools
and techniques for that.


391
00:18:19.733 --> 00:18:23.303 line:-2 align:start position:30%
You can use Safari's
extension settings on iOS


392
00:18:23,337 --> 00:18:25,606 line:-1
to view any errors in the configuration


393
00:18:25,639 --> 00:18:26,974 line:-1
of your Web Extension.


394
00:18:27,007 --> 00:18:29,977 position:26% line:-2
Specifically,
Sea Creator had the fatal error


395
00:18:30.010 --> 00:18:32.513 line:-1 align:center
of using a persistent background page,


396
00:18:32.546 --> 00:18:34.848 line:-2 align:start position:32%
but there may also be
non-fatal warnings here


397
00:18:34.882 --> 00:18:36.717 line:-1 align:center
that you should check out.


398
00:18:36,750 --> 00:18:39,019 line:-1
These details will only appear in Settings


399
00:18:39.052 --> 00:18:41.455 line:-1 align:center
for debug builds of your app from Xcode


400
00:18:41,488 --> 00:18:45,325 line:-2 position:29%
and not for copies from
the App Store or TestFlight.


401
00:18:46,026 --> 00:18:48,495 line:-1
As you make changes to your web extension,


402
00:18:48,529 --> 00:18:51,798 line:-2 position:27%
you simply run your app again
to update the extension


403
00:18:51.832 --> 00:18:54.902 line:-1 align:center
on the device or simulator.


404
00:18:54.935 --> 00:18:57.704 line:-1 align:center
And of course, Web Inspector allows you


405
00:18:57,738 --> 00:19:01,542 align:start line:-2
to investigate issues with
your extension's web content.


406
00:19:01,575 --> 00:19:04,344 align:start line:-2
Remember that in order
to access Web Inspector,


407
00:19:04.378 --> 00:19:06.513 line:-1 align:center
I had to enable the Develop menu


408
00:19:06,547 --> 00:19:09,750 align:start line:-2
in Safari's Advanced Preferences
on the Mac.


409
00:19:09,783 --> 00:19:13,587 line:-2 position:29%
In my demo, I used the iOS
simulator for my extension,


410
00:19:13,620 --> 00:19:16,790 line:-2 align:start
but if you wanted
to use a physical iOS device,


411
00:19:16,823 --> 00:19:19,326 line:-2 align:start
you would also need
to enable Web Inspector support


412
00:19:19,359 --> 00:19:22,863 position:27% line:-2
on that device
in Safari's Advanced Settings.


413
00:19:22.896 --> 00:19:24.932 line:-1 align:center
To take a deeper dive into Web Inspector


414
00:19:24,965 --> 00:19:27,434 line:-2 align:start
and learn about some
of its newest features,


415
00:19:27,467 --> 00:19:30,737 line:-2 position:24%
check out Discover Web Inspector
improvements.


416
00:19:30.771 --> 00:19:33.941 line:-2 align:start position:26%
Now that I've created
a Safari Web Extension for iOS


417
00:19:33,974 --> 00:19:36,543 line:-1
and I've debugged a few basic issues,


418
00:19:36,577 --> 00:19:39,780 align:start line:-2
I'd like to walk through some
best practices to keep in mind,


419
00:19:39.813 --> 00:19:42.616 line:-2 position:26% align:start
including some things
you might need to watch out for


420
00:19:42.649 --> 00:19:46.086 line:-2 position:31% align:start
as you build an extension
for Safari on iOS.


421
00:19:46.119 --> 00:19:48.088 line:-1 align:center
I'll focus on five topics


422
00:19:48,121 --> 00:19:50,490 line:-1
that may be relevant to your extension,


423
00:19:50,524 --> 00:19:54,228 line:-2 position:29%
starting with non-persistent
background pages.


424
00:19:54,261 --> 00:19:57,931 line:-2 position:22%
The background page
is a web page that the browser loads


425
00:19:57,965 --> 00:20:00,467 line:-1
to run your extension's background script.


426
00:20:00.501 --> 00:20:03.504 line:-2 align:start position:26%
And this page allows
your extension to handle events


427
00:20:03,537 --> 00:20:07,274 line:-2 position:25%
sent by the browser
or other parts of your extension.


428
00:20:07,307 --> 00:20:10,611 line:-2 position:28%
But keeping this page loaded
has a performance cost.


429
00:20:10,644 --> 00:20:12,546 line:-1
It can use memory and power


430
00:20:12,579 --> 00:20:15,516 line:-2 position:22%
as if you were keeping one more tab
open and running


431
00:20:15,549 --> 00:20:17,885 line:-1
for every enabled extension.


432
00:20:17,918 --> 00:20:20,587 line:-2 align:start
Keeping all these pages
loaded all the time


433
00:20:20.621 --> 00:20:22.756 line:-1 align:center
can be pretty wasteful.


434
00:20:22,789 --> 00:20:26,393 align:start line:-2
But you can make
a background page non-persistent,


435
00:20:26,426 --> 00:20:30,030 line:-2 position:25%
which means the browser will
only load it when your extension


436
00:20:30.063 --> 00:20:33.433 line:-2 align:start position:30%
actually needs to do work,
and the browser can later


437
00:20:33.467 --> 00:20:36.870 line:-2 position:24% align:start
unload that page
when it's been idle for some time.


438
00:20:36,904 --> 00:20:39,706 align:start line:-2
That way, the performance cost
is only paid


439
00:20:39,740 --> 00:20:43,110 align:start line:-2
while your extension
is doing something useful.


440
00:20:43,143 --> 00:20:46,480 align:start line:-2
This is important because
background pages must be


441
00:20:46.513 --> 00:20:49.583 line:-1 align:center
non-persistent on iOS, where system memory


442
00:20:49,616 --> 00:20:53,353 align:start line:-2
and battery life are especially
at a premium.


443
00:20:53,387 --> 00:20:56,623 line:-2 align:start
The web extension templates
in Xcode already come


444
00:20:56,657 --> 00:20:58,492 line:-1
with a non-persistent background page,


445
00:20:58,525 --> 00:21:01,595 line:-1
so they're ready to run on iOS.


446
00:21:01.628 --> 00:21:04.498 line:-1 align:center
But if you have an existing extension


447
00:21:04,531 --> 00:21:06,834 line:-1
that uses a persistent background page


448
00:21:06,867 --> 00:21:08,502 line:-1
like Sea Creator did,


449
00:21:08,535 --> 00:21:11,705 line:-2 position:32%
you'll need to change it
to be non-persistent.


450
00:21:11,738 --> 00:21:15,576 line:-2 position:27%
And you can do that by adding
that "persistent:" False key


451
00:21:15.609 --> 00:21:19.313 line:-2 position:30% align:start
in the background section
of your manifest.


452
00:21:19.346 --> 00:21:21.648 line:-1 align:center
To learn more about some best practices


453
00:21:21.682 --> 00:21:23.717 line:-1 align:center
and potential issues you may face


454
00:21:23,750 --> 00:21:25,152 line:-1
when updating an extension


455
00:21:25.185 --> 00:21:27.554 line:-1 align:center
to use a non-persistent background page,


456
00:21:27.588 --> 00:21:28.655 line:-1 align:center
check out


457
00:21:28,689 --> 00:21:32,726 line:-1
Explore Safari Web Extension Improvements.


458
00:21:32,759 --> 00:21:34,127 line:-1
Up next,


459
00:21:34.161 --> 00:21:37.631 line:-1 align:center
let's talk about responsive design.


460
00:21:37,664 --> 00:21:39,700 line:-1
As we learned with Sea Creator,


461
00:21:39.733 --> 00:21:41.668 line:-1 align:center
bringing an extension to iOS


462
00:21:41.702 --> 00:21:43.871 line:-1 align:center
means its web content may be rendered


463
00:21:43,904 --> 00:21:47,241 line:-2 position:23%
in new environments
that you haven't considered before.


464
00:21:47,274 --> 00:21:50,577 position:24% line:-2
Just like I did
with Sea Creator's New Tab page,


465
00:21:50.611 --> 00:21:53.814 line:-2 position:26% align:start
be sure to test the layout
of your extension's web content


466
00:21:53,847 --> 00:21:57,518 position:28% line:-2
on iPhone and iPad
and use a responsive design


467
00:21:57.551 --> 00:22:00.587 line:-1 align:center
that can accommodate various screen sizes.


468
00:22:00.621 --> 00:22:02.823 line:-1 align:center
But the difference in screen size isn't


469
00:22:02,856 --> 00:22:05,025 line:-1
the only consideration when it comes


470
00:22:05,058 --> 00:22:08,295 line:-2 align:start
to making your web content
look great on iOS.


471
00:22:08.328 --> 00:22:11.398 line:-2 position:24% align:start
Let me tell you about a few things
you should be aware of.


472
00:22:11.431 --> 00:22:14.134 line:-2 position:34% align:start
If your extension has
full-page web content


473
00:22:14,168 --> 00:22:18,071 line:-2 position:26%
that lays out important elements
near the bottom of the screen,


474
00:22:18.105 --> 00:22:21.208 line:-2 align:start position:28%
you may find it being covered
by Safari's Tab Bar


475
00:22:21.241 --> 00:22:23.944 line:-1 align:center
or the device's home indicator.


476
00:22:23.977 --> 00:22:27.414 line:-2 position:32% align:start
In CSS terminology,
this area near the edge


477
00:22:27.447 --> 00:22:30.117 line:-2 align:start position:26%
of the screen where
content may be partially hidden


478
00:22:30,150 --> 00:22:32,119 line:-1
is called the unsafe area,


479
00:22:32.152 --> 00:22:33.754 line:-1 align:center
while the usable area


480
00:22:33,787 --> 00:22:37,157 line:-1
of the viewport is called the safe area.


481
00:22:37.191 --> 00:22:40.327 line:-1 align:center
By using CSS environment variables,


482
00:22:40,360 --> 00:22:43,263 line:-1
you can calculate the safe area inset


483
00:22:43.297 --> 00:22:45.866 line:-2 align:start position:25%
to make sure important elements
are positioned


484
00:22:45.899 --> 00:22:47.901 line:-1 align:center
within the safe area.


485
00:22:47,935 --> 00:22:51,572 line:-2 align:start
On iPhone, this is also
worth considering in Landscape,


486
00:22:51,605 --> 00:22:54,274 line:-1
where devices may have safe area insets


487
00:22:54.308 --> 00:22:58.579 line:-2 align:start position:31%
on the left and right side
of the display as well.


488
00:22:58.612 --> 00:23:00.881 line:-1 align:center
By using similar CSS


489
00:23:00,914 --> 00:23:03,550 align:start line:-2
and by specifying
the viewport-fit parameter


490
00:23:03.584 --> 00:23:04.918 line:-1 align:center
in your viewport,


491
00:23:04,952 --> 00:23:08,322 line:-2 position:27%
you can give your web content
an edge-to-edge design


492
00:23:08,355 --> 00:23:11,925 line:-2 position:28%
that still keeps important
content within the safe area.


493
00:23:13,327 --> 00:23:17,631 align:start line:-2
Check out Design for Safari 15
to learn more about these APIs


494
00:23:17,664 --> 00:23:21,368 align:start line:-2
that can make your web content
feel more at home on iOS.


495
00:23:21.401 --> 00:23:23.904 line:-1 align:center
On iPad and desktop browsers,


496
00:23:23,937 --> 00:23:25,939 line:-1
if your extension has a pop-up page,


497
00:23:25,973 --> 00:23:28,675 align:start line:-2
you may be used to it
being shown as a popover


498
00:23:28.709 --> 00:23:31.912 line:-2 position:32% align:start
that's comfortably sized
to fit its content.


499
00:23:31.945 --> 00:23:33.847 line:-1 align:center
But on iPhone, however,


500
00:23:33,881 --> 00:23:36,917 align:start line:-2
Safari will display
this web page as a sheet,


501
00:23:36.950 --> 00:23:40.053 line:-1 align:center
which may be a surprise to your content.


502
00:23:40.087 --> 00:23:42.689 line:-2 position:27% align:start
The sheet spans the full width
of the device,


503
00:23:42,723 --> 00:23:44,458 line:-1
and it may be laid out taller


504
00:23:44,491 --> 00:23:46,960 line:-1
than the content expects.


505
00:23:46.994 --> 00:23:50.330 line:-2 position:26% align:start
In this screenshot of
an early version of Sea Creator,


506
00:23:50.364 --> 00:23:52.332 line:-1 align:center
the content didn't have much padding


507
00:23:52,366 --> 00:23:53,934 line:-1
from the edge of the screen,


508
00:23:53.967 --> 00:23:57.004 line:-2 align:start position:27%
and we set a background color
on an individual element


509
00:23:57,037 --> 00:23:59,973 line:-1
in the page rather than on the body.


510
00:24:00,007 --> 00:24:01,742 line:-1
So the text looks a bit cramped


511
00:24:01,775 --> 00:24:03,443 line:-1
and the background doesn't fill


512
00:24:03,477 --> 00:24:05,979 line:-1
the whole page.


513
00:24:06.013 --> 00:24:08.215 line:-1 align:center
But we've since updated the alignment


514
00:24:08.248 --> 00:24:09.750 line:-1 align:center
and padding of the content


515
00:24:09,783 --> 00:24:12,186 line:-1
to give it a little more space to breathe,


516
00:24:12.219 --> 00:24:14.588 line:-1 align:center
and we now specify a background color


517
00:24:14,621 --> 00:24:17,724 line:-1
on the body so it covers the whole sheet.


518
00:24:17.758 --> 00:24:20.460 line:-1 align:center
If your extension has a pop-up page,


519
00:24:20,494 --> 00:24:22,729 line:-2 position:26%
think about whether you should
make similar changes


520
00:24:22.763 --> 00:24:24.565 line:-1 align:center
for your extension.


521
00:24:24,598 --> 00:24:28,101 line:-2 align:start
And note that Safari will use
a similar presentation


522
00:24:28,135 --> 00:24:29,970 line:-1
in Landscape as well.


523
00:24:30,003 --> 00:24:32,105 line:-1
Be sure to test your extension's interface


524
00:24:32.139 --> 00:24:35.108 line:-2 position:26% align:start
in these configurations to make
sure its layout makes sense


525
00:24:35,142 --> 00:24:37,611 line:-1
when given this extra space.


526
00:24:37.644 --> 00:24:40.547 line:-2 position:24% align:start
And finally
among the design considerations,


527
00:24:40,581 --> 00:24:43,150 line:-1
I want to mention Dynamic Type.


528
00:24:43.183 --> 00:24:46.186 line:-2 position:30% align:start
Dynamic Type is a feature
that allows users


529
00:24:46.220 --> 00:24:50.057 line:-2 align:start position:30%
to adjust the size of text
and other visual elements.


530
00:24:50.090 --> 00:24:53.827 line:-1 align:center
You can make content smaller to fit more


531
00:24:53.861 --> 00:24:57.097 line:-1 align:center
or larger so it's more visible.


532
00:24:57.130 --> 00:24:59.499 line:-1 align:center
Be sure to test your extension's interface


533
00:24:59.533 --> 00:25:03.403 line:-2 position:25% align:start
under smaller or larger text sizes
to make sure it looks all right


534
00:25:03.437 --> 00:25:07.107 line:-1 align:center
with any size the user chooses.


535
00:25:07.140 --> 00:25:10.344 line:-2 align:start position:25%
To help your web content
make the most of Dynamic Type,


536
00:25:10,377 --> 00:25:13,080 line:-1
WebKit has a variety of system fonts


537
00:25:13,113 --> 00:25:15,983 align:start line:-2
that respect
the user's text size preference


538
00:25:16.016 --> 00:25:18.886 line:-1 align:center
and resize to match.


539
00:25:18.919 --> 00:25:21.321 line:-2 align:start position:28%
You should adopt
these fonts in your extension


540
00:25:21.355 --> 00:25:24.424 line:-2 position:25% align:start
so that its text remains
comfortably readable to the user,


541
00:25:24,458 --> 00:25:27,528 line:-1
just like the rest of Safari's interface.


542
00:25:27.561 --> 00:25:29.997 line:-1 align:center
So the main takeaway here is


543
00:25:30,030 --> 00:25:32,299 line:-1
to design your extension's web content


544
00:25:32,332 --> 00:25:35,469 line:-1
with Safari's UI in mind.


545
00:25:35.502 --> 00:25:38.972 line:-1 align:center
Test any full page web content on iPhone


546
00:25:39,006 --> 00:25:41,675 align:start line:-2
to make sure that it adapts well
to the screen size


547
00:25:41.708 --> 00:25:44.244 line:-1 align:center
and doesn't clash with Safari's UI


548
00:25:44.278 --> 00:25:47.214 line:-1 align:center
at the bottom of the screen.


549
00:25:47.247 --> 00:25:50.851 line:-2 position:24% align:start
You should test your pop-up
web page on iPhone to make sure


550
00:25:50.884 --> 00:25:54.655 line:-2 align:start position:25%
its layout makes sense
with the sheet-style presentation,


551
00:25:54,688 --> 00:25:56,456 line:-1
and you should test your interface


552
00:25:56,490 --> 00:25:59,326 line:-1
across a wide range of Dynamic Type sizes


553
00:25:59.359 --> 00:26:02.796 line:-2 align:start position:31%
to make sure it adjusts
for the user's preference.


554
00:26:02.829 --> 00:26:05.966 line:-2 align:start position:30%
For more tips on designing
web content to look great


555
00:26:05,999 --> 00:26:07,868 line:-1
in Safari's new interface,


556
00:26:07,901 --> 00:26:11,171 line:-1
check out Design for Safari 15.


557
00:26:11,205 --> 00:26:14,174 line:-1
Up next, pointer events.


558
00:26:14,842 --> 00:26:18,345 align:start line:-2
If your extension currently depends
on handling mouse events


559
00:26:18,378 --> 00:26:21,114 line:-1
for arbitrary clicks and drags,


560
00:26:21.148 --> 00:26:22.983 line:-1 align:center
be aware that the same events


561
00:26:23.016 --> 00:26:26.854 line:-1 align:center
won't be sent when the user taps on iOS.


562
00:26:26,887 --> 00:26:30,691 line:-2 position:31%
You should instead adopt
the Pointer Events API.


563
00:26:30.724 --> 00:26:33.126 line:-1 align:center
It's similar to the Mouse Events API,


564
00:26:33.160 --> 00:26:36.063 line:-2 align:start position:30%
and it works just the same
with mouse input,


565
00:26:36.096 --> 00:26:39.533 line:-2 position:30% align:start
but the Pointer Events API
also reports touches


566
00:26:39.566 --> 00:26:42.736 line:-1 align:center
and Apple Pencil input.


567
00:26:42,769 --> 00:26:44,571 line:-1
And now let's talk


568
00:26:44,605 --> 00:26:47,708 line:-1
about the Web Extension Windows API.


569
00:26:47.741 --> 00:26:49.710 line:-1 align:center
On desktop browsers,


570
00:26:49,743 --> 00:26:52,179 line:-1
users may have multiple windows open


571
00:26:52.212 --> 00:26:55.582 line:-2 align:start position:25%
and your Web Extension can use
the browser.windows API


572
00:26:55.616 --> 00:26:57.584 line:-1 align:center
to work with these windows.


573
00:26:57,618 --> 00:26:59,853 line:-1
And the same is true on iPad,


574
00:26:59.887 --> 00:27:03.257 line:-2 position:25% align:start
where you can also
open multiple windows of Safari.


575
00:27:03.290 --> 00:27:06.593 line:-1 align:center
Each Safari window might be full screen,


576
00:27:06.627 --> 00:27:08.562 line:-1 align:center
or it might be in split view,


577
00:27:08.595 --> 00:27:10.230 line:-1 align:center
side-by-side with another app,


578
00:27:10,264 --> 00:27:12,633 line:-1
maybe another Safari.


579
00:27:12.666 --> 00:27:14.001 line:-1 align:center
Under the hood though,


580
00:27:14.034 --> 00:27:15.969 line:-1 align:center
each of these windows is actually


581
00:27:16,003 --> 00:27:18,505 line:-1
called a scene on iOS.


582
00:27:18.539 --> 00:27:21.375 line:-1 align:center
If your extension uses the Windows API,


583
00:27:21,408 --> 00:27:23,110 line:-1
you should know that each scene


584
00:27:23,143 --> 00:27:26,013 line:-1
of Safari actually has two windows:


585
00:27:26,046 --> 00:27:29,616 line:-2 position:28%
one for regular browsing
and one for Private browsing.


586
00:27:29.650 --> 00:27:31.485 line:-1 align:center
This is also true on iPhone,


587
00:27:31,518 --> 00:27:35,022 align:start line:-2
even though there's
only one scene of Safari.


588
00:27:35,055 --> 00:27:38,892 line:-1
If I call the browser.windows.getAll API


589
00:27:38.926 --> 00:27:40.861 line:-1 align:center
to query what windows are open,


590
00:27:40.894 --> 00:27:42.563 line:-1 align:center
then the API returns


591
00:27:42.596 --> 00:27:44.998 line:-1 align:center
these two window objects.


592
00:27:45,032 --> 00:27:46,633 line:-1
In the first window,


593
00:27:46.667 --> 00:27:49.269 line:-1 align:center
the incognito property is false,


594
00:27:49.303 --> 00:27:51.872 line:-1 align:center
and focused is true.


595
00:27:51,905 --> 00:27:54,174 line:-1
This represents the window I'm looking at,


596
00:27:54,208 --> 00:27:55,742 line:-1
which is in regular browsing


597
00:27:55.776 --> 00:27:58.445 line:-1 align:center
and not Private Browsing.


598
00:27:58,478 --> 00:28:01,515 line:-2 position:30%
The second window holds
the Private Browsing tabs


599
00:28:01.548 --> 00:28:03.417 line:-1 align:center
in the Safari scene.


600
00:28:03,450 --> 00:28:06,820 line:-2 align:start
And of course, its properties are
different from the first window.


601
00:28:06,854 --> 00:28:10,691 line:-1
Incognito is true, and focused is false.


602
00:28:10,724 --> 00:28:14,027 position:31% line:-2
Now when I switch Safari
to Private Browsing


603
00:28:14.061 --> 00:28:16.597 line:-1 align:center
and call windows.getAll again,


604
00:28:16.630 --> 00:28:20.300 line:-1 align:center
the API returns different window objects.


605
00:28:20.334 --> 00:28:23.837 line:-2 align:start position:27%
Now the focused property
has changed in both windows,


606
00:28:23,871 --> 00:28:27,140 line:-1
and the second window now has focus.


607
00:28:29.376 --> 00:28:31.979 line:-1 align:center
This works exactly the same on iPad


608
00:28:32,012 --> 00:28:33,714 line:-1
where one Safari scene


609
00:28:33,747 --> 00:28:36,183 line:-1
is represented by two windows.


610
00:28:36,216 --> 00:28:40,020 line:-2 position:28%
But if I open a second scene
of Safari in split view,


611
00:28:40,053 --> 00:28:42,856 line:-1
the API would now report four windows.


612
00:28:42,890 --> 00:28:47,160 line:-2 position:24%
And if my extension listens
for the windows.onCreated event,


613
00:28:47.194 --> 00:28:49.463 line:-1 align:center
it would observe that event fire twice


614
00:28:49.496 --> 00:28:51.198 line:-1 align:center
when opening split view,


615
00:28:51,231 --> 00:28:53,433 line:-1
once for each of the two new windows


616
00:28:53.467 --> 00:28:55.602 line:-1 align:center
in the new Safari scene.


617
00:28:55,636 --> 00:28:58,839 line:-2 position:32%
So if you use this API,
keep this model in mind


618
00:28:58,872 --> 00:29:00,674 line:-1
as you encounter extra windows


619
00:29:00,707 --> 00:29:02,876 line:-1
you might not expect at first.


620
00:29:02.910 --> 00:29:06.513 line:-2 align:start position:28%
In addition to this model
of what a window actually is,


621
00:29:06,547 --> 00:29:09,283 line:-2 align:start
there are a few limitations
of the windows API


622
00:29:09.316 --> 00:29:11.618 line:-1 align:center
that may affect your extension.


623
00:29:11.652 --> 00:29:14.855 line:-1 align:center
The methods to create, remove,


624
00:29:14,888 --> 00:29:18,525 align:start line:-2
and update the state of windows
aren't available.


625
00:29:18,559 --> 00:29:20,627 line:-1
On iOS, window placement


626
00:29:20.661 --> 00:29:22.829 line:-1 align:center
is fully controlled by the user,


627
00:29:22,863 --> 00:29:26,400 line:-1
not any app or extension.


628
00:29:26,433 --> 00:29:29,937 line:-1
The windows.onRemoved event won't be fired


629
00:29:29,970 --> 00:29:32,706 position:29% line:-2
as you'd maybe expect
when the user closes Safari


630
00:29:32.739 --> 00:29:34.608 line:-1 align:center
from the app switcher.


631
00:29:34,641 --> 00:29:37,678 align:start line:-2
That doesn't truly close
or remove a window.


632
00:29:37,711 --> 00:29:39,813 line:-1
It just leaves it for the user to pick up


633
00:29:39,847 --> 00:29:42,449 line:-1
where they left off later.


634
00:29:42.482 --> 00:29:44.985 line:-2 position:26% align:start
And note that these restrictions
only apply


635
00:29:45,018 --> 00:29:46,553 line:-1
to the windows themselves


636
00:29:46.587 --> 00:29:49.456 line:-1 align:center
and not the tabs within those windows.


637
00:29:49,489 --> 00:29:52,292 line:-1
With the browser.tabs API,


638
00:29:52,326 --> 00:29:55,095 position:32% line:-2
Web Extensions still
have full control to add,


639
00:29:55,128 --> 00:29:59,199 position:28% line:-2
remove, and update
individual tabs as they'd like.


640
00:29:59.233 --> 00:30:02.102 line:-1 align:center
Now, last up in the best practices


641
00:30:02.135 --> 00:30:04.605 line:-1 align:center
is feature detection.


642
00:30:04,638 --> 00:30:07,841 line:-2 align:start
When bringing
an existing extension to iOS,


643
00:30:07.875 --> 00:30:10.844 line:-1 align:center
you may find some APIs are unavailable--


644
00:30:10,878 --> 00:30:14,848 line:-2 align:start
for example, the windows APIs
that I mentioned a moment ago.


645
00:30:14,882 --> 00:30:18,218 position:30% line:-2
But there are a few others,
like context menus


646
00:30:18,252 --> 00:30:21,221 line:-1
and WebRequest.


647
00:30:21,255 --> 00:30:24,691 align:start line:-2
If non-essential parts
of your extension use such APIs,


648
00:30:24,725 --> 00:30:27,594 align:start line:-2
be sure to use feature detection
to handle the case


649
00:30:27,628 --> 00:30:29,730 line:-1
that they're not available.


650
00:30:29,763 --> 00:30:32,499 line:-1
So, instead of unconditionally


651
00:30:32,533 --> 00:30:34,535 line:-1
calling these APIs,


652
00:30:34.568 --> 00:30:36.603 line:-1 align:center
conditionalize that code based


653
00:30:36,637 --> 00:30:38,705 line:-1
on the existence of those APIs,


654
00:30:38,739 --> 00:30:41,675 position:25% line:-2
so you can cleanly exclude parts
of your extension


655
00:30:41.708 --> 00:30:43.710 line:-1 align:center
and make it more flexible when it comes


656
00:30:43.744 --> 00:30:46.713 line:-1 align:center
to which browsers it supports.


657
00:30:46.747 --> 00:30:49.783 line:-2 align:start position:25%
You should also use this pattern
when adopting new APIs


658
00:30:49,816 --> 00:30:51,451 line:-1
that are added in the future,


659
00:30:51.485 --> 00:30:53.854 line:-1 align:center
as they might not immediately be available


660
00:30:53,887 --> 00:30:57,090 align:start line:-2
across all browsers
or in previous versions


661
00:30:57.124 --> 00:31:01.094 line:-2 position:28% align:start
of browsers that some users
may still be using.


662
00:31:01,128 --> 00:31:04,298 line:-1
And that wraps up the best practices.


663
00:31:04.331 --> 00:31:07.868 line:-2 align:start position:28%
I've now covered many parts
of Safari Web Extensions,


664
00:31:07,901 --> 00:31:11,104 line:-2 align:start
but I've saved arguably
the most important topic for last,


665
00:31:11.138 --> 00:31:13.740 line:-1 align:center
and that's user privacy.


666
00:31:13,774 --> 00:31:17,110 position:29% line:-2
User privacy is a huge part
of everything we do,


667
00:31:17,144 --> 00:31:20,614 line:-2 position:24%
so we believe users
deserve transparency and control


668
00:31:20,647 --> 00:31:23,250 align:start line:-2
when it comes to how
their personal data is handled.


669
00:31:23.283 --> 00:31:26.787 line:-2 position:28% align:start
And of course that includes
everything they do in Safari.


670
00:31:26,820 --> 00:31:29,289 align:start line:-2
Web Extensions can gain
a tremendous amount


671
00:31:29,323 --> 00:31:31,391 line:-1
of access to the user's browsing,


672
00:31:31.425 --> 00:31:33.827 line:-2 position:30% align:start
so the decision of whether
that should be allowed


673
00:31:33,861 --> 00:31:37,431 align:start line:-2
and on which websites
should be up to the user.


674
00:31:37.464 --> 00:31:40.667 line:-2 position:29% align:start
Historically, other browsers
would give an extension


675
00:31:40,701 --> 00:31:43,270 line:-1
full access to every website it requests


676
00:31:43,303 --> 00:31:45,405 line:-1
right away when you turn it on,


677
00:31:45,439 --> 00:31:49,209 line:-2 position:27%
which is potentially asking you
to sacrifice privacy up front


678
00:31:49.243 --> 00:31:52.446 line:-1 align:center
just to get a taste of the extension.


679
00:31:52,479 --> 00:31:55,916 line:-2 position:29%
But Safari aims to do better
by providing transparency


680
00:31:55.949 --> 00:31:58.252 line:-1 align:center
and control to Web Extension users


681
00:31:58,285 --> 00:32:02,022 align:start line:-2
with an opt-in model where
extensions are only given access


682
00:32:02.055 --> 00:32:05.125 line:-1 align:center
to websites when the user consents.


683
00:32:05,158 --> 00:32:07,961 align:start line:-2
You caught a glimpse
of this earlier with Sea Creator.


684
00:32:07,995 --> 00:32:11,198 line:-2 position:31%
It didn't immediately
start modifying my pages


685
00:32:11,231 --> 00:32:14,501 line:-2 position:27%
when I turned it on,
but it was only able to do that


686
00:32:14,535 --> 00:32:16,603 line:-1
when I explicitly told Safari,


687
00:32:16,637 --> 00:32:19,640 line:-1
"Yes, I want to use this extension here,


688
00:32:19.673 --> 00:32:22.376 line:-1 align:center
and I'm okay with it having access."


689
00:32:22,409 --> 00:32:25,345 line:-1
And once I give an extension that access,


690
00:32:25,379 --> 00:32:27,681 line:-1
Safari tells me in the Tab Bar


691
00:32:27,714 --> 00:32:30,350 align:start line:-2
that I have an extension running
on this page,


692
00:32:30.384 --> 00:32:32.019 line:-1 align:center
so I know that the extension


693
00:32:32,052 --> 00:32:34,755 line:-1
might be seeing my web browsing here.


694
00:32:34,788 --> 00:32:36,924 line:-1
But if I navigate to any website


695
00:32:36,957 --> 00:32:39,893 position:31% line:-2
that I haven't yet allowed
the extension to access,


696
00:32:39,927 --> 00:32:42,296 line:-1
that indicator disappears.


697
00:32:42,329 --> 00:32:45,632 line:-2 position:27%
And I know that that extension
isn't running on this page


698
00:32:45.666 --> 00:32:48.168 line:-1 align:center
and can't see what I'm doing here.


699
00:32:48,202 --> 00:32:51,772 line:-2 align:start
Let's look at this permissions
model in more detail.


700
00:32:51.805 --> 00:32:54.975 line:-1 align:center
Again, users opt in to your extension


701
00:32:55,008 --> 00:32:58,512 align:start line:-2
when they choose to use it
on specific websites.


702
00:32:58,545 --> 00:33:01,014 line:-1
Safari will ask the user for consent


703
00:33:01,048 --> 00:33:03,784 align:start line:-2
by presenting a dialog
which makes it clear


704
00:33:03.817 --> 00:33:07.421 line:-2 align:start position:28%
which websites the extension
is trying to access.


705
00:33:07,454 --> 00:33:10,224 align:start line:-2
This happens when the user
invokes your extension


706
00:33:10.257 --> 00:33:12.059 line:-1 align:center
by selecting it in the Action menu


707
00:33:12.092 --> 00:33:15.696 line:-1 align:center
or by using any of its keyboard shortcuts.


708
00:33:15.729 --> 00:33:17.731 line:-1 align:center
And this consent is required


709
00:33:17,764 --> 00:33:21,301 line:-1
for any privacy sensitive API to work.


710
00:33:21.335 --> 00:33:23.203 line:-1 align:center
Specifically,


711
00:33:23.237 --> 00:33:25.539 line:-1 align:center
any API that reveals the URL


712
00:33:25,572 --> 00:33:28,308 line:-2 position:31%
or title of a tab
will only include this info


713
00:33:28,342 --> 00:33:31,979 align:start line:-2
if your extension has
permission for that URL.


714
00:33:32,012 --> 00:33:34,848 line:-2 align:start
The Cookies API will
only let your extension


715
00:33:34.882 --> 00:33:36.984 line:-1 align:center
read and write cookies for websites


716
00:33:37,017 --> 00:33:39,887 line:-1
your extension has permission for.


717
00:33:39.920 --> 00:33:43.290 line:-2 position:32% align:start
And injecting JavaScript
and stylesheets will


718
00:33:43,323 --> 00:33:45,392 line:-1
only be allowed on websites where,


719
00:33:45,425 --> 00:33:48,362 align:start line:-2
you guessed it,
your extension has permission.


720
00:33:49.096 --> 00:33:52.165 line:-2 align:start position:31%
If your extension's scripts
call any of these APIs


721
00:33:52,199 --> 00:33:54,801 align:start line:-2
when your extension doesn't
have the required permissions


722
00:33:54,835 --> 00:33:57,437 line:-1
but hasn't asked the user yet,


723
00:33:57,471 --> 00:34:00,407 position:31% line:-2
Safari will wait to call
your completion handlers


724
00:34:00.440 --> 00:34:02.743 line:-1 align:center
and will show a non-disruptive banner


725
00:34:02.776 --> 00:34:04.845 line:-1 align:center
at the top of the screen.


726
00:34:04.878 --> 00:34:07.714 line:-2 align:start position:32%
This lets the user know
that your extension


727
00:34:07.748 --> 00:34:11.118 line:-2 position:25% align:start
wants some more access,
and they can then review the set


728
00:34:11.151 --> 00:34:13.887 line:-1 align:center
of websites your extension is asking for,


729
00:34:13.921 --> 00:34:16.356 line:-1 align:center
and they can make a decision to allow


730
00:34:16.390 --> 00:34:19.593 line:-1 align:center
or reject access for those websites.


731
00:34:19.626 --> 00:34:22.296 line:-2 position:28% align:start
You should avoid requesting
more permission this way


732
00:34:22.329 --> 00:34:24.264 line:-1 align:center
than your extension really needs.


733
00:34:24.298 --> 00:34:26.600 line:-1 align:center
For some types of extensions,


734
00:34:26.633 --> 00:34:28.368 line:-1 align:center
this way of thinking about permission


735
00:34:28,402 --> 00:34:30,504 line:-1
might be a bit more than you need.


736
00:34:30,537 --> 00:34:33,874 line:-2 position:21%
For example, extensions that share or
annotate


737
00:34:33,907 --> 00:34:37,211 position:25% line:-2
individual web pages
don't need full access to the site


738
00:34:37,244 --> 00:34:40,247 line:-1
any time the user visits in any tab,


739
00:34:40.280 --> 00:34:42.583 line:-1 align:center
but rather they just want permission once


740
00:34:42.616 --> 00:34:44.985 line:-1 align:center
to do one thing at a time for the user.


741
00:34:45.819 --> 00:34:48.288 line:-2 position:29% align:start
And there's a great solution
for those extensions


742
00:34:48.322 --> 00:34:51.692 line:-1 align:center
called the activeTab permission.


743
00:34:51.725 --> 00:34:54.862 line:-2 position:27% align:start
When your extension requests
the activeTab permission,


744
00:34:54,895 --> 00:34:58,131 line:-2 position:26%
Safari will automatically
grant your extension permission


745
00:34:58.165 --> 00:34:59.833 line:-1 align:center
on tabs where the user


746
00:34:59.867 --> 00:35:02.803 line:-1 align:center
explicitly uses your extension.


747
00:35:02,836 --> 00:35:04,771 line:-1
And this permission will be limited


748
00:35:04,805 --> 00:35:08,008 align:start line:-2
to just the current website
in just the current tab.


749
00:35:08,041 --> 00:35:11,245 line:-2 align:start
So it'll be revoked
if the user navigates that tab


750
00:35:11.278 --> 00:35:14.348 line:-1 align:center
to a different website.


751
00:35:14,381 --> 00:35:17,718 position:27% line:-2
Safari won't display a prompt
when granting this permission,


752
00:35:17.751 --> 00:35:21.355 line:-2 position:23% align:start
since there's no long-term
commitment needed from the user.


753
00:35:22,523 --> 00:35:25,926 line:-2 align:start
To adopt this feature,
simply add activeTab


754
00:35:25.959 --> 00:35:28.929 line:-2 align:start position:31%
to the Permissions
section of your manifest.


755
00:35:29,830 --> 00:35:33,333 line:-1
So all of this is to say that in Safari,


756
00:35:33,367 --> 00:35:35,402 line:-1
users are always in control


757
00:35:35,435 --> 00:35:37,971 align:start line:-2
of which websites
their extensions can work on.


758
00:35:38,005 --> 00:35:41,408 align:start line:-2
So be aware that your extension
won't automatically be able


759
00:35:41,441 --> 00:35:45,712 line:-2 position:27%
to go to work
on every page the user visits.


760
00:35:45,746 --> 00:35:48,815 line:-2 align:start
For many extensions,
the activeTab permission


761
00:35:48.849 --> 00:35:51.685 line:-2 position:27% align:start
is a great way
to get access to just the pages


762
00:35:51.718 --> 00:35:53.620 line:-1 align:center
where the user is using your extension


763
00:35:53.654 --> 00:35:55.122 line:-1 align:center
without bugging them


764
00:35:55.155 --> 00:35:57.891 line:-1 align:center
about any access beyond that.


765
00:35:57,925 --> 00:36:00,294 line:-1
All of these concepts are the same


766
00:36:00.327 --> 00:36:04.965 line:-2 align:start position:26%
across all our platforms that
support Safari Web Extensions.


767
00:36:04,998 --> 00:36:08,635 line:-2 align:start
To see this in action
on macOS and get a closer look


768
00:36:08,669 --> 00:36:12,339 line:-2 align:start
at updating an extension
to use activeTab, check out


769
00:36:12.372 --> 00:36:16.844 line:-1 align:center
Meet Safari Web Extensions from WWDC 2020.


770
00:36:16.877 --> 00:36:19.980 line:-2 align:start position:27%
And that's the privacy
preserving permissions model


771
00:36:20.013 --> 00:36:21.949 line:-1 align:center
of Safari Web Extensions.


772
00:36:21.982 --> 00:36:24.484 line:-2 align:start position:30%
Along with everything else
I've covered today,


773
00:36:24.518 --> 00:36:26.620 line:-1 align:center
I hope this gives you a more complete view


774
00:36:26,653 --> 00:36:29,957 line:-2 align:start
of Safari Web Extensions on iOS
and the tools available


775
00:36:29,990 --> 00:36:32,025 line:-1
to you for building them.


776
00:36:32,059 --> 00:36:35,195 position:26% line:-2
We're so excited to see
the Web Extension experiences


777
00:36:35.229 --> 00:36:38.098 line:-1 align:center
that will be brought to Safari on iOS 15,


778
00:36:38,131 --> 00:36:41,468 line:-2 position:24%
including the many extensions
we already love on the Mac today


779
00:36:41,502 --> 00:36:43,637 line:-1
but also the great new extensions


780
00:36:43,670 --> 00:36:45,572 line:-1
that are yet to come.


781
00:36:45.606 --> 00:36:48.976 line:-1 align:center
So if you're new to extension development,


782
00:36:49.009 --> 00:36:51.545 line:-2 align:start position:28%
I encourage you to check out
the linked resources


783
00:36:51.578 --> 00:36:53.680 line:-1 align:center
associated with this session.


784
00:36:53,714 --> 00:36:56,383 line:-2 position:27%
There, you'll find sample code
that you can download


785
00:36:56.416 --> 00:36:58.352 line:-1 align:center
and try out for yourself.


786
00:36:58,385 --> 00:37:00,821 line:-2 align:start
And you can read more
about the Web Extension APIs


787
00:37:00,854 --> 00:37:03,991 line:-2 position:23%
available to you
in Apple's developer documentation


788
00:37:04,024 --> 00:37:06,927 line:-1
and the MDN Web Docs.


789
00:37:06,960 --> 00:37:09,229 line:-1
If you already develop a Web Extension


790
00:37:09,263 --> 00:37:12,299 line:-2 align:start
for another browser
or for Safari on the Mac,


791
00:37:12,332 --> 00:37:15,836 position:22% line:-2
I encourage you to try out
the Safari Web Extension Converter


792
00:37:15,869 --> 00:37:17,538 line:-1
in Xcode 13


793
00:37:17.571 --> 00:37:21.074 line:-1 align:center
to easily bring your extension to iOS.


794
00:37:21,108 --> 00:37:24,545 position:27% line:-2
If you have feedback
like bug reports, suggestions,


795
00:37:24,578 --> 00:37:28,482 line:-2 position:18%
or compatibility issues,
I encourage you to send us that feedback


796
00:37:28,515 --> 00:37:32,052 line:-1
at feedbackassistant.apple.com.


797
00:37:32,085 --> 00:37:35,455 position:26% line:-2
You can also reach out to us
at the Apple Developer Forums


798
00:37:35.489 --> 00:37:38.625 line:-2 position:30% align:start
if you'd like to get in touch
or have questions.


799
00:37:38.659 --> 00:37:41.428 line:-1 align:center
And finally, I'd like to again recommend


800
00:37:41,461 --> 00:37:44,264 align:start line:-2
two other sessions
you may be interested in.


801
00:37:44,298 --> 00:37:47,768 align:start line:-2
Explore Safari Web Extension
Improvements will teach you


802
00:37:47,801 --> 00:37:51,605 align:start line:-2
about some recent API additions
to Safari Web Extensions.


803
00:37:51.638 --> 00:37:54.942 line:-1 align:center
And Design for Safari 15 will show you


804
00:37:54.975 --> 00:37:56.977 line:-1 align:center
how to make your web content look great


805
00:37:57.010 --> 00:38:00.547 line:-1 align:center
with Safari's new design in iOS 15.


806
00:38:00,581 --> 00:38:04,852 align:start line:-2
Thanks for watching,
and have a great WWDC.


807
00:38:04.885 --> 00:38:08.121 line:-1 align:center
[upbeat music]

