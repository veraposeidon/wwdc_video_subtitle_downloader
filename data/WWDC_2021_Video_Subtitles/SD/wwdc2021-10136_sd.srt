2
00:00:02.069 --> 00:00:09.009 line:-1 align:center
[music]


3
00:00:09.042 --> 00:00:10.944 line:-1 align:center
[Timm] Hi, I'm Timm Hannon,


4
00:00:10.978 --> 00:00:13.847 line:-2 align:center
an engineering manager
in Core OS here at Apple.


5
00:00:13,881 --> 00:00:16,216 line:-2
In this session, my colleague
Melissa Nierle and I


6
00:00:16.250 --> 00:00:18.719 line:-2 align:center
will cover
User Enrollments for MDM.


7
00:00:19.720 --> 00:00:22.356 line:-2 align:center
User Enrollment
is designed for BYOD,


8
00:00:22.389 --> 00:00:24.258 line:-2 align:center
or Bring Your Own Device
deployments


9
00:00:24,291 --> 00:00:25,959 line:-2
where the user,
not the organization,


10
00:00:25.993 --> 00:00:27.461 line:-1 align:center
owns the device.


11
00:00:27,494 --> 00:00:29,329 line:-2
Because the user
owns the device,


12
00:00:29.363 --> 00:00:30.731 line:-2 align:center
User Enrollment
has a limited set


13
00:00:30.764 --> 00:00:32.399 line:-1 align:center
of payloads and restrictions


14
00:00:32.432 --> 00:00:33.767 line:-2 align:center
that can be applied
to the device


15
00:00:33,800 --> 00:00:36,436 line:-2
by the Mobile Device Management
solution.


16
00:00:36.470 --> 00:00:39.806 line:-2 align:center
And it's available on iOS,
iPadOS, and macOS.


17
00:00:41,408 --> 00:00:43,343 line:-2
Security and privacy
are at the heart


18
00:00:43,377 --> 00:00:45,679 line:-2
of everything we do
here at Apple.


19
00:00:45,712 --> 00:00:48,482 line:-2
User Enrollment is a great
device management option


20
00:00:48,515 --> 00:00:50,317 line:-1
that incorporates both.


21
00:00:50,350 --> 00:00:52,753 line:-2
Its design allows the user
to be comfortable


22
00:00:52,786 --> 00:00:55,856 line:-2
that their privacy and
personal data are protected,


23
00:00:55,889 --> 00:00:59,826 line:-2
while the organization can be
confident their data is secure.


24
00:01:00.827 --> 00:01:02.563 line:-1 align:center
There are three core components


25
00:01:02,596 --> 00:01:05,699 line:-2
that form the basis
of User Enrollment.


26
00:01:06.700 --> 00:01:09.303 line:-1 align:center
The first is a Managed Apple ID.


27
00:01:09.837 --> 00:01:11.705 line:-1 align:center
Managed Apple IDs provide access


28
00:01:11,738 --> 00:01:14,641 line:-2
to Apple Services
such as iCloud.


29
00:01:15.642 --> 00:01:18.011 line:-2 align:center
They are owned and managed
by an organization


30
00:01:18,045 --> 00:01:20,113 line:-2
and are available through
Apple Business Manager


31
00:01:20.147 --> 00:01:22.115 line:-1 align:center
and Apple School Manager.


32
00:01:22.149 --> 00:01:25.352 line:-2 align:center
They support federation
with Azure Active Directory


33
00:01:25.385 --> 00:01:26.720 line:-1 align:center
so that users can authenticate


34
00:01:26,753 --> 00:01:29,690 line:-2
with their organization's
existing credentials.


35
00:01:30.858 --> 00:01:32.526 line:-1 align:center
The second is Data Separation.


36
00:01:33.527 --> 00:01:35.963 line:-2 align:center
During enrollment,
a separate APFS volume


37
00:01:35.996 --> 00:01:38.732 line:-2 align:center
with different
cryptographic keys is created.


38
00:01:38,765 --> 00:01:40,734 line:-2
Data from managed apps
and managed accounts


39
00:01:40.767 --> 00:01:42.469 line:-1 align:center
is kept securely on this volume


40
00:01:42,503 --> 00:01:44,671 line:-1
away from personal content.


41
00:01:44.705 --> 00:01:46.773 line:-2 align:center
When the device unenrolls
from management,


42
00:01:46,807 --> 00:01:49,710 line:-2
the volume and the cryptographic
keys are erased.


43
00:01:50,577 --> 00:01:52,713 line:-2
And finally,
the Management Capabilities


44
00:01:52,746 --> 00:01:54,648 line:-2
are limited to those
that are appropriate


45
00:01:54.681 --> 00:01:56.817 line:-2 align:center
for controlling
the organization's content


46
00:01:56.850 --> 00:01:58.418 line:-1 align:center
on the device.


47
00:01:59.419 --> 00:02:02.022 line:-2 align:center
The user owns
and has been using the device,


48
00:02:02,055 --> 00:02:04,591 line:-2
so it's critical
to protect their privacy.


49
00:02:05,592 --> 00:02:08,595 line:-2
With User Enrollments,
the user maintains control


50
00:02:08,629 --> 00:02:11,465 line:-2
of their personal data
on the device.


51
00:02:11.498 --> 00:02:15.235 line:-2 align:center
The device is not considered
supervised with User Enrollment.


52
00:02:16.236 --> 00:02:17.738 line:-1 align:center
The management functionality


53
00:02:17.771 --> 00:02:19.406 line:-1 align:center
available to the MDM server


54
00:02:19.439 --> 00:02:20.807 line:-1 align:center
allows it full control


55
00:02:20,841 --> 00:02:22,376 line:-1
of the managed content


56
00:02:22.409 --> 00:02:24.878 line:-2 align:center
but is limited
from accessing and restricting


57
00:02:24.912 --> 00:02:27.347 line:-1 align:center
personal data and settings.


58
00:02:27,381 --> 00:02:29,616 line:-2
Access to personal accounts,
apps,


59
00:02:29.650 --> 00:02:31.618 line:-1 align:center
and unique device identifiers


60
00:02:31.652 --> 00:02:34.188 line:-2 align:center
is unavailable
to the MDM server,


61
00:02:34.221 --> 00:02:36.056 line:-1 align:center
as are system-wide operations


62
00:02:36.089 --> 00:02:38.192 line:-1 align:center
like remotely wiping the device.


63
00:02:39.193 --> 00:02:40.661 line:-2 align:center
We've been hard at work
this year


64
00:02:40.694 --> 00:02:42.462 line:-1 align:center
on updates to User Enrollment,


65
00:02:42,496 --> 00:02:45,098 line:-2
and I'm excited
to discuss them now.


66
00:02:45,132 --> 00:02:47,434 line:-1
I'll cover Managed Apple IDs


67
00:02:47,467 --> 00:02:49,303 line:-1
and managed apps.


68
00:02:49,336 --> 00:02:51,438 line:-2
Then my colleague Melissa
will cover changes


69
00:02:51,471 --> 00:02:54,174 line:-2
to the onboarding flows
for users,


70
00:02:54.208 --> 00:02:57.344 line:-2 align:center
how to enable
ongoing User Authentication,


71
00:02:57,377 --> 00:02:59,279 line:-1
and getting started.


72
00:03:00,280 --> 00:03:02,249 line:-2
Let's start with
Managed Apple IDs.


73
00:03:03.150 --> 00:03:06.420 line:-2 align:center
In iOS 15,
we've improved the experience


74
00:03:06,453 --> 00:03:09,523 line:-2
of accessing
the Managed Account in Settings.


75
00:03:09.556 --> 00:03:11.124 line:-1 align:center
When a device is user enrolled,


76
00:03:11.158 --> 00:03:15.629 line:-2 align:center
it will now show the account
at the top level of settings.


77
00:03:15,662 --> 00:03:19,099 line:-2
From there, you can view
details and settings for iCloud.


78
00:03:19.132 --> 00:03:20.634 line:-1 align:center
It is now easier than ever


79
00:03:20,667 --> 00:03:23,337 line:-2
to manage
the additional account.


80
00:03:23.370 --> 00:03:25.138 line:-2 align:center
With this re-designed
experience,


81
00:03:25.172 --> 00:03:27.241 line:-2 align:center
Settings reflects
the clear separation


82
00:03:27,274 --> 00:03:29,409 line:-1
of organizational content.


83
00:03:29,443 --> 00:03:31,879 line:-2
Users are able to see
which parts of the system


84
00:03:31.912 --> 00:03:34.648 line:-2 align:center
are managed by the organization
and which are not.


85
00:03:35.682 --> 00:03:38.452 line:-2 align:center
New in iOS 15
and macOS Monterey,


86
00:03:38.485 --> 00:03:41.588 line:-2 align:center
Managed Apple IDs
support iCloud Drive.


87
00:03:42,189 --> 00:03:44,858 line:-2
iCloud Drive is an important
feature of iCloud accounts


88
00:03:44,892 --> 00:03:48,328 line:-2
and now it will be available
to user-enrolled devices.


89
00:03:49,730 --> 00:03:51,398 line:-1
On iOS and iPadOS,


90
00:03:51,431 --> 00:03:54,468 line:-2
it shows up as a new location
in the Files app.


91
00:03:55.469 --> 00:03:56.670 line:-1 align:center
And on macOS, it appears


92
00:03:56.703 --> 00:03:59.640 line:-2 align:center
as an additional location
in Finder.


93
00:03:59.673 --> 00:04:01.975 line:-2 align:center
With iCloud Drive
for Managed Apple IDs,


94
00:04:02.009 --> 00:04:03.377 line:-1 align:center
organizations are now able


95
00:04:03,410 --> 00:04:05,045 line:-1
to easily provide their users


96
00:04:05,078 --> 00:04:07,814 line:-2
a built-in
cloud storage solution.


97
00:04:09.316 --> 00:04:10.717 line:-1 align:center
Document browser-based apps


98
00:04:10,751 --> 00:04:14,221 line:-2
will also have access
to the additional iCloud Drive.


99
00:04:14.254 --> 00:04:16.056 line:-2 align:center
And of course,
iCloud Drive will respect


100
00:04:16.089 --> 00:04:18.325 line:-1 align:center
Managed Open-in restrictions


101
00:04:18,358 --> 00:04:20,861 line:-2
for managed apps
and data access.


102
00:04:21,862 --> 00:04:23,964 line:-1
Now let's turn to managed apps.


103
00:04:24.965 --> 00:04:28.468 line:-2 align:center
In macOS Big Sur, we enabled
managed apps on macOS


104
00:04:28.502 --> 00:04:30.170 line:-1 align:center
for the first time.


105
00:04:31.171 --> 00:04:33.307 line:-2 align:center
This allows organizations
to install apps


106
00:04:33.340 --> 00:04:36.710 line:-2 align:center
on a managed device
similar to how they can for iOS,


107
00:04:36,743 --> 00:04:39,813 line:-2
including with a custom
configuration payload.


108
00:04:40.814 --> 00:04:42.983 line:-2 align:center
It also provides the ability
to remove the app


109
00:04:43.016 --> 00:04:47.087 line:-2 align:center
with an MDM command
or when the device unenrolls.


110
00:04:48.422 --> 00:04:49.489 line:-1 align:center
In macOS Monterey,


111
00:04:49,523 --> 00:04:50,991 line:-2
we are expanding
the functionality


112
00:04:51.024 --> 00:04:52.459 line:-1 align:center
to user enrollments.


113
00:04:53.460 --> 00:04:54.828 line:-1 align:center
Like on iOS,


114
00:04:54.862 --> 00:04:58.031 line:-2 align:center
the app data is separated
on a different volume.


115
00:04:58,065 --> 00:05:00,033 line:-2
The app is removed
during unenrollment


116
00:05:00,067 --> 00:05:02,236 line:-1
or with an MDM command.


117
00:05:02,269 --> 00:05:03,103 line:-1
When that happens,


118
00:05:03.136 --> 00:05:04.972 line:-2 align:center
the data container
is also erased.


119
00:05:05.973 --> 00:05:07.908 line:-1 align:center
Managed apps that use CloudKit


120
00:05:07,941 --> 00:05:09,643 line:-2
will now use
the Managed Apple ID


121
00:05:09,676 --> 00:05:12,579 line:-1
associated with the MDM profile.


122
00:05:12.613 --> 00:05:15.549 line:-2 align:center
You'll need to add
the InstallAsManaged key


123
00:05:15,582 --> 00:05:17,985 line:-2
to the InstallApplication
command.


124
00:05:18.018 --> 00:05:19.620 line:-1 align:center
And just a quick reminder


125
00:05:19.653 --> 00:05:21.622 line:-2 align:center
that managed apps
need be installed


126
00:05:21,655 --> 00:05:23,457 line:-1
to the Applications folder


127
00:05:23,490 --> 00:05:26,560 line:-2
and should only contain
a single app bundle.


128
00:05:26.593 --> 00:05:28.128 line:-2 align:center
We recommend
that you adopt the use


129
00:05:28,161 --> 00:05:30,330 line:-1
of the Data Protection Keychain


130
00:05:30.364 --> 00:05:31.665 line:-1 align:center
and app sandboxing


131
00:05:31.698 --> 00:05:34.401 line:-2 align:center
to ensure that data
is correctly separated.


132
00:05:35,402 --> 00:05:36,803 line:-2
We've also added
some enhancements


133
00:05:36,837 --> 00:05:39,072 line:-2
to managed apps
for all types of enrollment


134
00:05:39,106 --> 00:05:41,875 line:-2
that are relevant
to user enrollments.


135
00:05:41.909 --> 00:05:43.877 line:-2 align:center
First,
the restriction functionality


136
00:05:43.911 --> 00:05:45.245 line:-1 align:center
for Managed Open-In


137
00:05:45.279 --> 00:05:48.148 line:-2 align:center
has been expanded
to include Copy & Paste.


138
00:05:48.182 --> 00:05:50.384 line:-2 align:center
This will allow organizations
to control data


139
00:05:50.417 --> 00:05:53.253 line:-2 align:center
from being pasted
across the managed boundary


140
00:05:53.287 --> 00:05:54.821 line:-1 align:center
in both directions.


141
00:05:55.689 --> 00:05:56.990 line:-1 align:center
There is also now the ability


142
00:05:57,024 --> 00:05:59,593 line:-2
to specify
that a required app is installed


143
00:05:59.626 --> 00:06:02.062 line:-2 align:center
when a device
enrolls in management.


144
00:06:02.095 --> 00:06:03.697 line:-2 align:center
The app is approved
for installation


145
00:06:03,730 --> 00:06:05,098 line:-1
when the device is enrolled,


146
00:06:05,132 --> 00:06:08,769 line:-2
so it doesn't require
additional user confirmation.


147
00:06:08.802 --> 00:06:10.571 line:-2 align:center
For more information
on managed pasteboard


148
00:06:10.604 --> 00:06:12.773 line:-2 align:center
and the required app
installation,


149
00:06:12.806 --> 00:06:15.876 line:-2 align:center
see "What's new in managing
Apple devices."


150
00:06:15.909 --> 00:06:16.944 line:-1 align:center
Now over to Melissa


151
00:06:16,977 --> 00:06:20,047 line:-2
to cover enrollment
and ongoing user authentication.


152
00:06:21.048 --> 00:06:22.182 line:-1 align:center
[Melissa] Thanks, Timm.


153
00:06:22.216 --> 00:06:24.818 line:-2 align:center
With all of these enhancements
to User Enrollment,


154
00:06:24,852 --> 00:06:27,855 line:-2
we updated the onboarding flow
to be a more personalized


155
00:06:27,888 --> 00:06:29,857 line:-1
and user-driven experience.


156
00:06:30.457 --> 00:06:32.726 line:-2 align:center
The onboarding experience
for User Enrollment


157
00:06:32.759 --> 00:06:34.428 line:-1 align:center
introduced in iOS 13


158
00:06:34.461 --> 00:06:38.031 line:-2 align:center
is initiated and driven
by an MDM Enrollment profile.


159
00:06:38.065 --> 00:06:40.934 line:-2 align:center
This profile has to be
created for each user


160
00:06:40.968 --> 00:06:42.836 line:-1 align:center
and distributed by their admin.


161
00:06:43,537 --> 00:06:46,673 line:-2
In iOS 15, for a more
streamlined experience


162
00:06:46.707 --> 00:06:49.176 line:-2 align:center
for both users
and administrators,


163
00:06:49.209 --> 00:06:52.446 line:-2 align:center
we've created a new
User Enrollment onboarding flow


164
00:06:52,479 --> 00:06:55,682 line:-2
that establishes
the user's organization identity


165
00:06:55.716 --> 00:06:57.284 line:-1 align:center
as the entry point.


166
00:06:57,951 --> 00:06:59,686 line:-1
Users are already familiar with


167
00:06:59,720 --> 00:07:01,655 line:-2
signing into their
organization identity


168
00:07:01.688 --> 00:07:04.358 line:-2 align:center
to set up services
like Mail and Calendar,


169
00:07:04.391 --> 00:07:06.326 line:-2 align:center
so they'll be familiar
with setting up MDM


170
00:07:06.360 --> 00:07:09.563 line:-2 align:center
on iPhone using their
organization identity.


171
00:07:09.596 --> 00:07:12.099 line:-2 align:center
This onboarding flow
enables new security features


172
00:07:12,132 --> 00:07:14,201 line:-1
for User Enrollment.


173
00:07:14.234 --> 00:07:16.003 line:-1 align:center
Now there's a layer of security


174
00:07:16.036 --> 00:07:17.371 line:-1 align:center
during the enrollment flow


175
00:07:17.404 --> 00:07:19.907 line:-2 align:center
where your MDM server
can verify the user


176
00:07:19.940 --> 00:07:23.877 line:-2 align:center
before the MDM profile
is even downloaded to the device


177
00:07:23,911 --> 00:07:26,780 line:-2
and before any organization data
is sent to it.


178
00:07:28.782 --> 00:07:31.852 line:-2 align:center
Let's take a look at how this
new account-based flow works.


179
00:07:32.853 --> 00:07:34.121 line:-1 align:center
There are four components


180
00:07:34,154 --> 00:07:36,223 line:-2
to the new User Enrollment
onboarding flow.


181
00:07:36,256 --> 00:07:37,925 line:-1
Service discovery,


182
00:07:37.958 --> 00:07:41.562 line:-2 align:center
where the device identifies
the organization's MDM server.


183
00:07:42,563 --> 00:07:43,864 line:-1
User authentication,


184
00:07:43.897 --> 00:07:47.434 line:-2 align:center
which is how the MDM server
validates the user.


185
00:07:48.435 --> 00:07:49.937 line:-1 align:center
Issuing the session token,


186
00:07:49.970 --> 00:07:53.507 line:-2 align:center
which is how ongoing
authentication is performed.


187
00:07:54,508 --> 00:07:56,543 line:-2
And enrollment,
which is the installation


188
00:07:56,577 --> 00:07:59,313 line:-2
of the MDM payload
to the device.


189
00:07:59,346 --> 00:08:01,849 line:-2
Let's take a closer look
at each of these.


190
00:08:02.850 --> 00:08:05.085 line:-2 align:center
When the user starts
the onboarding flow,


191
00:08:05,118 --> 00:08:08,055 line:-2
they are prompted to enter
their organization identifier.


192
00:08:09,056 --> 00:08:11,458 line:-2
This identifier
has two main pieces,


193
00:08:11.491 --> 00:08:13.827 line:-1 align:center
delineated by the @ sign.


194
00:08:13,861 --> 00:08:15,996 line:-2
The first piece
will be the User ID,


195
00:08:16,029 --> 00:08:18,732 line:-2
and the second piece will be
the organization's domain


196
00:08:18,765 --> 00:08:20,567 line:-1
or a sub-domain.


197
00:08:20,601 --> 00:08:23,303 line:-2
After the user has entered
their organization ID,


198
00:08:23.337 --> 00:08:26.173 line:-2 align:center
the device takes the domain
portion of the identifier


199
00:08:26,206 --> 00:08:29,009 line:-1
and turns that into an HTTPS URL


200
00:08:29.042 --> 00:08:33.280 line:-2 align:center
pointing to a well-known
HTTP resource at that domain.


201
00:08:34,615 --> 00:08:35,949 line:-1
This discovery URL


202
00:08:35,983 --> 00:08:38,218 line:-2
is where you host
your MDM server document


203
00:08:38.252 --> 00:08:42.289 line:-2 align:center
that tells the device where
the enrollment endpoint is.


204
00:08:43.290 --> 00:08:46.560 line:-2 align:center
The device then performs
a GET request to that URL,


205
00:08:46.593 --> 00:08:49.630 line:-2 align:center
expecting to get back
a JSON document.


206
00:08:51,131 --> 00:08:52,933 line:-1
The received JSON object


207
00:08:52.966 --> 00:08:55.469 line:-2 align:center
includes a version key to let
the device know


208
00:08:55,502 --> 00:08:58,038 line:-2
what type of enrollment
the server supports


209
00:08:58,071 --> 00:09:01,108 line:-2
and a BaseURL key
that specifies the URL


210
00:09:01.141 --> 00:09:03.977 line:-2 align:center
of the MDM server's
enrollment endpoint.


211
00:09:04.978 --> 00:09:07.080 line:-2 align:center
With this information,
the device is now ready


212
00:09:07,114 --> 00:09:09,983 line:-2
to request the enrollment
profile from the server.


213
00:09:10,984 --> 00:09:13,053 line:-1
The device POSTs a property list


214
00:09:13.086 --> 00:09:14.621 line:-2 align:center
to the server's
enrollment endpoint


215
00:09:14.655 --> 00:09:16.757 line:-1 align:center
with various device attributes.


216
00:09:18,759 --> 00:09:19,793 line:-1
If you are familiar with


217
00:09:19.826 --> 00:09:22.262 line:-2 align:center
the over-the-air
profile delivery process,


218
00:09:22,296 --> 00:09:24,298 line:-2
you will recognize this
as the same request


219
00:09:24.331 --> 00:09:27.334 line:-2 align:center
a device makes
to the profile service endpoint.


220
00:09:29.336 --> 00:09:32.506 line:-2 align:center
But the key difference here
is that the server asks the user


221
00:09:32.539 --> 00:09:33.941 line:-1 align:center
to authenticate themselves


222
00:09:33.974 --> 00:09:36.543 line:-2 align:center
before it hands over
the enrollment profile.


223
00:09:37.544 --> 00:09:41.815 line:-2 align:center
It does this by issuing an HTTP
401 Unauthorized response


224
00:09:41.849 --> 00:09:44.418 line:-2 align:center
to challenge the user
for credentials.


225
00:09:44.451 --> 00:09:46.453 line:-2 align:center
The server must issue
this auth challenge


226
00:09:46.486 --> 00:09:48.956 line:-2 align:center
in order
for enrollment to succeed.


227
00:09:50.290 --> 00:09:52.426 line:-1 align:center
Importantly, this 401 response


228
00:09:52,459 --> 00:09:54,828 line:-2
includes
a WWW-Authenticate header


229
00:09:54.862 --> 00:09:58.498 line:-2 align:center
with information that the device
uses to authenticate.


230
00:09:58.532 --> 00:10:00.934 line:-1 align:center
This WWW-Authenticate header


231
00:10:00.968 --> 00:10:03.303 line:-2 align:center
uses the Bearer
authentication scheme


232
00:10:03.337 --> 00:10:05.539 line:-1 align:center
and two additional parameters.


233
00:10:06,874 --> 00:10:08,976 line:-2
The method parameter
tells the device


234
00:10:09,009 --> 00:10:11,411 line:-2
what type of authentication
is being used.


235
00:10:11.445 --> 00:10:13.447 line:-2 align:center
The value indicates
that the device will use


236
00:10:13.480 --> 00:10:16.083 line:-2 align:center
the AuthenticationServices
web sign-in flow


237
00:10:16,116 --> 00:10:17,851 line:-1
to authenticate the user.


238
00:10:17,885 --> 00:10:20,587 line:-1
For now, that value is fixed.


239
00:10:21,922 --> 00:10:25,459 line:-2
For this method parameter,
a URL is also included.


240
00:10:27.127 --> 00:10:30.230 line:-2 align:center
The value of this key
is an HTTPS URL


241
00:10:30,264 --> 00:10:31,732 line:-1
that specifies the endpoint


242
00:10:31.765 --> 00:10:34.101 line:-2 align:center
where the authentication
happens.


243
00:10:34,134 --> 00:10:38,272 line:-2
This URL should be an endpoint
on the MDM server itself.


244
00:10:38.305 --> 00:10:40.707 line:-2 align:center
Receipt of this
authenticate header kicks off


245
00:10:40.741 --> 00:10:43.911 line:-2 align:center
the AuthenticationServices
web sign-in flow.


246
00:10:43,944 --> 00:10:45,712 line:-2
Let's take a look
at how that works.


247
00:10:46.480 --> 00:10:49.416 line:-2 align:center
The initial content
of the web view displayed by


248
00:10:49.449 --> 00:10:52.119 line:-2 align:center
AuthenticationServices
web sign-in flow


249
00:10:52,152 --> 00:10:54,855 line:-2
is the result
of a HTTP GET request


250
00:10:54.888 --> 00:10:56.757 line:-1 align:center
to the authentication endpoint


251
00:10:56.790 --> 00:11:01.495 line:-2 align:center
specified by the URL parameter
from the 401 response.


252
00:11:02.496 --> 00:11:04.898 line:-2 align:center
In a simple case,
this web sign-in flow


253
00:11:04,932 --> 00:11:06,166 line:-1
could display a web form


254
00:11:06.200 --> 00:11:09.336 line:-2 align:center
where the user would enter
their username and password.


255
00:11:10.838 --> 00:11:12.272 line:-1 align:center
In more complex cases,


256
00:11:12,306 --> 00:11:14,708 line:-2
it could make use
of enterprise single sign-on


257
00:11:14.741 --> 00:11:17.911 line:-2 align:center
or even redirect to
a third-party identity provider


258
00:11:17.945 --> 00:11:21.081 line:-2 align:center
or perform
multi-factor authentication.


259
00:11:22,082 --> 00:11:24,451 line:-2
Multiple round trips
between the device


260
00:11:24,484 --> 00:11:27,521 line:-2
and authentication service
can occur.


261
00:11:27,554 --> 00:11:30,057 line:-2
The AuthenticationServices
web flow completes


262
00:11:30.090 --> 00:11:33.227 line:-2 align:center
when the server returns
an HTTP redirect response


263
00:11:33,260 --> 00:11:36,063 line:-2
to the device,
like the one seen here.


264
00:11:38.065 --> 00:11:40.033 line:-2 align:center
The response includes
a Location header


265
00:11:40.067 --> 00:11:43.070 line:-2 align:center
with a URL
using a custom fixed scheme.


266
00:11:45.072 --> 00:11:48.242 line:-2 align:center
The URL also includes
an access-token parameter


267
00:11:48.275 --> 00:11:50.344 line:-1 align:center
whose value is an opaque token


268
00:11:50,377 --> 00:11:52,880 line:-2
that the device will use as a
session token


269
00:11:52.913 --> 00:11:55.983 line:-2 align:center
when making requests
to the MDM server.


270
00:11:57.985 --> 00:11:59.653 line:-1 align:center
With the session token in-hand,


271
00:11:59,686 --> 00:12:03,490 line:-2
the device re-issues
the original HTTP POST request


272
00:12:03,524 --> 00:12:05,659 line:-1
to fetch the enrollment profile.


273
00:12:07,661 --> 00:12:11,164 line:-2
This time, that request includes
an Authorization header


274
00:12:11.198 --> 00:12:14.434 line:-2 align:center
which contains
the session token as the value.


275
00:12:14,468 --> 00:12:17,604 line:-2
The server validates this token,
and upon success,


276
00:12:17.638 --> 00:12:21.141 line:-2 align:center
returns the enrollment profile
to the device.


277
00:12:21,175 --> 00:12:24,044 line:-2
The user enrollment profile
contains two new keys


278
00:12:24.077 --> 00:12:25.979 line:-1 align:center
in the MDM payload.


279
00:12:26.980 --> 00:12:29.616 line:-2 align:center
First,
the AssignedManagedAppleID key


280
00:12:29,650 --> 00:12:31,818 line:-2
is the Managed Apple ID
associated


281
00:12:31.852 --> 00:12:33.554 line:-1 align:center
with the enterprise user.


282
00:12:33.587 --> 00:12:35.055 line:-1 align:center
The user will be required


283
00:12:35.088 --> 00:12:37.024 line:-2 align:center
to authenticate
this Managed Apple ID


284
00:12:37,057 --> 00:12:39,259 line:-2
to sign into
the iCloud and iTunes accounts


285
00:12:39.293 --> 00:12:41.061 line:-1 align:center
as part of the enrollment flow.


286
00:12:41.895 --> 00:12:43.463 line:-1 align:center
A successful MDM enrollment


287
00:12:43.497 --> 00:12:45.666 line:-2 align:center
guarantees
that the Managed Apple ID


288
00:12:45,699 --> 00:12:47,568 line:-1
is active on the device.


289
00:12:47.601 --> 00:12:49.203 line:-1 align:center
The device will fail to enroll


290
00:12:49,236 --> 00:12:51,805 line:-2
if the AssignedManagedAppleID
key is missing


291
00:12:51.839 --> 00:12:54.508 line:-2 align:center
or if the user does not
successfully authenticate it.


292
00:12:55.509 --> 00:12:58.412 line:-2 align:center
And the second new key
is the EnrollmentMode key,


293
00:12:58.445 --> 00:13:01.882 line:-2 align:center
indicating the enrollment
is a BYOD type.


294
00:13:01,915 --> 00:13:03,984 line:-2
The device verifies
that this value


295
00:13:04,017 --> 00:13:05,485 line:-1
matches the mode it is in


296
00:13:05.519 --> 00:13:07.921 line:-2 align:center
and will fail the enrollment
if there is a mismatch


297
00:13:07,955 --> 00:13:10,190 line:-1
or if the key is not present.


298
00:13:10,224 --> 00:13:11,992 line:-2
Be sure to update
your MDM payloads


299
00:13:12,025 --> 00:13:14,228 line:-1
with both of these new keys.


300
00:13:14,261 --> 00:13:16,263 line:-2
With receipt
of the enrollment profile,


301
00:13:16,296 --> 00:13:18,565 line:-2
the device now sets up
the required


302
00:13:18,599 --> 00:13:20,567 line:-1
Managed Apple ID account


303
00:13:20.601 --> 00:13:24.204 line:-1 align:center
and enrolls with the MDM server.


304
00:13:24,238 --> 00:13:27,074 line:-2
All requests to the server
now include the session token


305
00:13:27,107 --> 00:13:30,744 line:-2
in the Authorization header
for the server to validate.


306
00:13:30.777 --> 00:13:33.780 line:-2 align:center
Let's take a look
at all of the pieces together.


307
00:13:33.814 --> 00:13:36.817 line:-2 align:center
First, the user navigates
to the redesigned VPN


308
00:13:36,850 --> 00:13:38,819 line:-2
and Device Management
section in Settings


309
00:13:38.852 --> 00:13:41.688 line:-2 align:center
and taps the new Sign In
to Work or School button.


310
00:13:41,722 --> 00:13:43,657 line:-2
Then they enter
their organization ID,


311
00:13:43,690 --> 00:13:46,326 line:-2
triggering
the service discovery step.


312
00:13:46.360 --> 00:13:48.328 line:-2 align:center
After discovering
the enrollment endpoint


313
00:13:48.362 --> 00:13:49.363 line:-1 align:center
from the domain,


314
00:13:49.396 --> 00:13:53.834 line:-2 align:center
the Authentication Services
Web UI flow begins.


315
00:13:53,867 --> 00:13:55,802 line:-2
This is an example
of a simple web form


316
00:13:55.836 --> 00:13:57.137 line:-1 align:center
used for auth.


317
00:13:57,171 --> 00:14:00,007 line:-2
The user enters
their organization password.


318
00:14:00,040 --> 00:14:02,676 line:-2
Once the organization's
authentication succeeds,


319
00:14:02.709 --> 00:14:05.646 line:-1 align:center
we are handed the MDM profile.


320
00:14:05.679 --> 00:14:08.882 line:-2 align:center
We take the value of
the AssignedManagedAppleID key


321
00:14:08,916 --> 00:14:10,817 line:-2
from the profile
and pre-populate it


322
00:14:10.851 --> 00:14:12.619 line:-1 align:center
into the next sign-in screen,


323
00:14:12.653 --> 00:14:15.689 line:-2 align:center
where the user
enters their password.


324
00:14:15,722 --> 00:14:17,958 line:-2
After this authentication
succeeds,


325
00:14:17,991 --> 00:14:20,928 line:-2
the user then allows
management of their device.


326
00:14:21.929 --> 00:14:23.530 line:-1 align:center
They enter their device passcode


327
00:14:23.564 --> 00:14:26.433 line:-2 align:center
to create an encrypted
enterprise data partition


328
00:14:26,466 --> 00:14:29,236 line:-2
and to authorize
the MDM enrollment.


329
00:14:29,269 --> 00:14:32,206 line:-2
The enrollment
of the user is successful.


330
00:14:32.239 --> 00:14:34.341 line:-2 align:center
And that's the new
account-driven onboarding flow


331
00:14:34.374 --> 00:14:35.876 line:-1 align:center
for User Enrollment.


332
00:14:35,909 --> 00:14:37,444 line:-1
In the onboarding flow,


333
00:14:37,477 --> 00:14:40,147 line:-2
we looked at how a server
authenticates a user


334
00:14:40,180 --> 00:14:42,516 line:-1
before sending enrollment data.


335
00:14:43.016 --> 00:14:45.452 line:-2 align:center
With new
User Enrollments in iOS 15,


336
00:14:45,485 --> 00:14:46,920 line:-1
we are introducing the ability


337
00:14:46,954 --> 00:14:49,389 line:-2
for organizations
to reauthenticate the user


338
00:14:49,423 --> 00:14:51,191 line:-1
at any point in time.


339
00:14:51,225 --> 00:14:53,126 line:-2
This makes it possible
for your server


340
00:14:53,160 --> 00:14:56,763 line:-2
and client connection
to be more secure than ever.


341
00:14:56.797 --> 00:14:59.166 line:-2 align:center
MDM servers
can now validate authorization


342
00:14:59.199 --> 00:15:01.134 line:-1 align:center
on every request from the client


343
00:15:01.168 --> 00:15:03.070 line:-2 align:center
and ask the user
to re-authenticate


344
00:15:03.103 --> 00:15:05.939 line:-2 align:center
their identity credentials
at any time.


345
00:15:05.973 --> 00:15:07.608 line:-1 align:center
This functionality is performed


346
00:15:07,641 --> 00:15:09,843 line:-2
through the use
of the session token.


347
00:15:10.844 --> 00:15:12.980 line:-2 align:center
Here's an example
of an MDM client


348
00:15:13,013 --> 00:15:16,250 line:-2
checking in with the server
to fetch the next MDM command.


349
00:15:16,283 --> 00:15:19,553 line:-2
The Authorization header
contains the session token.


350
00:15:19.586 --> 00:15:21.655 line:-2 align:center
This is the staple
for the two elements


351
00:15:21.688 --> 00:15:23.724 line:-1 align:center
of ongoing authentication.


352
00:15:25,058 --> 00:15:27,895 line:-2
The first element is
persistent authorization,


353
00:15:27,928 --> 00:15:29,229 line:-1
where the session token is sent


354
00:15:29,263 --> 00:15:31,798 line:-2
in every client request
to the server.


355
00:15:32,799 --> 00:15:35,802 line:-2
The second element
is refreshing the session token.


356
00:15:35,836 --> 00:15:38,005 line:-2
This enables
the organization administrator


357
00:15:38.038 --> 00:15:41.475 line:-2 align:center
to request user
re-authentication at any time.


358
00:15:43,977 --> 00:15:46,914 line:-2
By implementing your own
server side validation logic


359
00:15:46.947 --> 00:15:48.415 line:-1 align:center
of this session token,


360
00:15:48.448 --> 00:15:51.251 line:-2 align:center
you can add your organization's
security rules


361
00:15:51,285 --> 00:15:53,687 line:-2
right into your
management solution.


362
00:15:55.022 --> 00:15:57.558 line:-2 align:center
For example,
you can periodically verify


363
00:15:57,591 --> 00:15:58,725 line:-1
a user's credentials


364
00:15:58.759 --> 00:16:02.162 line:-2 align:center
to ensure sensitive payloads
are only sent to devices


365
00:16:02.196 --> 00:16:04.531 line:-1 align:center
in possession of trusted users.


366
00:16:05.532 --> 00:16:07.100 line:-2 align:center
Let's take a look
at how that works.


367
00:16:08.001 --> 00:16:10.037 line:-2 align:center
When the session token
is invalidated,


368
00:16:10,070 --> 00:16:12,472 line:-1
re-authentication is triggered.


369
00:16:13.473 --> 00:16:17.411 line:-2 align:center
The next time the device
makes an MDM HTTP request,


370
00:16:17,444 --> 00:16:21,615 line:-2
the now invalid session token
included in the HTTP PUT


371
00:16:21.648 --> 00:16:24.484 line:-2 align:center
will trigger a 401 response
from the server.


372
00:16:25,986 --> 00:16:27,921 line:-2
The response
that the server sends


373
00:16:27,955 --> 00:16:30,924 line:-2
includes the same
WWW-Authenticate header


374
00:16:30,958 --> 00:16:34,027 line:-2
that we saw earlier in the
initial authentication exchange


375
00:16:34,061 --> 00:16:35,863 line:-1
during the onboarding flow.


376
00:16:37,364 --> 00:16:39,499 line:-2
Of course,
because the MDM process


377
00:16:39,533 --> 00:16:41,835 line:-2
runs in the background
on devices,


378
00:16:41,869 --> 00:16:44,671 line:-2
this reauthentication request is
surfaced to the user


379
00:16:44,705 --> 00:16:46,473 line:-1
via NotificationCenter.


380
00:16:48.475 --> 00:16:50.511 line:-1 align:center
By tapping on the notification,


381
00:16:50.544 --> 00:16:53.046 line:-2 align:center
the user continues
the re-authentication flow


382
00:16:53,080 --> 00:16:54,181 line:-1
in Settings.


383
00:16:55,182 --> 00:16:57,951 line:-2
The client will start
another AuthenticationServices


384
00:16:57,985 --> 00:17:02,022 line:-2
Web sign-in flow like the one
during the onboarding process.


385
00:17:04,358 --> 00:17:06,426 line:-2
The user will need
to authenticate as part of


386
00:17:06.460 --> 00:17:08.662 line:-2 align:center
the AuthenticationServices
web sign-in flow


387
00:17:08,695 --> 00:17:11,398 line:-1
with either a simple mechanism


388
00:17:11.431 --> 00:17:12.699 line:-1 align:center
or a more complex one


389
00:17:12,733 --> 00:17:14,635 line:-2
decided by the server's
integration


390
00:17:14.668 --> 00:17:16.270 line:-1 align:center
with their identity provider.


391
00:17:18,272 --> 00:17:21,141 line:-2
When that authentication
services web flow completes,


392
00:17:21.175 --> 00:17:23.477 line:-2 align:center
the server again sends
a redirect response


393
00:17:23,510 --> 00:17:24,978 line:-1
with the custom Location header,


394
00:17:25,012 --> 00:17:27,147 line:-1
containing a new session token.


395
00:17:29.149 --> 00:17:30.851 line:-1 align:center
A successful re-authentication


396
00:17:30.884 --> 00:17:33.020 line:-2 align:center
results in the device
immediately repeating


397
00:17:33,053 --> 00:17:37,491 line:-2
the MDM request that initially
received the 401 response,


398
00:17:37,524 --> 00:17:39,726 line:-2
continuing right
from where it left off


399
00:17:39.760 --> 00:17:41.995 line:-1 align:center
without action from the server.


400
00:17:42.029 --> 00:17:43.030 line:-1 align:center
Just like before,


401
00:17:43,063 --> 00:17:45,199 line:-2
this new session token
is included in all


402
00:17:45,232 --> 00:17:48,569 line:-1
subsequent MDM HTTP requests.


403
00:17:48.602 --> 00:17:50.604 line:-1 align:center
If, for any reason,


404
00:17:50,637 --> 00:17:53,073 line:-2
a user's authentication attempt
fails,


405
00:17:53.106 --> 00:17:55.776 line:-2 align:center
the server may no longer
trust the device.


406
00:17:56,777 --> 00:17:58,645 line:-2
In this case,
the server can remove


407
00:17:58,679 --> 00:18:00,547 line:-1
any sensitive MDM payloads


408
00:18:00.581 --> 00:18:03.317 line:-2 align:center
or it can completely unenroll
the device.


409
00:18:04.151 --> 00:18:07.087 line:-2 align:center
And when it comes
to unenrolling from MDM,


410
00:18:07,120 --> 00:18:09,223 line:-1
because ongoing authentication


411
00:18:09,256 --> 00:18:12,492 line:-1
leverages the HTTP 401 response,


412
00:18:12.526 --> 00:18:14.328 line:-2 align:center
it's important to note
a key difference here


413
00:18:14.361 --> 00:18:16.063 line:-2 align:center
between
profile-based enrollments


414
00:18:16.096 --> 00:18:18.265 line:-1 align:center
and this new User Enrollment.


415
00:18:19,766 --> 00:18:21,468 line:-1
Before iOS 15,


416
00:18:21,502 --> 00:18:23,303 line:-1
all MDM-enrolled devices


417
00:18:23.337 --> 00:18:25.339 line:-2 align:center
treated a 401 response
from the server


418
00:18:25.372 --> 00:18:27.274 line:-1 align:center
as an unenroll command.


419
00:18:27.307 --> 00:18:30.244 line:-2 align:center
When this new User Enrollment
style is in effect,


420
00:18:30.277 --> 00:18:34.047 line:-2 align:center
the 401 response triggers
reauthentication instead.


421
00:18:35.048 --> 00:18:36.316 line:-1 align:center
To trigger an unenroll,


422
00:18:36.350 --> 00:18:38.552 line:-2 align:center
you can still use
the existing mechanism


423
00:18:38,585 --> 00:18:40,587 line:-2
of sending
the RemoveProfile command


424
00:18:40.621 --> 00:18:43.023 line:-1 align:center
for the MDM enrollment profile.


425
00:18:43,056 --> 00:18:45,792 line:-2
This will result
in a full MDM unenroll


426
00:18:45,826 --> 00:18:47,861 line:-2
as well as a complete
managed account,


427
00:18:47,895 --> 00:18:48,962 line:-1
managed data,


428
00:18:48.996 --> 00:18:52.366 line:-2 align:center
and data separated volume
removal from the device.


429
00:18:54.134 --> 00:18:57.104 line:-2 align:center
All unenroll behavior
of profile-based enrollments,


430
00:18:57,137 --> 00:18:58,939 line:-2
including
the user enrollment flow


431
00:18:58,972 --> 00:19:00,541 line:-1
from iOS13,


432
00:19:00.574 --> 00:19:02.643 line:-1 align:center
remain unchanged.


433
00:19:03.644 --> 00:19:07.014 line:-2 align:center
So that's a quick look
into Ongoing Authentication.


434
00:19:07,047 --> 00:19:09,650 line:-2
Now let's help you get started
and wrap up.


435
00:19:09,683 --> 00:19:12,753 line:-2
You can get started with the new
User Enrollment onboarding


436
00:19:12,786 --> 00:19:16,523 line:-2
and ongoing authentication
today with iOS 15.


437
00:19:16,557 --> 00:19:19,426 line:-2
You'll need be sure
to do these five things.


438
00:19:19,459 --> 00:19:21,228 line:-1
First, set up and publish


439
00:19:21.261 --> 00:19:23.764 line:-1 align:center
an HTTP well-known resource file


440
00:19:23,797 --> 00:19:25,532 line:-1
for your enterprise domain.


441
00:19:26.533 --> 00:19:28.702 line:-2 align:center
Second, integrate
your MDM server


442
00:19:28.735 --> 00:19:30.103 line:-1 align:center
with your Identity Provider


443
00:19:30.137 --> 00:19:33.273 line:-2 align:center
to perform user authentication
during enrollment


444
00:19:33,307 --> 00:19:35,676 line:-2
and take advantage
of the ongoing authentication


445
00:19:35.709 --> 00:19:37.511 line:-1 align:center
for added Security benefit.


446
00:19:38,512 --> 00:19:40,848 line:-1
Third, create Managed Apple IDs


447
00:19:40.881 --> 00:19:43.984 line:-2 align:center
or use already created Managed
Apple IDs


448
00:19:44.017 --> 00:19:47.454 line:-2 align:center
from Apple School Manager
and Apple Business Manager


449
00:19:47.487 --> 00:19:50.157 line:-2 align:center
to populate
the AssignedManagedAppleID key


450
00:19:50.190 --> 00:19:52.659 line:-1 align:center
in your server's MDM payloads.


451
00:19:53.660 --> 00:19:55.729 line:-2 align:center
Update your MDM payload
to also include


452
00:19:55.762 --> 00:19:57.698 line:-1 align:center
the new EnrollmentMode key.


453
00:19:59,199 --> 00:20:01,568 line:-1
And lastly, find our new iOS 15


454
00:20:01,602 --> 00:20:03,871 line:-2
Apple Device Management
documentation


455
00:20:03,904 --> 00:20:05,506 line:-1
to review our specific updates


456
00:20:05,539 --> 00:20:08,275 line:-2
along with all the details
that we've gone over today.


457
00:20:08,675 --> 00:20:09,910 line:-2
And that's all you need to get
started


458
00:20:09,943 --> 00:20:11,845 line:-2
with Account-Based
User Enrollments.


459
00:20:11,879 --> 00:20:13,647 line:-1
We covered a lot today,


460
00:20:13,680 --> 00:20:15,415 line:-1
so let's review.


461
00:20:15.449 --> 00:20:18.252 line:-2 align:center
The new iCloud Drive support
for Managed Apple IDs


462
00:20:18,285 --> 00:20:20,888 line:-2
brings a built-in
cloud storage option


463
00:20:20,921 --> 00:20:22,856 line:-1
to your organization.


464
00:20:22,890 --> 00:20:27,160 line:-2
You can now manage apps
on macOS in User Enrollment.


465
00:20:27.194 --> 00:20:29.763 line:-2 align:center
Build support
for the new onboarding flow


466
00:20:29.796 --> 00:20:31.665 line:-1 align:center
in your MDM solution


467
00:20:31.698 --> 00:20:33.734 line:-1 align:center
or encourage your MDM provider


468
00:20:33,767 --> 00:20:36,136 line:-2
to support the new
account-driven onboarding


469
00:20:36,170 --> 00:20:38,839 line:-2
to make user enrollment
easier than ever before.


470
00:20:39.840 --> 00:20:42.009 line:-2 align:center
Incorporate
ongoing authentication


471
00:20:42,042 --> 00:20:44,945 line:-2
with your accounts throughout
your management workflows.


472
00:20:45.946 --> 00:20:47.981 line:-2 align:center
Take advantage
of these new features


473
00:20:48,015 --> 00:20:51,084 line:-2
starting in iOS 15
and macOS Monterey


474
00:20:51,118 --> 00:20:52,586 line:-1
to significantly improve


475
00:20:52.619 --> 00:20:54.421 line:-2 align:center
the Bring Your Own Device
workflow


476
00:20:54,454 --> 00:20:56,490 line:-1
for both you and your users.


477
00:20:56.523 --> 00:20:58.258 line:-1 align:center
Thanks for joining us today,


478
00:20:58.292 --> 00:21:00.394 line:-1 align:center
and have a great WWDC.


479
00:21:00.427 --> 00:21:02.896 line:-1 align:center
[music]

